{"remainingRequest":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\work\\proj\\project_manage\\project-ui\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\work\\proj\\project_manage\\project-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\proj\\project_manage\\project-ui\\src\\views\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\proj\\project_manage\\project-ui\\src\\views\\index.vue","mtime":1663479653279},{"path":"D:\\work\\proj\\project_manage\\project-ui\\babel.config.js","mtime":1663229169808},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663230084016},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1663230086097},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663230084016},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1663230087832}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJEOi93b3JrL3Byb2ovcHJvamVjdF9tYW5hZ2UvcHJvamVjdC11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQuanMiKS5kZWZhdWx0OwoKdmFyIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkID0gcmVxdWlyZSgiRDovd29yay9wcm9qL3Byb2plY3RfbWFuYWdlL3Byb2plY3QtdWkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVXaWxkY2FyZC5qcyIpLmRlZmF1bHQ7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyIpOwoKcmVxdWlyZSgib2wvb2wuY3NzIik7Cgp2YXIgb2xDb250cm9sID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgib2wvY29udHJvbCIpKTsKCnZhciBfb2wyID0gcmVxdWlyZSgib2wiKTsKCnZhciBfZXh0ZW50ID0gcmVxdWlyZSgib2wvZXh0ZW50Iik7Cgp2YXIgX1RpbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL2xheWVyL1RpbGUiKSk7Cgp2YXIgX1dNVFMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL3NvdXJjZS9XTVRTIikpOwoKdmFyIF9YWVogPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL3NvdXJjZS9YWVoiKSk7Cgp2YXIgX1dNVFMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC90aWxlZ3JpZC9XTVRTIikpOwoKdmFyIF9Qcm9qZWN0aW9uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9wcm9qL1Byb2plY3Rpb24iKSk7Cgp2YXIgX3Byb2ogPSByZXF1aXJlKCJvbC9wcm9qIik7Cgp2YXIgX3Byb2oyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJwcm9qNCIpKTsKCnZhciBfcHJvajMgPSByZXF1aXJlKCJvbC9wcm9qL3Byb2o0Iik7Cgp2YXIgX1ZlY3RvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgib2wvc291cmNlL1ZlY3RvciIpKTsKCnZhciBfc291cmNlID0gcmVxdWlyZSgib2wvc291cmNlIik7Cgp2YXIgX1ZlY3RvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL2xheWVyL1ZlY3RvciIpKTsKCnZhciBfaW50ZXJhY3Rpb24gPSByZXF1aXJlKCJvbC9pbnRlcmFjdGlvbiIpOwoKdmFyIF9zdHlsZSA9IHJlcXVpcmUoIm9sL3NyYy9zdHlsZSIpOwoKdmFyIF9XS1QgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL2Zvcm1hdC9XS1QiKSk7Cgp2YXIgX0dlb0pTT04gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL2Zvcm1hdC9HZW9KU09OIikpOwoKdmFyIF9PdmVybGF5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9PdmVybGF5IikpOwoKdmFyIGVjaGFydHMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCJlY2hhcnRzIikpOwoKdmFyIF9heGlvcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiYXhpb3MiKSk7Cgp2YXIgX0xpbmVTdHJpbmcgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL2dlb20vTGluZVN0cmluZyIpKTsKCnZhciBfTXVsdGlMaW5lU3RyaW5nID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9nZW9tL011bHRpTGluZVN0cmluZyIpKTsKCnZhciBfTXVsdGlQb2x5Z29uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9nZW9tL011bHRpUG9seWdvbiIpKTsKCnZhciBfdnVlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJ2dWUiKSk7Cgp2YXIgX3J1b3lpID0gcmVxdWlyZSgiQC91dGlscy9ydW95aSIpOwoKdmFyIF9Qb2ludCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgib2wvZ2VvbS9Qb2ludCIpKTsKCnZhciBfU3R5bGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL3N0eWxlL1N0eWxlIikpOwoKdmFyIF9JY29uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9zdHlsZS9JY29uIikpOwoKdmFyIF9pbmRleCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQC9hcGkvaW5kZXgiKSk7Cgp2YXIgX1RleHQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL3N0eWxlL1RleHQiKSk7Cgp2YXIgX2NvbXBvbmVudCA9IHJlcXVpcmUoIkAvYXBpL2NvbmZpZy9jb21wb25lbnQiKTsKCnZhciBfdHJlZSA9IHJlcXVpcmUoIkAvYXBpL3RyZWUvdHJlZSIpOwoKdmFyIF9sZWdlbmQgPSByZXF1aXJlKCJAL2FwaS9jb25maWcvbGVnZW5kIik7Cgp2YXIgX3JlcXVlc3QgPSByZXF1aXJlKCJAL3V0aWxzL3JlcXVlc3QiKTsKCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8v5Lit5b+D5Z2Q5qCHCnZhciBjZW50ZXJDb3JkaW5hdGUgPSBbNjU2OTUxLjIyMzc5ODk0LCAzNTYwOTU5LjI2NjI2MzY5XTsgLy/lnZDmoIflrprkuYkKCl9wcm9qMi5kZWZhdWx0LmRlZnMoIkVQU0c6NDU0OCIsICIrcHJvaj10bWVyYyArbGF0XzA9MCArbG9uXzA9MTE3ICtrPTEgK3hfMD01MDAwMDAgK3lfMD0wICtlbGxwcz1HUlM4MCArdW5pdHM9bSArbm9fZGVmcyIpOwoKKDAsIF9wcm9qMy5yZWdpc3RlcikoX3Byb2oyLmRlZmF1bHQpOyAvL+WcsOWbvuWIneWni+WMlgoKdmFyIHZpZXcgPSBuZXcgX29sMi5WaWV3KHsKICBjZW50ZXI6ICgwLCBfcHJvai50cmFuc2Zvcm0pKGNlbnRlckNvcmRpbmF0ZSwgJ0VQU0c6NDU0OCcsICdFUFNHOjM4NTcnKSwKICBtaW5ab29tOiA0LAogIG1heFpvb206IDE4LAogIHpvb206IDE0LjUgLy8g5Zyw5Zu+5Yid5aeL5YyW55qE57yp5pS+57qn5YirCgp9KTsgLy/pq5jlvrflnLDlm77lm77lsYIKCnZhciBnYW9kZU1hcExheWVyID0gbmV3IF9UaWxlLmRlZmF1bHQoewogIHNvdXJjZTogbmV3IF9YWVouZGVmYXVsdCh7CiAgICB6SW5kZXg6IDEsCiAgICB1cmw6ICdodHRwOi8vd2Vic3QwezEtNH0uaXMuYXV0b25hdmkuY29tL2FwcG1hcHRpbGU/bGFuZz16aF9jbiZzaXplPTEmc2NsPTImc3R5bGU9NyZ4PXt4fSZ5PXt5fSZ6PXt6fScKICB9KQp9KTsgLy/ljavmmJ/lnLDlm74KLy8gY29uc3Qgd3hNYXBMYXllciA9IG5ldyBUaWxlTGF5ZXIoewovLyAgIHNvdXJjZTogbmV3IFhZWih7Ci8vICAgICBjcm9zc09yaWdpbjogImFub255bW91cyIsCi8vICAgICB1cmw6ICdodHRwOi8vdDAudGlhbmRpdHUuZ292LmNuL2ltZ193L3dtdHM/dGs9MTI5MzY0MTY4NTgwZTdmMGUzZmY1YmQ3NTlkNDFhNzUmU0VSVklDRT1XTVRTJlJFUVVFU1Q9R2V0VGlsZSZWRVJTSU9OPTEuMC4wJkxBWUVSPWltZyZTVFlMRT1kZWZhdWx0JlRJTEVNQVRSSVhTRVQ9dyZUSUxFTUFUUklYPXt6fSZUSUxFUk9XPXt5fSZUSUxFQ09MPXt4fSZGT1JNQVQ9dGlsZXMnCi8vICAgfSkKLy8gfSk7Cgp2YXIgd3hNYXBMYXllciA9IG5ldyBfVGlsZS5kZWZhdWx0KHsKICBzb3VyY2U6IG5ldyBfWFlaLmRlZmF1bHQoewogICAgdXJsOiAnaHR0cDovL3dlYnN0MHsxLTR9LmlzLmF1dG9uYXZpLmNvbS9hcHBtYXB0aWxlP2xhbmc9emhfY24mc2l6ZT0xJnNjYWxlPTEmc3R5bGU9NiZ4PXt4fSZ5PXt5fSZ6PXt6fScKICB9KQp9KTsKdmFyIF9kZWZhdWx0ID0gewogIG5hbWU6ICJwcm9qZWN0IiwKICBtaXhpbnM6IFtfaW5kZXguZGVmYXVsdF0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGFjOiAnMScsCiAgICAgIHZhbHVlMTogJ3RydWUnLAogICAgICByYWRpbzI6IFtdLAogICAgICBhZGRGb3JtOiB7CiAgICAgICAgc0RlcHROYW1lOiAnJywKICAgICAgICBzRGVwdElkOiAnJwogICAgICB9LAogICAgICAvL+WbvuWxguWvueixoeaVsOe7hAogICAgICBsYXllckFycmF5OiBbXSwKICAgICAgLy/moJHnu5PmnoTmlbDmja4KICAgICAgdHJlZURhdGEyOiBbXSwKICAgICAgLy/pu5jorqTpgInkuK3oioLngrkKICAgICAgZGVmYXVsdENoZWNrZWRJZHM6IFtdLAogICAgICAvL+m7mOiupOaJqeWxleiKgueCuQogICAgICBkZWZhdWx0RXhwYW5kSWRzOiBbXSwKICAgICAgLy/kuLTml7blm77niYflvLnmoYbmlbDnu4QKICAgICAgaW1nUG9wRGl2QXJyYXk6IFtdLAogICAgICBtYXJrTGF5ZXJBcnJheTogW10sCiAgICAgIGRlZmF1bHRQcm9wczogewogICAgICAgIGNoaWxkcmVuOiAnY2hpbGRyZW4nLAogICAgICAgIGxhYmVsOiAnbGFiZWwnCiAgICAgIH0sCiAgICAgIGltYWdlUG9wQXJyYXk6IFtdLAogICAgICBpbWFnZU92ZXJMYXlBcnJheTogW10sCiAgICAgIHRleHRNYXJrTGF5ZXJObUFycmF5OiBbXSwKICAgICAgbWFya01pblpvb206IDE0LjUsCiAgICAgIG1hcmtGbGFnOiBmYWxzZSwKICAgICAgbWFya1ZlY3RvckFycmF5OiBbXSwKICAgICAgc2hvd0drOiBmYWxzZSwKICAgICAgc2hvd0J6OiBmYWxzZSwKICAgICAgcHJvamVjdE5hbWU6ICcnLAogICAgICBzdGFydDogJycsCiAgICAgIGVuZDogJycsCiAgICAgIHByb2plY3REZXNjOiAnJywKICAgICAgbGVuZ3RoOiAnJywKICAgICAgenR6OiAnJywKICAgICAgc3RhdHVzOiAnJywKICAgICAgYno6ICcnLAogICAgICBrY3NqZmZoOiAnJywKICAgICAgaXNEcmFnYWJsZTogZmFsc2UsCiAgICAgIC8v5piv5ZCm5Y+v5Lul5ouW5YqoCiAgICAgIGN1cnJlbnRYOiAnJywKICAgICAgLy/ngrnlh7vml7bpvKDmoIfot53lt6bovrnnmoTot53nprsKICAgICAgY3VycmVudFk6ICcnLAogICAgICAvL+eCueWHu+aXtum8oOagh+i3nemhtui+ueeahOi3neemuwogICAgICBvYmpYOiAnJywKICAgICAgLy/ngrnlh7vml7blhYPntKDot53lt6bovrnnmoTot53nprsKICAgICAgb2JqWTogJycsCiAgICAgIC8v54K55Ye75pe25YWD57Sg6Led6aG26L6555qE6Led56a7CiAgICAgIGFjdGl2ZUJ0bjogJzInCiAgICB9OwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIC8v6I635Y+W6I+c5Y2VSUQKICAgIHRoaXMubWVudUlkID0gKDAsIF9yZXF1ZXN0LmdldFVybEtleSkoJ21lbnVJZCcpOyAvL+agueaNruiPnOWNlUlE5p+l6K+i57uE5Lu25L+h5oGvCgogICAgdGhpcy5maW5kQ29tcG9uZW50SW5mbyh0aGlzKTsKICAgIHRoaXMucmVtb3ZlUG9wdXAoKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgfSwKICB3YXRjaDogewogICAgZGVmYXVsdENoZWNrZWRJZHM6IGZ1bmN0aW9uIGRlZmF1bHRDaGVja2VkSWRzKCkgewogICAgICAvL+WIneWni+WMluWcsOWbvgogICAgICB0aGlzLmluaXRMYXllclRvTWFwV2ZzKHRoaXMpOyAvL+a3u+WKoOiHquWumuS5ieWbvuWxggoKICAgICAgdmFyIGNoZWNrZWRJZHMgPSB0aGlzLmdldFRyZWVjaGVja2VkSWQodGhpcy50cmVlRGF0YTIpOwogICAgICB0aGlzLmFkZFZlY3RvckxheWVyV2ZzKGNoZWNrZWRJZHMpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgZmluZENvbXBvbmVudEluZm86IGZ1bmN0aW9uIGZpbmRDb21wb25lbnRJbmZvKF90aGlzKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgKDAsIF9jb21wb25lbnQuZmluZENvbXBvbmVudEluZm8pKHRoaXMubWVudUlkLCBudWxsKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmICghcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGxlZ2VuZENvbmZpZ0RhdGEgPSByZXNwb25zZS5kYXRhLmRlY0xlZ2VuZENvbmZpZ0xpc3Q7CgogICAgICAgIGlmIChsZWdlbmRDb25maWdEYXRhICYmIGxlZ2VuZENvbmZpZ0RhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgLy/orr7nva7moJHoioLngrnmlbDmja4KICAgICAgICAgIHZhciB0cmVlRGF0YV8gPSBsZWdlbmRDb25maWdEYXRhWzBdOyAvL+makOiXj+iuvue9rueahOiKgueCuQoKICAgICAgICAgIF90aGlzLnRyZWVEYXRhMiA9IHRyZWVEYXRhXzsgLy/orr7nva7pobbnuqfoj5zljZXpgInkuK0KCiAgICAgICAgICB2YXIgZXhwYW5kSWRzID0gW107CgogICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCB0cmVlRGF0YV8ubGVuZ3RoOyBrKyspIHsKICAgICAgICAgICAgdmFyIGl0ZW0gPSB0cmVlRGF0YV9ba107CgogICAgICAgICAgICBpZiAoaXRlbS5wYXJlbnRJZCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgdmFyIGNoaWxkcmVuXyA9IGl0ZW0uY2hpbGRyZW47CgogICAgICAgICAgICAgIGlmIChjaGlsZHJlbl8gIT0gbnVsbCAmJiBjaGlsZHJlbl8ubGVuZ3RoICE9IDApIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY2hpbGRyZW5fLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgIGV4cGFuZElkcy5wdXNoKGNoaWxkcmVuX1tqXS5pZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGV4cGFuZElkcy5wdXNoKGl0ZW0uaWQpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSAvL+m7mOiupOWxleWxleW8gOS6jOe6p+iPnOWNlQoKCiAgICAgICAgICBfdGhpczIuZGVmYXVsdEV4cGFuZElkcyA9IGV4cGFuZElkczsKICAgICAgICAgIF90aGlzMi5kZWZhdWx0Q2hlY2tlZElkcyA9IF90aGlzLmdldFRyZWVjaGVja2VkSWQodHJlZURhdGFfKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOWIneWni+WMluWcsOWbvgogICAgaW5pdExheWVyVG9NYXBXZnM6IGZ1bmN0aW9uIGluaXRMYXllclRvTWFwV2ZzKF90aGlzKSB7CiAgICAgIHZhciBtYXBDb250YWluZXIgPSBfdGhpcy4kcmVmcy5tYXA7CiAgICAgIHd4TWFwTGF5ZXIuc2V0VmlzaWJsZShmYWxzZSk7CiAgICAgIHZhciBsYXllcnMgPSBbZ2FvZGVNYXBMYXllciwgd3hNYXBMYXllcl07IC8v5bCG5Zu+5bGC5Yqg5YWlTWFwCgogICAgICB2YXIgbWFwID0gbmV3IF9vbDIuTWFwKHsKICAgICAgICBsYXllcnM6IGxheWVycywKICAgICAgICB0YXJnZXQ6IG1hcENvbnRhaW5lciwKICAgICAgICB2aWV3OiB2aWV3CiAgICAgIH0pOyAvLyDmt7vliqDpvKDmoIfngrnlh7vkuovku7YKCiAgICAgIG1hcC5vbignY2xpY2snLCBfdGhpcy5tYXBDbGljayk7CiAgICAgIG1hcC5vbignbW92ZWVuZCcsIHRoaXMubWFwTW92ZWVuZCk7IC8vIOS/neWtmOWcsOWbvgoKICAgICAgX3RoaXMubWFwRGF0YSA9IG1hcDsKICAgIH0sCiAgICBhc3NlbWJsZUxheWVySXRlbXM6IGZ1bmN0aW9uIGFzc2VtYmxlTGF5ZXJJdGVtcyhpdGVtLCBhcnIsIG0sIGNoZWNrZWRBcnJheSkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBuZXdJdGVtID0gbnVsbDsKCiAgICAgIGlmIChpdGVtLmxheWVyTmFtZSAhPSBudWxsKSB7CiAgICAgICAgdmFyIG5lZWRBZGQgPSBpdGVtLmZpbHRlclZhbHVlIHx8IGl0ZW0uY2hpbGRyZW4gIT0gbnVsbCAmJiBpdGVtLmNoaWxkcmVuICE9IHVuZGVmaW5lZDsKCiAgICAgICAgaWYgKCFuZWVkQWRkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgZXhpc3RJdGVtOwoKICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGlmIChtW2pdLmxheWVyTmFtZSA9PSBpdGVtLmxheWVyTmFtZSkgewogICAgICAgICAgICBleGlzdEl0ZW0gPSBtW2pdOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChleGlzdEl0ZW0gIT0gbnVsbCkgewogICAgICAgICAgYXJyID0gZXhpc3RJdGVtLnRyZWVEYXRhSXRlbTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXJyID0gW107CiAgICAgICAgICBuZXdJdGVtID0ge307CiAgICAgICAgICBuZXdJdGVtLnRyZWVEYXRhSXRlbSA9IGFycjsKICAgICAgICAgIG5ld0l0ZW0ubGF5ZXJOYW1lID0gaXRlbS5sYXllck5hbWU7CiAgICAgICAgICBuZXdJdGVtLmZpbHRlcktleSA9IGl0ZW0uZmlsdGVyS2V5OwogICAgICAgIH0KICAgICAgfSAvL+mAieS4reeKtuaAgQoKCiAgICAgIHZhciBpZEluZGV4ID0gY2hlY2tlZEFycmF5LmZpbmRJbmRleChmdW5jdGlvbiAoaXRlbTIpIHsKICAgICAgICByZXR1cm4gaXRlbTIgPT0gaXRlbS5pZDsKICAgICAgfSk7CgogICAgICBpZiAoaWRJbmRleCAhPSAtMSkgewogICAgICAgIGlmIChuZXdJdGVtICE9IG51bGwpIHsKICAgICAgICAgIG0ucHVzaChuZXdJdGVtKTsKICAgICAgICB9CgogICAgICAgIGlmIChpdGVtLmZpbHRlclZhbHVlICE9IG51bGwpIHsKICAgICAgICAgIGFyci5wdXNoKGl0ZW0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4gIT0gbnVsbCAmJiBpdGVtLmNoaWxkcmVuICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgaXRlbS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICAgIF90aGlzMy5hc3NlbWJsZUxheWVySXRlbXMoaSwgYXJyLCBtLCBjaGVja2VkQXJyYXkpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgLy/pgJLlvZLojrfoioLngrnkv6Hmga8KICAgIGdldENoZWNrZWRJZHNSZWN1cjogZnVuY3Rpb24gZ2V0Q2hlY2tlZElkc1JlY3VyKGl0ZW0sIGlkc18pIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICBpZiAoaXRlbS5pZCAmJiBpdGVtLmNoZWNrU3RhdHVzID09ICdZJykgewogICAgICAgIGlkc18gPSBpZHNfID09IG51bGwgPyBbXSA6IGlkc187CiAgICAgICAgaWRzXy5wdXNoKGl0ZW0uaWQpOwogICAgICB9IC8v5aaC5p6c5a2Q6IqC54K56YCJ5Lit77yM6ZyA6KaB5bCG54i26IqC5Y2K6YCJ5Lit54q25oCB6IqC54K55Yqg5YWlCgoKICAgICAgdmFyIGN1cnJlbnRMZW4gPSBpZHNfLmxlbmd0aDsKCiAgICAgIGlmIChpdGVtLmNoaWxkcmVuICE9IG51bGwpIHsKICAgICAgICBpdGVtLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIF90aGlzNC5nZXRDaGVja2VkSWRzUmVjdXIoaXRlbSwgaWRzXyk7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChjdXJyZW50TGVuIDwgaWRzXy5sZW5ndGggJiYgaWRzXy5pbmRleE9mKGl0ZW0uaWQpID09IC0xKSB7CiAgICAgICAgICBpZHNfLnB1c2goaXRlbS5pZCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgLy/ojrflj5bmoJHmiYDmnInnmoToioLngrnkv6Hmga8KICAgIGdldFRyZWVjaGVja2VkSWQ6IGZ1bmN0aW9uIGdldFRyZWVjaGVja2VkSWQodHJlZURhdGEpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB2YXIgaWRzID0gW107CiAgICAgIHRyZWVEYXRhLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICBfdGhpczUuZ2V0Q2hlY2tlZElkc1JlY3VyKGl0ZW0sIGlkcyk7CiAgICAgIH0pOwogICAgICByZXR1cm4gaWRzOwogICAgfSwKICAgIGluaXRTaW5nbGVMYXllcjogZnVuY3Rpb24gaW5pdFNpbmdsZUxheWVyKGZlYXR1cmVzRGF0YSwgcGFyYW0sIGRhdGFJdGVtLCBfdGhpcykgewogICAgICB2YXIgbGF5ZXJOYW1lID0gcGFyYW0ubGF5ZXJOYW1lOwogICAgICB2YXIgdmVjdG9yU291cmNlVG1wOwoKICAgICAgaWYgKGxheWVyTmFtZSA9PSAnVGVzdDp4enh3JyB8fCBsYXllck5hbWUgPT0gJ1Rlc3Q6anF4dycgfHwgbGF5ZXJOYW1lID09ICdUZXN0OnlxeHcnKSB7CiAgICAgICAgdmVjdG9yU291cmNlVG1wID0gbmV3IF9WZWN0b3IuZGVmYXVsdCh7CiAgICAgICAgICBmZWF0dXJlczogbmV3IF9HZW9KU09OLmRlZmF1bHQoewogICAgICAgICAgICBmZWF0dXJlUHJvamVjdGlvbjogJ0VQU0c6Mzg1NycsCiAgICAgICAgICAgIGRhdGFQcm9qZWN0aW9uOiAnRVBTRzo0MzI2JwogICAgICAgICAgfSkucmVhZEZlYXR1cmVzKGZlYXR1cmVzRGF0YSkKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2ZWN0b3JTb3VyY2VUbXAgPSBuZXcgX1ZlY3Rvci5kZWZhdWx0KHsKICAgICAgICAgIGZlYXR1cmVzOiBuZXcgX0dlb0pTT04uZGVmYXVsdCh7CiAgICAgICAgICAgIGZlYXR1cmVQcm9qZWN0aW9uOiAnRVBTRzozODU3JywKICAgICAgICAgICAgZGF0YVByb2plY3Rpb246ICdFUFNHOjQ1NDgnCiAgICAgICAgICB9KS5yZWFkRmVhdHVyZXMoZmVhdHVyZXNEYXRhKQogICAgICAgIH0pOwogICAgICB9CgogICAgICB2YXIgdmVjdG9yTGF5ZXJUbXAgPSBuZXcgX1ZlY3RvcjIuZGVmYXVsdCh7CiAgICAgICAgc291cmNlOiB2ZWN0b3JTb3VyY2VUbXAsCiAgICAgICAgbmFtZTogbGF5ZXJOYW1lLAogICAgICAgIGZpbHRlclZhbDogcGFyYW0uZmlsdGVyVmFsLAogICAgICAgIHN0eWxlOiBmdW5jdGlvbiBzdHlsZShmZWF0dXJlLCBzb2x1dGlvbikgewogICAgICAgICAgcmV0dXJuIF90aGlzLmluaXRMYXllclN0eWxlKGZlYXR1cmUsIGRhdGFJdGVtLCB2ZWN0b3JMYXllclRtcCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgY29uc29sZS5sb2cocGFyYW0ubGF5ZXJOYW1lICsgIjoiICsgcGFyYW0uZmlsdGVyVmFsKTsKCiAgICAgIF90aGlzLm1hcERhdGEuYWRkTGF5ZXIodmVjdG9yTGF5ZXJUbXApOwoKICAgICAgX3RoaXMubGF5ZXJBcnJheS5wdXNoKHZlY3RvckxheWVyVG1wKTsKICAgIH0sCiAgICAvL+a3u+WKoOWNleS4quWbvuWxguS/oeaBrwogICAgYWRkU2luZ2xlTGF5ZXI6IGZ1bmN0aW9uIGFkZFNpbmdsZUxheWVyKF90aGlzLCBsYXllck5hbWUsIGRhdGFJdGVtKSB7CiAgICAgIHZhciBmaWx0ZXJLZXkgPSBkYXRhSXRlbS5maWx0ZXJLZXk7CiAgICAgIHZhciBmaWx0ZXJWYWwgPSBkYXRhSXRlbS5maWx0ZXJWYWx1ZTsKCiAgICAgIGlmICghbGF5ZXJOYW1lIHx8ICFmaWx0ZXJWYWwpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciB1cmwgPSBwcm9jZXNzLmVudi5WVUVfQVBQX0dJU19CQVNFX1VSTCArICcvVGVzdC9vd3M/c2VydmljZT1XRlMmdmVyc2lvbj0xLjAuMCZyZXF1ZXN0PUdldEZlYXR1cmUmdHlwZU5hbWU9JyArIGVuY29kZVVSSUNvbXBvbmVudChsYXllck5hbWUpICsgJyZtYXhGZWF0dXJlcz01MDAwMDAwMDAmb3V0cHV0Rm9ybWF0PWFwcGxpY2F0aW9uJTJGanNvbiZjcWxfZmlsdGVyPScgKyBlbmNvZGVVUklDb21wb25lbnQoZmlsdGVyS2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCgiJyIgKyBmaWx0ZXJWYWwgKyAiJyIpOwogICAgICB2YXIgcGFyYW0gPSB7CiAgICAgICAgbGF5ZXJOYW1lOiBsYXllck5hbWUsCiAgICAgICAgZmlsdGVyVmFsOiBmaWx0ZXJWYWwKICAgICAgfTsKICAgICAgY29uc29sZS5sb2coZGVjb2RlVVJJQ29tcG9uZW50KHVybCkpOwoKICAgICAgX2F4aW9zLmRlZmF1bHQuZ2V0KHVybCwgcGFyYW0sIHsKICAgICAgICB0aW1lb3V0OiAxMjAwMDAwCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHZhciBmZWF0dXJlc0RhdGEgPSByZXMuZGF0YTsKCiAgICAgICAgaWYgKGZlYXR1cmVzRGF0YSkgewogICAgICAgICAgX3RoaXMuaW5pdFNpbmdsZUxheWVyKGZlYXR1cmVzRGF0YSwgcGFyYW0sIGRhdGFJdGVtLCBfdGhpcyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvL+agueaNruWbvuWxguWQjeWtl+S7peWPiui/h+a7pOWxnuaAp+WAvOiOt+WPluWbvuWxguS/oeaBryjnur/lkozpnaLmlofku7blkIzml7bmn6Xor6LlpITnkIYpCiAgICBnZXRBcmVhTGluZUxheXM6IGZ1bmN0aW9uIGdldEFyZWFMaW5lTGF5cyhsYXllck5hbWUsIGZpbHRlclZhbCkgewogICAgICB2YXIgYXJyYXlzXyA9IFtdOwogICAgICB2YXIgaXNFcXVhbCA9IGZhbHNlOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmFyZWFMaW5lRmlsdGVyVmFscy5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmFyZWFMaW5lRmlsdGVyVmFsc1tpXSkgewogICAgICAgICAgaWYgKGFycmF5c18uaW5kZXhPZihrZXkpID09IC0xKSB7CiAgICAgICAgICAgIGFycmF5c18ucHVzaChrZXkpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChrZXkgPT0gbGF5ZXJOYW1lICYmIHRoaXMuYXJlYUxpbmVGaWx0ZXJWYWxzW2ldW2xheWVyTmFtZV0gPT0gZmlsdGVyVmFsKSB7CiAgICAgICAgICAgIGlzRXF1YWwgPSB0cnVlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChpc0VxdWFsKSB7CiAgICAgICAgcmV0dXJuIGFycmF5c187CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYXJyYXlzXyA9IFtdOwogICAgICAgIGFycmF5c18ucHVzaChsYXllck5hbWUpOwogICAgICAgIHJldHVybiBhcnJheXNfOwogICAgICB9CiAgICB9LAogICAgYWRkVmVjdG9yTGF5ZXJXZnM6IGZ1bmN0aW9uIGFkZFZlY3RvckxheWVyV2ZzKGNoZWNrZWRBcnJheSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGNoZWNrZWRMYXllck1hcCA9IHRoaXMuZ2V0TGF5ZXJNYXAoY2hlY2tlZEFycmF5KTsKCiAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY2hlY2tlZExheWVyTWFwLmxlbmd0aDsgaysrKSB7CiAgICAgICAgdmFyIGl0ZW0gPSBjaGVja2VkTGF5ZXJNYXBba107CiAgICAgICAgdmFyIHRyZWVEYXRhSXRlbXNfID0gaXRlbS50cmVlRGF0YUl0ZW07CiAgICAgICAgdmFyIGxheWVyTmFtZV8gPSBpdGVtLmxheWVyTmFtZTsKCiAgICAgICAgaWYgKCF0cmVlRGF0YUl0ZW1zXyB8fCB0cmVlRGF0YUl0ZW1zXy5sZW5ndGggPT0gMCB8fCAhbGF5ZXJOYW1lXykgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRyZWVEYXRhSXRlbXNfLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB2YXIgZmlsdGVyVmFsID0gdHJlZURhdGFJdGVtc19baV0uZmlsdGVyVmFsdWU7CiAgICAgICAgICB2YXIgZmlsdGVyS2V5ID0gdHJlZURhdGFJdGVtc19baV0uZmlsdGVyS2V5OwoKICAgICAgICAgIGlmICghZmlsdGVyS2V5IHx8ICFmaWx0ZXJWYWwpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy/lpITnkIbnur/lkozpnaLkuKTovrnpg73lrZjlnKjmlbDmja7nmoTmg4XlhrUKICAgICAgICAgICAgdmFyIGxheWVyRmlsZUFycmF5ID0gdGhpcy5nZXRBcmVhTGluZUxheXMobGF5ZXJOYW1lXywgZmlsdGVyVmFsKTsKCiAgICAgICAgICAgIGZvciAodmFyIG0gPSAwOyBtIDwgbGF5ZXJGaWxlQXJyYXkubGVuZ3RoOyBtKyspIHsKICAgICAgICAgICAgICB0aGlzLmFkZFNpbmdsZUxheWVyKHRoaXMsIGxheWVyRmlsZUFycmF5W21dLCB0cmVlRGF0YUl0ZW1zX1tpXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBjb25zb2xlLmxvZygi5Zu+5bGC77yaIiArIGxheWVyTmFtZV8gKyAi6L+H5ruk5YC877yaIiArIGZpbHRlclZhbCArICLor7fmsYLlvILluLjvvJoiLCBlcnIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvL30pCgogICAgfSwKICAgIGdldExheWVyTWFwOiBmdW5jdGlvbiBnZXRMYXllck1hcChjaGVja2VkQXJyYXkpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICBpZiAoY2hlY2tlZEFycmF5ID09IG51bGwpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgdmFyIGxheWVyTWFwID0gW107CiAgICAgIHRoaXMudHJlZURhdGEyLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICBfdGhpczYuYXNzZW1ibGVMYXllckl0ZW1zKGl0ZW0sIG51bGwsIGxheWVyTWFwLCBjaGVja2VkQXJyYXkpOwogICAgICB9KTsKICAgICAgbGF5ZXJNYXAgPSBsYXllck1hcC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5sYXllck5hbWUgJiYgaXRlbS5maWx0ZXJLZXk7CiAgICAgIH0pOwogICAgICByZXR1cm4gbGF5ZXJNYXA7CiAgICB9LAogICAgY3JlYXRlUG9pbnRTdHlsZTogZnVuY3Rpb24gY3JlYXRlUG9pbnRTdHlsZShmZWF0dXJlLCBpdGVtKSB7CiAgICAgIGlmICghaXRlbSkgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIHZhciBzdHlsZXMgPSBbXTsKICAgICAgdmFyIHN0eWxlID0gbmV3IF9TdHlsZS5kZWZhdWx0KHsKICAgICAgICAvL+Wbvuagh+agt+W8jwogICAgICAgIC8vIGltYWdlOiBuZXcgT2xTdHlsZUljb24oewogICAgICAgIC8vICAgYW5jaG9yOiBbMTAsIDE4XSwKICAgICAgICAvLyAgIHNjYWxlOiAxLAogICAgICAgIC8vICAgYW5jaG9yT3JpZ2luOiAndG9wLXJpZ2h0JywKICAgICAgICAvLyAgIGFuY2hvclhVbml0czogJ3BpeGVscycsCiAgICAgICAgLy8gICBhbmNob3JZVW5pdHM6ICdwaXhlbHMnLAogICAgICAgIC8vICAgb2Zmc2V0T3JpZ2luOiAnYm90dG9tLWxlZnQnLAogICAgICAgIC8vICAgb3BhY2l0eTogMSwKICAgICAgICAvLyAgIHNyYzogcmVxdWlyZSgnLi4vLi4vYXNzZXRzL2ltYWdlcy9tYXJrLnBuZycpLAogICAgICAgIC8vIH0pLAogICAgICAgIC8v5paH5pys5qC35byPCiAgICAgICAgdGV4dDogbmV3IF9UZXh0LmRlZmF1bHQoewogICAgICAgICAgdGV4dEFsaWduOiAnY2VudGVyJywKICAgICAgICAgIHRleHRCYXNlbGluZTogJ21pZGRsZScsCiAgICAgICAgICBmb250OiAnbm9ybWFsIDAuMTVyZW0g5b6u6L2v6ZuF6buRJywKICAgICAgICAgIHRleHQ6IGZlYXR1cmUudmFsdWVzXy5uYW1lLAogICAgICAgICAgb2Zmc2V0WTogLTI1LAogICAgICAgICAgZmlsbDogbmV3IF9zdHlsZS5GaWxsKHsKICAgICAgICAgICAgY29sb3I6IGZlYXR1cmUudmFsdWVzXy5mb250X2NvbG9yCiAgICAgICAgICB9KSwKICAgICAgICAgIHJvdGF0aW9uOiBmZWF0dXJlLnZhbHVlc18uZm9udF9hbmdsZSAqIE1hdGguUEkgLyAxODAsCiAgICAgICAgICBwYWRkaW5nOiBbMiwgNSwgMiwgNV0KICAgICAgICB9KSwKICAgICAgICAvLyDorr7nva7lsYLnuqcKICAgICAgICB6SW5kZXg6IDE5OTk5OTk5OTkKICAgICAgfSk7CiAgICAgIHN0eWxlcy5wdXNoKHN0eWxlKTsKICAgICAgcmV0dXJuIHN0eWxlczsKICAgIH0sCiAgICAvL+WIneWni+imgee0oOagt+W8jwogICAgaW5pdExheWVyU3R5bGU6IGZ1bmN0aW9uIGluaXRMYXllclN0eWxlKGZlYXR1cmUsIGl0ZW0sIHZlY3RvckxheWVyVG1wKSB7CiAgICAgIHZhciBmaWxlVHlwZSA9IGZlYXR1cmUudmFsdWVzXy5maWxlX3R5cGU7CgogICAgICBpZiAoZmVhdHVyZS52YWx1ZXNfLmdlb21ldHJ5IGluc3RhbmNlb2YgX1BvaW50LmRlZmF1bHQpIHsKICAgICAgICBpZiAoZmlsZVR5cGUgJiYgZmlsZVR5cGUgPT0gJ2ltYWdlJykgewogICAgICAgICAgLy/lm77niYflvLnmoYbmoLflvI8KICAgICAgICAgIGZlYXR1cmUudmFsdWVzXy5zcmMgPSByZXF1aXJlKCJAL2Fzc2V0cy9pbWFnZXMvaW1nX21hcmsucG5nIik7CgogICAgICAgICAgaWYgKHRoaXMuaW1hZ2VQb3BBcnJheS5pbmRleE9mKGZlYXR1cmUudmFsdWVzXy5uYW1lKSA9PSAtMSkgewogICAgICAgICAgICBjb25zb2xlLmxvZyhmZWF0dXJlLnZhbHVlc18ubmFtZSk7CiAgICAgICAgICAgIHRoaXMuaW1hZ2VQb3BBcnJheS5wdXNoKGZlYXR1cmUudmFsdWVzXy5uYW1lKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVJbWFnZU1hcmtTdHlsZShmZWF0dXJlLCB2ZWN0b3JMYXllclRtcCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBsYXllck5hbWUgPSB2ZWN0b3JMYXllclRtcC52YWx1ZXNfLm5hbWU7CgogICAgICAgICAgaWYgKHRoaXMudGV4dE1hcmtMYXllck5tQXJyYXkuaW5kZXhPZihsYXllck5hbWUpID09IC0xKSB7CiAgICAgICAgICAgIHZlY3RvckxheWVyVG1wLnNldFZpc2libGUoZmFsc2UpOwogICAgICAgICAgICB2ZWN0b3JMYXllclRtcC5zZXQoJ2luaXRIaWRlJywgdHJ1ZSk7CiAgICAgICAgICAgIHRoaXMudGV4dE1hcmtMYXllck5tQXJyYXkucHVzaChsYXllck5hbWUpOwogICAgICAgICAgfQoKICAgICAgICAgIHZlY3RvckxheWVyVG1wLnZhbHVlc18uekluZGV4ID0gOTk5OTk5OTk5OTk5OTk7CiAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVQb2ludFN0eWxlKGZlYXR1cmUsIGl0ZW0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5pbml0R3JhcGhTdHlsZShmZWF0dXJlLCBpdGVtKTsKICAgICAgfQogICAgfSwKICAgIGdldFN0eWxlU2V0dGluZzogZnVuY3Rpb24gZ2V0U3R5bGVTZXR0aW5nKGZlYXR1cmUsIGl0ZW0pIHsKICAgICAgdmFyIHN0eWxlID0ge307CiAgICAgIHZhciBzdHJva2VDb2xvciA9IGl0ZW0uc3Ryb2tlQ29sb3IgPyBpdGVtLnN0cm9rZUNvbG9yIDogZmVhdHVyZS5nZXQoJ2JvcmRlcl9jb2wnKSA/IGZlYXR1cmUuZ2V0KCdib3JkZXJfY29sJykgOiBmZWF0dXJlLmdldCgnbGluZV9jb2xvcicpOwogICAgICB2YXIgZmlsbENvbG9yID0gaXRlbS5maWxsQ29sb3IgPyBpdGVtLmZpbGxDb2xvciA6IGZlYXR1cmUuZ2V0KCdmaWxsX2NvbG9yJyk7CiAgICAgIHZhciBzdHJva2VXaWR0aCA9IGl0ZW0ud2lkdGggPyBpdGVtLndpZHRoIDogZmVhdHVyZS5nZXQoJ2JvcmRlcl93aWQnKSA/IGZlYXR1cmUuZ2V0KCdib3JkZXJfd2lkJykgOiBmZWF0dXJlLmdldCgnbGluZV93aWR0aCcpOwogICAgICBzdHlsZS5zdHJva2VDb2xvciA9IHN0cm9rZUNvbG9yOwogICAgICBzdHlsZS5maWxsQ29sb3IgPSBmaWxsQ29sb3I7CiAgICAgIHN0eWxlLnN0cm9rZVdpZHRoID0gc3Ryb2tlV2lkdGg7CiAgICAgIHJldHVybiBzdHlsZTsKICAgIH0sCiAgICBpbml0R3JhcGhTdHlsZTogZnVuY3Rpb24gaW5pdEdyYXBoU3R5bGUoZmVhdHVyZSwgaXRlbSkgewogICAgICB2YXIgc3R5bGVzID0gW107CiAgICAgIHZhciBmaWxsX3N0eWxlID0gZmVhdHVyZS5nZXQoImZpbGxfc3R5bGUiKTsKCiAgICAgIGlmICghaXRlbSkgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIHZhciBzdHlsZVNldHRpbmcgPSB0aGlzLmdldFN0eWxlU2V0dGluZyhmZWF0dXJlLCBpdGVtKTsKICAgICAgdmFyIGRhc2hPZmZzZXQgPSBpdGVtLmRhc2hPZmZzZXQ7CiAgICAgIHZhciBkYXNoYXJyYXkgPSBpdGVtLmRhc2hBcnJheTsKICAgICAgdmFyIGxpbmVDb2xvciA9IHN0eWxlU2V0dGluZy5zdHJva2VDb2xvcjsKICAgICAgdmFyIGZpbGxDb2xvciA9IHN0eWxlU2V0dGluZy5maWxsQ29sb3I7CiAgICAgIHZhciBzdHJva2VXaWR0aCA9IHN0eWxlU2V0dGluZy5zdHJva2VXaWR0aDsKICAgICAgdmFyIHN0eWxlID0gbmV3IF9zdHlsZS5TdHlsZSgpOyAvLyAvL+e6v+adoeminOiJsgogICAgICAvLyBsZXQgc3Ryb2tlQ29sb3IgPSBpdGVtLnN0cm9rZUNvbG9yOwogICAgICAvLyBsZXQgc3Ryb2tlV2lkdGggPSBpdGVtLndpZHRoOwoKICAgICAgdmFyIHN0cm9rZSA9IG51bGw7CgogICAgICBpZiAobGluZUNvbG9yKSB7CiAgICAgICAgc3Ryb2tlID0gbmV3IF9zdHlsZS5TdHJva2UoewogICAgICAgICAgY29sb3I6IGxpbmVDb2xvcgogICAgICAgIH0pOwogICAgICB9IC8vIGlmIChzdHJva2UgPT0gbnVsbCAmJiBzdHJva2VDb2xvciAhPSBudWxsKSB7CiAgICAgIC8vICAgc3Ryb2tlID0gbmV3IFN0cm9rZSh7CiAgICAgIC8vICAgICBjb2xvcjogc3Ryb2tlQ29sb3IsCiAgICAgIC8vICAgfSkKICAgICAgLy8gfQoKCiAgICAgIGlmIChzdHJva2VXaWR0aCkgewogICAgICAgIGlmIChzdHJva2UgPT0gbnVsbCkgewogICAgICAgICAgc3Ryb2tlID0gbmV3IF9zdHlsZS5TdHJva2UoewogICAgICAgICAgICB3aWR0aDogc3Ryb2tlV2lkdGgKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzdHJva2Uud2lkdGhfID0gc3Ryb2tlV2lkdGg7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZGFzaE9mZnNldCkgewogICAgICAgIHN0cm9rZS5saW5lRGFzaE9mZnNldF8gPSBkYXNoT2Zmc2V0OwogICAgICB9CgogICAgICBpZiAoZGFzaGFycmF5KSB7CiAgICAgICAgc3Ryb2tlLmxpbmVEYXNoXyA9IGRhc2hhcnJheS5zcGxpdCgiLCIpOwogICAgICB9CgogICAgICBzdHlsZS5zdHJva2VfID0gc3Ryb2tlOyAvL+Whq+WFheminOiJsgoKICAgICAgaWYgKGZpbGxDb2xvciAmJiBmaWxsX3N0eWxlICE9ICcnICYmIGZpbGxfc3R5bGUgIT0gJ05vIEZpbGwnKSB7CiAgICAgICAgdmFyIGZpbGwgPSBuZXcgX3N0eWxlLkZpbGwoewogICAgICAgICAgY29sb3I6IGZpbGxDb2xvcgogICAgICAgIH0pOwogICAgICAgIHN0eWxlLmZpbGxfID0gZmlsbDsKICAgICAgfQoKICAgICAgc3R5bGVzLnB1c2goc3R5bGUpOwogICAgICByZXR1cm4gc3R5bGVzOwogICAgfSwKICAgIGhhbmRsZUNoZWNrQ2hhbmdlOiBmdW5jdGlvbiBoYW5kbGVDaGVja0NoYW5nZShkYXRhXykgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIHRoaXMuY2xlYXJIaWdobGlnaHQoKTsKICAgICAgdGhpcy5yZW1vdmVQb3B1cCgpOwogICAgICB2YXIgaGFsZkNoZWNrTm9kZSA9IHRoaXMuJHJlZnMudHJlZS5nZXRIYWxmQ2hlY2tlZE5vZGVzKCk7CiAgICAgIHZhciBoYWxmQ2hlY2tJZHMgPSBbXTsKICAgICAgaGFsZkNoZWNrTm9kZS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaGFsZkNoZWNrSWRzLnB1c2goaXRlbS5pZCk7CiAgICAgIH0pOyAvL+iOt+WPlumAieS4reS7peWPiuWNiumAieS4reiKgueCuQoKICAgICAgdmFyIGNoZWNrZWRBcnJheSA9IHRoaXMuJHJlZnMudHJlZS5nZXRDaGVja2VkS2V5cyhmYWxzZSk7CiAgICAgIGNoZWNrZWRBcnJheSA9IGNoZWNrZWRBcnJheS5jb25jYXQoaGFsZkNoZWNrSWRzKTsKICAgICAgdmFyIGNoZWNrZWRMYXllckFycmF5ID0gdGhpcy5nZXRMYXllck1hcChjaGVja2VkQXJyYXkpOwogICAgICB2YXIgY3VycmVudExheWVycyA9IHRoaXMubGF5ZXJBcnJheTsgLy/lpoLmnpzlvZPliY3pgInkuK3mlbDnu4TkuLrnqbrvvIzlvZPliY3miYDmnInlm77lsYLpmpDol48KCiAgICAgIGlmIChjaGVja2VkTGF5ZXJBcnJheSA9PSBudWxsIHx8IGNoZWNrZWRMYXllckFycmF5Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgY3VycmVudExheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICBpdGVtLnNldFZpc2libGUoZmFsc2UpOyAvL3RoaXMuc2V0TGF5ZXJWaXNpYmxlKGl0ZW0sIGZhbHNlKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy/ojrflj5blvoXmt7vliqDnmoTlm77lsYIo5Zu+5L6L5qCR5Yid5aeL5YyW6YOo5YiG6YCJ5LitKQoKCiAgICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGkpIHsKICAgICAgICBpZiAoIWNoZWNrZWRMYXllckFycmF5W2ldLmxheWVyTmFtZSkgewogICAgICAgICAgcmV0dXJuICJjb250aW51ZSI7CiAgICAgICAgfQoKICAgICAgICB2YXIgdHJlZURhdGFJdGVtID0gY2hlY2tlZExheWVyQXJyYXlbaV0udHJlZURhdGFJdGVtOwoKICAgICAgICBpZiAoIXRyZWVEYXRhSXRlbSkgewogICAgICAgICAgY3VycmVudExheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIGlmIChpdGVtLnZhbHVlc18ubmFtZSA9PSBjaGVja2VkTGF5ZXJBcnJheVtpXS5sYXllck5hbWUpIHsKICAgICAgICAgICAgICBpdGVtLnNldFZpc2libGUoZmFsc2UpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiAiY29udGludWUiOwogICAgICAgIH0KCiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0cmVlRGF0YUl0ZW0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIHZhciBpdGVtID0gdHJlZURhdGFJdGVtW2pdOwogICAgICAgICAgdmFyIF9leGlzdDIgPSBmYWxzZTsKCiAgICAgICAgICBmb3IgKHZhciBfbiA9IDA7IF9uIDwgY3VycmVudExheWVycy5sZW5ndGg7IF9uKyspIHsKICAgICAgICAgICAgdmFyIGxheWVyID0gY3VycmVudExheWVyc1tfbl07CgogICAgICAgICAgICBpZiAobGF5ZXIudmFsdWVzXy5maWx0ZXJWYWwgPT0gaXRlbS5maWx0ZXJWYWx1ZSAmJiBsYXllci52YWx1ZXNfLm5hbWUgPT0gY2hlY2tlZExheWVyQXJyYXlbaV0ubGF5ZXJOYW1lKSB7CiAgICAgICAgICAgICAgX2V4aXN0MiA9IHRydWU7CiAgICAgICAgICAgICAgbGF5ZXIuc2V0VmlzaWJsZSh0cnVlKTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSAvL+aWsOWinuWbvuWxggoKCiAgICAgICAgICBpZiAoIV9leGlzdDIpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIuaWsOWinuWbvuWxgj09PT09PT09PT09PT09PT09PT09PT09Iik7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNoZWNrZWRMYXllckFycmF5W2ldLmxheWVyTmFtZSk7IC8v5aSE55CG57q/5ZKM6Z2i5Lik6L656YO95a2Y5Zyo5pWw5o2u55qE5oOF5Ya1CgogICAgICAgICAgICB2YXIgbGF5ZXJGaWxlQXJyYXkgPSBfdGhpczcuZ2V0QXJlYUxpbmVMYXlzKGNoZWNrZWRMYXllckFycmF5W2ldLmxheWVyTmFtZSwgaXRlbS5maWx0ZXJWYWx1ZSk7CgogICAgICAgICAgICBmb3IgKHZhciBfbTIgPSAwOyBfbTIgPCBsYXllckZpbGVBcnJheS5sZW5ndGg7IF9tMisrKSB7CiAgICAgICAgICAgICAgX3RoaXM3LmFkZFNpbmdsZUxheWVyKF90aGlzNywgbGF5ZXJGaWxlQXJyYXlbX20yXSwgaXRlbSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hlY2tlZExheWVyQXJyYXkubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgX3JldCA9IF9sb29wKGkpOwoKICAgICAgICBpZiAoX3JldCA9PT0gImNvbnRpbnVlIikgY29udGludWU7CiAgICAgIH0gLy/pmpDol4/lj5bmtojli77pgInnmoTlm77lsYIKCgogICAgICBpZiAoIWN1cnJlbnRMYXllcnMgfHwgY3VycmVudExheWVycy5sZW5ndGggPT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGV4aXN0TGF5ZXIgPSBbXTsKCiAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY3VycmVudExheWVycy5sZW5ndGg7IGsrKykgewogICAgICAgIHZhciBleGlzdCA9IGZhbHNlOwoKICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgY2hlY2tlZExheWVyQXJyYXkubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgICB2YXIgdGVtcEl0ZW1zID0gY2hlY2tlZExheWVyQXJyYXlbX2ldLnRyZWVEYXRhSXRlbTsKICAgICAgICAgIHZhciBsYXlBcnJheV8gPSB0aGlzLmdldEFyZWFMaW5lTGF5cyhjaGVja2VkTGF5ZXJBcnJheVtfaV0ubGF5ZXJOYW1lLCBjdXJyZW50TGF5ZXJzW2tdLnZhbHVlc18uZmlsdGVyVmFsKTsKCiAgICAgICAgICBmb3IgKHZhciBtID0gMDsgbSA8IHRlbXBJdGVtcy5sZW5ndGg7IG0rKykgewogICAgICAgICAgICBpZiAoY3VycmVudExheWVyc1trXS52YWx1ZXNfLmZpbHRlclZhbCA9PSB0ZW1wSXRlbXNbbV0uZmlsdGVyVmFsdWUgJiYgY3VycmVudExheWVyc1trXS52YWx1ZXNfLm5hbWUgPT0gY2hlY2tlZExheWVyQXJyYXlbX2ldLmxheWVyTmFtZSkgewogICAgICAgICAgICAgIGV4aXN0ID0gdHJ1ZTsKCiAgICAgICAgICAgICAgaWYgKGV4aXN0TGF5ZXIuaW5kZXhPZih0ZW1wSXRlbXNbbV0uZmlsdGVyVmFsdWUpID09IC0xICYmIGxheUFycmF5Xy5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgICBleGlzdExheWVyLnB1c2godGVtcEl0ZW1zW21dLmZpbHRlclZhbHVlKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGN1cnJlbnRMYXllcnNba10uc2V0VmlzaWJsZSh0cnVlKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCFleGlzdCkgewogICAgICAgICAgY3VycmVudExheWVyc1trXS5zZXRWaXNpYmxlKGZhbHNlKTsKICAgICAgICB9CiAgICAgIH0gLy/nur/lkozpnaLlkIzml7bmn6Xor6LmmL7npLrpmpDol4/mjqfliLblpITnkIYKCgogICAgICBmb3IgKHZhciBuID0gMDsgbiA8IGN1cnJlbnRMYXllcnMubGVuZ3RoOyBuKyspIHsKICAgICAgICB2YXIgX2V4aXN0ID0gZmFsc2U7CiAgICAgICAgdmFyIGFyZWFMaW5lQ29uZmlnID0gdGhpcy5nZXRBcmVhTGluZUxheXMoY3VycmVudExheWVyc1tuXS52YWx1ZXNfLm5hbWUsIGN1cnJlbnRMYXllcnNbbl0udmFsdWVzXy5maWx0ZXJWYWwpOwoKICAgICAgICBmb3IgKHZhciBfbSA9IDA7IF9tIDwgZXhpc3RMYXllci5sZW5ndGg7IF9tKyspIHsKICAgICAgICAgIGlmIChjdXJyZW50TGF5ZXJzW25dLnZhbHVlc18uZmlsdGVyVmFsID09IGV4aXN0TGF5ZXJbX21dICYmIGFyZWFMaW5lQ29uZmlnLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgX2V4aXN0ID0gdHJ1ZTsKICAgICAgICAgICAgY3VycmVudExheWVyc1tuXS5zZXRWaXNpYmxlKHRydWUpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCFfZXhpc3QpIHsKICAgICAgICAgIGlmIChhcmVhTGluZUNvbmZpZy5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgIGN1cnJlbnRMYXllcnNbbl0uc2V0VmlzaWJsZShmYWxzZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIOWbvueJh+agh+azqOWFs+mXreW8gOWQr+aXtuaOp+WItuaYvuekuumakOiXjwoKCiAgICAgIHRoaXMuaW1hZ2VPdmVyTGF5QXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIGlmIChpdGVtLmlkID09IGZpbHRlclZhbCkgewogICAgICAgICAgaWYgKCF2aXNpYmxlKSB7CiAgICAgICAgICAgIF90aGlzNy5yZW1vdmVJbWdQb3B1cChpdGVtLmlkKTsKICAgICAgICAgIH0gZWxzZSB7Ly8gY29uc29sZS5sb2coImNjY2NjIik7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGl0ZW0pOwogICAgICAgICAgICAvL3RoaXMuc2hvd0ltZ1BvcHVwKGl0ZW0uaWQsIGl0ZW0udmFsdWVzXy5wb3NpdGlvbikKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOW8ueWHuuahhgogICAgYWRkUG9wdXA6IGZ1bmN0aW9uIGFkZFBvcHVwKGNvb3JkaW5hdGUsIGZlYXR1cmUpIHsKICAgICAgdGhpcy5yZW1vdmVQb3B1cCgpOwogICAgICB2YXIgZmVhdHVyZVZhbHVlcyA9IGZlYXR1cmUudmFsdWVzXzsKICAgICAgdGhpcy5wcm9qZWN0TmFtZSA9IGZlYXR1cmVWYWx1ZXMubGF5ZXIgPT0gbnVsbCA/ICcnIDogZmVhdHVyZVZhbHVlcy5sYXllcjsKICAgICAgdGhpcy5wcm9qZWN0RGVzYyA9IGZlYXR1cmVWYWx1ZXMu6aG555uu5qaCID09IG51bGwgfHwgZmVhdHVyZVZhbHVlcy7pobnnm67mpoIgPT0gdW5kZWZpbmVkID8gJycgOiBmZWF0dXJlVmFsdWVzLumhueebruamgjsKICAgICAgdGhpcy5zdGFydCA9IGZlYXR1cmVWYWx1ZXMu6LW354K5ID09IG51bGwgPyAnJyA6IGZlYXR1cmVWYWx1ZXMu6LW354K5OwogICAgICB0aGlzLmVuZCA9IGZlYXR1cmVWYWx1ZXMu57uI54K5ID09IG51bGwgPyAiIiA6IGZlYXR1cmVWYWx1ZXMu57uI54K5OwogICAgICB0aGlzLmxlbmd0aCA9IGZlYXR1cmVWYWx1ZXMu6ZW/5bqmID09IG51bGwgPyAiIiA6IGZlYXR1cmVWYWx1ZXMu6ZW/5bqmOwogICAgICB0aGlzLnp0eiA9IGZlYXR1cmVWYWx1ZXMu5oC75oqV6LWEID09IG51bGwgPyAiIiA6IGZlYXR1cmVWYWx1ZXMu5oC75oqV6LWEOwogICAgICB0aGlzLmtjc2pmZmggPSBmZWF0dXJlVmFsdWVzLuWLmOWvn18xID09IG51bGwgPyAiIiA6IGZlYXR1cmVWYWx1ZXMu5YuY5a+fXzE7CiAgICAgIHRoaXMuc3RhdHVzID0gZmVhdHVyZVZhbHVlcy7nm67liY3lt6UgPT0gbnVsbCA/ICIiIDogZmVhdHVyZVZhbHVlcy7nm67liY3lt6U7CiAgICAgIHRoaXMuYnogPSBmZWF0dXJlVmFsdWVzLuWkh+azqCA9PSBudWxsID8gIiIgOiBmZWF0dXJlVmFsdWVzLuWkh+azqDsgLy8g6I635Y+W5by55Ye65bGCRE9NCgogICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwJyk7CgogICAgICBpZiAodGhpcy5wcm9qZWN0TmFtZSA9PT0gIjAiKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5vdmVybGF5KSB7fSBlbHNlIHsKICAgICAgICAvLyDliJvlu7pPdmVybGF55by55Ye65bGC57uR5a6aRE9NCiAgICAgICAgdGhpcy5vdmVybGF5ID0gbmV3IF9PdmVybGF5LmRlZmF1bHQoewogICAgICAgICAgZWxlbWVudDogY29udGFpbmVyLAogICAgICAgICAgYXV0b1BhbjogewogICAgICAgICAgICBhbmltYXRpb246IHsKICAgICAgICAgICAgICBkdXJhdGlvbjogMjUwCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KTsgLy8g5re75Yqg5YiwbWFwCgogICAgICAgIHRoaXMubWFwRGF0YS5hZGRPdmVybGF5KHRoaXMub3ZlcmxheSk7CiAgICAgIH0gLy8g6K6+572u5by55Ye65bGC5L2N572u5Y2z5Y+v5Ye6546wCgoKICAgICAgdGhpcy5vdmVybGF5LnNldFBvc2l0aW9uKGNvb3JkaW5hdGUpOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXAnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgIH0sCiAgICAvLyDmuIXpmaTlvLnlh7rmoYYKICAgIHJlbW92ZVBvcHVwOiBmdW5jdGlvbiByZW1vdmVQb3B1cCgpIHsKICAgICAgaWYgKHRoaXMub3ZlcmxheSkgewogICAgICAgIHRoaXMub3ZlcmxheS5zZXRQb3NpdGlvbih1bmRlZmluZWQpOwogICAgICAgIHRoaXMuc2hvd0drID0gZmFsc2UsIHRoaXMuc2hvd0J6ID0gZmFsc2U7CiAgICAgICAgdGhpcy5jbGVhckhpZ2hsaWdodCgpOwogICAgICB9CiAgICB9LAogICAgLy/pmpDol4/lm77niYflvLnmoYYKICAgIHJlbW92ZUltZ1BvcHVwOiBmdW5jdGlvbiByZW1vdmVJbWdQb3B1cChpZCkgewogICAgICB2YXIgcmVzdWx0ID0gZmFsc2U7CgogICAgICBpZiAoIWlkKSB7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfQoKICAgICAgdmFyIGxheWVyQXJyYXkgPSB0aGlzLmltYWdlT3ZlckxheUFycmF5OwoKICAgICAgaWYgKGxheWVyQXJyYXkubGVuZ3RoID09IDApIHsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICB9CgogICAgICBsYXllckFycmF5LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICBpZiAoaXRlbS5pZCA9PSBpZCkgewogICAgICAgICAgaWYgKGl0ZW0udmFsdWVzXy5wb3NpdGlvbiAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpdGVtLnNldFBvc2l0aW9uKHVuZGVmaW5lZCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgICAvL+aYvuekuuWbvueJh+W8ueahhgogICAgc2hvd0ltZ1BvcHVwOiBmdW5jdGlvbiBzaG93SW1nUG9wdXAoaWQsIGNvb3JkaW5hdGUpIHsKICAgICAgaWYgKCFpZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGxheWVyQXJyYXkgPSB0aGlzLmltYWdlT3ZlckxheUFycmF5OwoKICAgICAgaWYgKGxheWVyQXJyYXkubGVuZ3RoID09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGxheWVyQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIGlmIChpdGVtLmlkID09IGlkKSB7CiAgICAgICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ltYWdlUG9wdXAnICsgaWQpOwoKICAgICAgICAgIGlmIChjb250YWluZXIpIHsKICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICBpdGVtLnNldFBvc2l0aW9uKGNvb3JkaW5hdGUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy/liKDpmaTpq5jkuq7lm77lsYIKICAgIGNsZWFySGlnaGxpZ2h0OiBmdW5jdGlvbiBjbGVhckhpZ2hsaWdodCgpIHsKICAgICAgdmFyIGFyciA9IHRoaXMubWFwRGF0YS5nZXRMYXllcnMoKS5hcnJheV87CiAgICAgIHZhciBhcnJheUxlbiA9IGFyci5sZW5ndGg7CiAgICAgIHZhciByZW1vdmUgPSAwOwoKICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBhcnJheUxlbjsgaysrKSB7CiAgICAgICAgdmFyIGl0ZW0gPSBhcnJbayAtIHJlbW92ZV07CiAgICAgICAgdmFyIGxheWVySWQgPSBpdGVtLnZhbHVlc18uaWQ7CgogICAgICAgIGlmIChsYXllcklkICE9IG51bGwgJiYgbGF5ZXJJZCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgIGlmIChsYXllcklkLmluZGV4T2YoImhpZ2hsaWdodExheWVyIikgIT0gLTEpIHsKICAgICAgICAgICAgdGhpcy5tYXBEYXRhLnJlbW92ZUxheWVyKGl0ZW0pOwogICAgICAgICAgICByZW1vdmUrKzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAvL+agueaNruWbvuWxguWQjeWtl+mrmOS6rgogICAgYWRkSGlnaExpZ2h0QnlMYXllck5hbWU6IGZ1bmN0aW9uIGFkZEhpZ2hMaWdodEJ5TGF5ZXJOYW1lKHRoaXNfLCBsYXllck5hbWUsIGZpbHRlclZhbCkgewogICAgICB2YXIgbGF5ZXJGaWxlQXJyYXkgPSB0aGlzXy5nZXRBcmVhTGluZUxheXMobGF5ZXJOYW1lLCBmaWx0ZXJWYWwpOwogICAgICB2YXIgZmVhdHVyZUFycmF5ID0gW107CgogICAgICBmb3IgKHZhciBtID0gMDsgbSA8IGxheWVyRmlsZUFycmF5Lmxlbmd0aDsgbSsrKSB7CiAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCB0aGlzXy5sYXllckFycmF5Lmxlbmd0aDsgbisrKSB7CiAgICAgICAgICBpZiAobGF5ZXJGaWxlQXJyYXlbbV0gIT0gdGhpc18ubGF5ZXJBcnJheVtuXS52YWx1ZXNfLm5hbWUgfHwgdGhpc18ubGF5ZXJBcnJheVtuXS52YWx1ZXNfLmZpbHRlclZhbCAhPSBmaWx0ZXJWYWwpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHZlY3RvcnlSZXNvdWNlID0gdGhpc18ubGF5ZXJBcnJheVtuXS5nZXRTb3VyY2UoKTsKICAgICAgICAgIGZlYXR1cmVBcnJheSA9IHZlY3RvcnlSZXNvdWNlLmZlYXR1cmVzUnRyZWVfLmdldEFsbCgpOwogICAgICAgICAgdGhpc18uYWRkSGlnaExpZ2h0U3R5bGUoZmVhdHVyZUFycmF5LCB0aGlzXywgbGF5ZXJGaWxlQXJyYXlbbV0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGFkZEhpZ2h0TGlndGhCeUxheWVyOiBmdW5jdGlvbiBhZGRIaWdodExpZ3RoQnlMYXllcihmZWF0dXJlLCBsYXllciwgdGhpc18pIHsKICAgICAgdmFyIGxheWVyTmFtZSA9IGxheWVyLnZhbHVlc18ubmFtZTsKICAgICAgdmFyIGZpbHRlclZhbCA9IGZlYXR1cmUudmFsdWVzXy5sYXllcjsKICAgICAgdmFyIGxheWVyRmlsZUFycmF5ID0gdGhpc18uZ2V0QXJlYUxpbmVMYXlzKGxheWVyTmFtZSwgZmlsdGVyVmFsKTsKICAgICAgdmFyIHF1ZXJ5UGFyYW0gPSB7fTsKICAgICAgcXVlcnlQYXJhbS5sYXllck5hbWVBcnJheSA9IGxheWVyRmlsZUFycmF5OwogICAgICBxdWVyeVBhcmFtLmZpbHRlclZhbHVlID0gZmlsdGVyVmFsOwogICAgICB0aGlzXy5jbGVhckhpZ2hsaWdodCgpOwogICAgICAoMCwgX2xlZ2VuZC5nZXRIaWdoTGlnaHRNb2RlKShxdWVyeVBhcmFtKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciByZXNwRGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgdGhpc18uY2xlYXJIaWdobGlnaHQoKTsKCiAgICAgICAgaWYgKHJlc3BEYXRhID09IG51bGwgfHwgcmVzcERhdGEgPT0gJ04nKSB7CiAgICAgICAgICB2YXIgZmVhdHVyZUFycmF5ID0gW107CiAgICAgICAgICBmZWF0dXJlQXJyYXkucHVzaChmZWF0dXJlKTsKICAgICAgICAgIHRoaXNfLmFkZEhpZ2hMaWdodFN0eWxlKGZlYXR1cmVBcnJheSwgdGhpc18sIGxheWVyTmFtZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXNfLmFkZEhpZ2hMaWdodEJ5TGF5ZXJOYW1lKHRoaXNfLCBsYXllck5hbWUsIGZpbHRlclZhbCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjcmVhdGVIaWdoTGlnaHRTdHlsZTogZnVuY3Rpb24gY3JlYXRlSGlnaExpZ2h0U3R5bGUoKSB7CiAgICAgIHZhciBoaWdoTGlnaHRTdHlsZSA9IG5ldyBfc3R5bGUuU3R5bGUoewogICAgICAgIGZpbGw6IG5ldyBfc3R5bGUuRmlsbCh7CiAgICAgICAgICBjb2xvcjogIiNmZmZmMDAiCiAgICAgICAgfSksCiAgICAgICAgc3Ryb2tlOiBuZXcgX3N0eWxlLlN0cm9rZSh7CiAgICAgICAgICBjb2xvcjogIiNmZmZmMDAiLAogICAgICAgICAgd2lkdGg6IDMuNQogICAgICAgIH0pCiAgICAgIH0pOwogICAgICByZXR1cm4gaGlnaExpZ2h0U3R5bGU7CiAgICB9LAogICAgYWRkSGlnaExpZ2h0U3R5bGU6IGZ1bmN0aW9uIGFkZEhpZ2hMaWdodFN0eWxlKGZlYXR1cmVPYmosIHRoaXNPYmosIGxheWVyTmFtZSkgewogICAgICBpZiAoIWZlYXR1cmVPYmopIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXNPYmouaGlnaExpZ2h0TGF5ZXIgPSBuZXcgX1ZlY3RvcjIuZGVmYXVsdCh7CiAgICAgICAgekluZGV4OiA5OTk5OTk5OTk5OTk5LAogICAgICAgIG5hbWU6IGxheWVyTmFtZSwKICAgICAgICBzb3VyY2U6IG5ldyBfVmVjdG9yLmRlZmF1bHQoewogICAgICAgICAgZmVhdHVyZXM6IGZlYXR1cmVPYmoKICAgICAgICB9KSwKICAgICAgICBzdHlsZTogZnVuY3Rpb24gc3R5bGUoZmVhdHVyZSwgc29sdXRpb24pIHsKICAgICAgICAgIHJldHVybiB0aGlzT2JqLmNyZWF0ZUhpZ2hMaWdodFN0eWxlKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpc09iai5oaWdoTGlnaHRMYXllci5zZXQoImlkIiwgImhpZ2hsaWdodExheWVyIiArIE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIDEwMDApKTsKICAgICAgdGhpcy5tYXBEYXRhLmFkZExheWVyKHRoaXNPYmouaGlnaExpZ2h0TGF5ZXIpOwogICAgfSwKICAgIGNoYW5nZU1hcDogZnVuY3Rpb24gY2hhbmdlTWFwKG51bSkgewogICAgICB0aGlzLmFjdGl2ZUJ0biA9IG51bTsKCiAgICAgIGlmICh0aGlzLmFjdGl2ZUJ0biA9PSAxKSB7CiAgICAgICAgZ2FvZGVNYXBMYXllci5zZXRWaXNpYmxlKGZhbHNlKTsKICAgICAgICB3eE1hcExheWVyLnNldFZpc2libGUodHJ1ZSk7IC8v5L+u5pS55paH5a2X5qCH5rOo5qC35byPCgogICAgICAgIHRoaXMuY2hhbmdlVGV4dFN0eWxlKHRoaXMuYWN0aXZlQnRuKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmFjdGl2ZUJ0biA9PSAyKSB7CiAgICAgICAgZ2FvZGVNYXBMYXllci5zZXRWaXNpYmxlKHRydWUpOwogICAgICAgIHd4TWFwTGF5ZXIuc2V0VmlzaWJsZShmYWxzZSk7CiAgICAgICAgdGhpcy5jaGFuZ2VUZXh0U3R5bGUodGhpcy5hY3RpdmVCdG4pOwogICAgICB9IGVsc2UgaWYgKHRoaXMuYWN0aXZlQnRuID09IDMpIHsKICAgICAgICBnYW9kZU1hcExheWVyLnNldFZpc2libGUoZmFsc2UpOwogICAgICAgIHd4TWFwTGF5ZXIuc2V0VmlzaWJsZShmYWxzZSk7CiAgICAgICAgdGhpcy5jaGFuZ2VUZXh0U3R5bGUodGhpcy5hY3RpdmVCdG4pOwogICAgICB9CiAgICB9LAogICAgY3JlYXRlUG9pbnRTdHlsZUJ5Q29sb3I6IGZ1bmN0aW9uIGNyZWF0ZVBvaW50U3R5bGVCeUNvbG9yKGZlYXR1cmUsIGNvbG9yKSB7CiAgICAgIHZhciBzdHlsZXMgPSBbXTsKICAgICAgdmFyIHN0eWxlID0gbmV3IF9TdHlsZS5kZWZhdWx0KHsKICAgICAgICAvLyAvL+Wbvuagh+agt+W8jwogICAgICAgIC8vIGltYWdlOiBuZXcgT2xTdHlsZUljb24oewogICAgICAgIC8vICAgYW5jaG9yOiBbMTAsIDE4XSwKICAgICAgICAvLyAgIHNjYWxlOiAxLAogICAgICAgIC8vICAgYW5jaG9yT3JpZ2luOiAndG9wLXJpZ2h0JywKICAgICAgICAvLyAgIGFuY2hvclhVbml0czogJ3BpeGVscycsCiAgICAgICAgLy8gICBhbmNob3JZVW5pdHM6ICdwaXhlbHMnLAogICAgICAgIC8vICAgb2Zmc2V0T3JpZ2luOiAnYm90dG9tLWxlZnQnLAogICAgICAgIC8vICAgb3BhY2l0eTogMSwKICAgICAgICAvLyAgIHNyYzogcmVxdWlyZSgnLi4vLi4vYXNzZXRzL2ltYWdlcy9tYXJrLnBuZycpLAogICAgICAgIC8vIH0pLAogICAgICAgIC8v5paH5pys5qC35byPCiAgICAgICAgdGV4dDogbmV3IF9UZXh0LmRlZmF1bHQoewogICAgICAgICAgdGV4dEFsaWduOiAnY2VudGVyJywKICAgICAgICAgIHRleHRCYXNlbGluZTogJ21pZGRsZScsCiAgICAgICAgICBmb250OiAnbm9ybWFsIDAuMTVyZW0g5b6u6L2v6ZuF6buRJywKICAgICAgICAgIHRleHQ6IGZlYXR1cmUudmFsdWVzXy5uYW1lLAogICAgICAgICAgb2Zmc2V0WTogLTI1LAogICAgICAgICAgZmlsbDogbmV3IF9zdHlsZS5GaWxsKHsKICAgICAgICAgICAgY29sb3I6IGNvbG9yCiAgICAgICAgICB9KSwKICAgICAgICAgIHJvdGF0aW9uOiBmZWF0dXJlLnZhbHVlc18uZm9udF9hbmdsZSAqIE1hdGguUEkgLyAxODAsCiAgICAgICAgICBwYWRkaW5nOiBbMiwgNSwgMiwgNV0KICAgICAgICB9KSwKICAgICAgICAvLyDorr7nva7lsYLnuqcKICAgICAgICB6SW5kZXg6IDE5OTk5OTk5OTkKICAgICAgfSk7CiAgICAgIHN0eWxlcy5wdXNoKHN0eWxlKTsKICAgICAgcmV0dXJuIHN0eWxlczsKICAgIH0sCiAgICBjaGFuZ2VUZXh0U3R5bGU6IGZ1bmN0aW9uIGNoYW5nZVRleHRTdHlsZShjaGVja1ZhbCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHZhciB0ZXh0TGF5ZXIgPSB0aGlzLnRleHRNYXJrTGF5ZXJObUFycmF5OwogICAgICB0aGlzLmxheWVyQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHZhciBsYXllck5hbWUgPSBpdGVtLnZhbHVlc18ubmFtZTsKCiAgICAgICAgaWYgKHRleHRMYXllci5pbmRleE9mKGxheWVyTmFtZSkgIT0gLTEpIHsKICAgICAgICAgIHZhciB2ZWN0b3J5UmVzb3VjZSA9IGl0ZW0uZ2V0U291cmNlKCk7CiAgICAgICAgICB2YXIgZmVhdHVyZUFycmF5ID0gdmVjdG9yeVJlc291Y2UuZmVhdHVyZXNSdHJlZV8uZ2V0QWxsKCk7CgogICAgICAgICAgZm9yICh2YXIgbSA9IDA7IG0gPCBmZWF0dXJlQXJyYXkubGVuZ3RoOyBtKyspIHsKICAgICAgICAgICAgdmFyIGZvbnRjb2xvciA9IGZlYXR1cmVBcnJheVttXS52YWx1ZXNfLmZvbnRfY29sb3I7CiAgICAgICAgICAgIHZhciBjaGFuZ2VDb2xvciA9IHZvaWQgMDsKCiAgICAgICAgICAgIGlmIChjaGVja1ZhbCA9PSAxKSB7CiAgICAgICAgICAgICAgY2hhbmdlQ29sb3IgPSAnI2ZmZmYwMCc7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY2hhbmdlQ29sb3IgPSAnIzAwMDAwMCc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZlYXR1cmVBcnJheVttXS5zZXRTdHlsZShfdGhpczguY3JlYXRlUG9pbnRTdHlsZUJ5Q29sb3IoZmVhdHVyZUFycmF5W21dLCBjaGFuZ2VDb2xvcikpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy/ljavmmJ/lnLDlm77liIfmjaIKICAgIHN3aXRjaENoYW5nZTogZnVuY3Rpb24gc3dpdGNoQ2hhbmdlKCkgewogICAgICB2YXIgbGF5ZXJUeXBlU2VsZWN0ID0gdGhpcy52YWx1ZTE7CgogICAgICBpZiAobGF5ZXJUeXBlU2VsZWN0KSB7CiAgICAgICAgZ2FvZGVNYXBMYXllci5zZXRWaXNpYmxlKGZhbHNlKTsKICAgICAgICB3eE1hcExheWVyLnNldFZpc2libGUodHJ1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZ2FvZGVNYXBMYXllci5zZXRWaXNpYmxlKHRydWUpOwogICAgICAgIHd4TWFwTGF5ZXIuc2V0VmlzaWJsZShmYWxzZSk7CiAgICAgIH0KICAgIH0sCiAgICAvL+WIm+W7uuWbvueJh+W8ueahhgogICAgY3JlYXRlSW1hZ2VPdmVyTGF5ZXI6IGZ1bmN0aW9uIGNyZWF0ZUltYWdlT3ZlckxheWVyKGZlYXR1cmUsIGV2dCwgbGF5ZXIpIHsKICAgICAgdmFyIGlkID0gZmVhdHVyZS52YWx1ZXNfLm5hbWU7CiAgICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW1hZ2VQb3B1cCIgKyBpZCk7CiAgICAgIGNvbnNvbGUubG9nKCLlvLnnqpflrrnlmajkuLrnqboiKTsKCiAgICAgIGlmIChjb250YWluZXIgPT0gbnVsbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1hZ2VDb250ZW50JyArIGlkKTsKICAgICAgdmFyIGltYWdlRmlsZU5hbWUgPSBmZWF0dXJlLnZhbHVlc18ubmFtZSArICIucG5nIjsKCiAgICAgIHZhciBzcmMgPSByZXF1aXJlKCJAL2Fzc2V0cy9pbWFnZXMvIiArIGltYWdlRmlsZU5hbWUpOwoKICAgICAgdmFyIHpvb20gPSB0aGlzLm1hcERhdGEuZ2V0VmlldygpLmdldFpvb20oKTsKICAgICAgdmFyIHdpZHRoID0gKHpvb20gLSB0aGlzLm1hcmtNaW5ab29tKSAqIDI1MCArIDEwMDsKICAgICAgdmFyIGhlaWdodCA9IHdpZHRoICogMC41NTgyOwogICAgICBjb250ZW50LnN0eWxlLndpZHRoID0gd2lkdGg7CiAgICAgIGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0OwogICAgICBjb250ZW50LmlubmVySFRNTCA9ICI8aW1nIHNyYyA9ICIgKyBzcmMgKyAiIHN0eWxlID0gJ3dpZHRoOjEwMCUiICsgIjtoZWlnaHQ6MTAwJSIgKyAiJy8+IjsKICAgICAgdmFyIG92ZXJsYXlUZW1wID0gbnVsbDsKICAgICAgdGhpcy5pbWFnZU92ZXJMYXlBcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0uaWQgPT0gaWQpIHsKICAgICAgICAgIG92ZXJsYXlUZW1wID0gaXRlbTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgaWYgKG92ZXJsYXlUZW1wID09IG51bGwpIHsKICAgICAgICBvdmVybGF5VGVtcCA9IG5ldyBfT3ZlcmxheS5kZWZhdWx0KHsKICAgICAgICAgIGVsZW1lbnQ6IGNvbnRhaW5lciwKICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgIHN0b3BFdmVudDogdHJ1ZSwKICAgICAgICAgIGluc2VydEZpcnN0OiBmYWxzZQogICAgICAgIH0pOwogICAgICAgIHRoaXMuaW1hZ2VPdmVyTGF5QXJyYXkucHVzaChvdmVybGF5VGVtcCk7CiAgICAgIH0KCiAgICAgIHRoaXMubWFwRGF0YS5hZGRPdmVybGF5KG92ZXJsYXlUZW1wKTsKICAgICAgb3ZlcmxheVRlbXAuc2V0UG9zaXRpb24oZXZ0LmNvb3JkaW5hdGUpOwogICAgICBjb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICB9LAogICAgLy/orr7nva7moIforrDlm77niYfmoLflvI8KICAgIGNyZWF0ZUltYWdlTWFya1N0eWxlOiBmdW5jdGlvbiBjcmVhdGVJbWFnZU1hcmtTdHlsZShmZWF0dXJlLCB2ZWN0b3JMYXllclRtcCkgewogICAgICB2YXIgdGhpc18gPSB0aGlzOwogICAgICB2ZWN0b3JMYXllclRtcC52YWx1ZXNfLnpJbmRleCA9IDk5OTk5OTk5OTk5OTk5OwogICAgICB2YXIgem9vbSA9IHRoaXMubWFwRGF0YS5nZXRWaWV3KCkuZ2V0Wm9vbSgpOwogICAgICB2YXIgc2NhbGVDaGFuZ2UgPSAoem9vbSAtIHRoaXMubWFya01pblpvb20pICogMC4yICsgMC41OyAvL+iuvue9ruWPr+aLluWKqAoKICAgICAgdmFyIHRyYW5zbGF0ZSA9IG5ldyBfaW50ZXJhY3Rpb24uVHJhbnNsYXRlKHsKICAgICAgICBoaXRUb2xlcmFuY2U6IDIwLAogICAgICAgIGxheWVyczogW3ZlY3RvckxheWVyVG1wXQogICAgICB9KTsgLy/lm77niYfmoIfms6jmi5bliqjvvIzlm77niYflvLnnqpflhbPpl60KCiAgICAgIHRyYW5zbGF0ZS5vbigndHJhbnNsYXRpbmcnLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciByZXN1bHQgPSB0aGlzXy5yZW1vdmVJbWdQb3B1cChmZWF0dXJlLnZhbHVlc18ubmFtZSk7CiAgICAgICAgdHJhbnNsYXRlLnZhbHVlc18ub3BlblN0YXR1cyA9IHJlc3VsdDsKICAgICAgfSk7CiAgICAgIHRyYW5zbGF0ZS5vbihbJ3RyYW5zbGF0ZWVuZCddLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciBvcGVuU3RhdHVzID0gdHJhbnNsYXRlLnZhbHVlc18ub3BlblN0YXR1czsKICAgICAgICBjb25zb2xlLmxvZygn5ouW5Yqo57uT5p2fJyArIG9wZW5TdGF0dXMpOwoKICAgICAgICBpZiAob3BlblN0YXR1cykgewogICAgICAgICAgdmFyIGNvb3JkaW5hdGUgPSBlLmNvb3JkaW5hdGU7CiAgICAgICAgICB0aGlzXy5zaG93SW1nUG9wdXAoZmVhdHVyZS52YWx1ZXNfLm5hbWUsIGNvb3JkaW5hdGUpOwogICAgICAgIH0gLy/ph43nva7nirbmgIEKCgogICAgICAgIHRyYW5zbGF0ZS52YWx1ZXNfLm9wZW5TdGF0dXMgPSBudWxsOwogICAgICB9KTsKICAgICAgdGhpcy5tYXBEYXRhLmFkZEludGVyYWN0aW9uKHRyYW5zbGF0ZSk7CiAgICAgIHJldHVybiBuZXcgX1N0eWxlLmRlZmF1bHQoewogICAgICAgIC8v5Zu+5qCH5qC35byPCiAgICAgICAgaW1hZ2U6IG5ldyBfSWNvbi5kZWZhdWx0KHsKICAgICAgICAgIGFuY2hvcjogWzEwLCAxOF0sCiAgICAgICAgICBzY2FsZTogc2NhbGVDaGFuZ2UsCiAgICAgICAgICBhbmNob3JPcmlnaW46ICd0b3AtcmlnaHQnLAogICAgICAgICAgYW5jaG9yWFVuaXRzOiAncGl4ZWxzJywKICAgICAgICAgIGFuY2hvcllVbml0czogJ3BpeGVscycsCiAgICAgICAgICBvZmZzZXRPcmlnaW46ICdib3R0b20tbGVmdCcsCiAgICAgICAgICBvcGFjaXR5OiAxLAogICAgICAgICAgc3JjOiBmZWF0dXJlLnZhbHVlc18uc3JjCiAgICAgICAgfSkKICAgICAgfSk7CiAgICB9LAogICAgLy8g6byg5qCH54K55Ye75Zyw5Zu+5LqL5Lu2CiAgICBtYXBDbGljazogZnVuY3Rpb24gbWFwQ2xpY2soZXZ0KSB7CiAgICAgIHZhciBwaXhlbCA9IHRoaXMubWFwRGF0YS5nZXRFdmVudFBpeGVsKGV2dC5vcmlnaW5hbEV2ZW50KTsKICAgICAgdmFyIGZlYXR1cmVJbmZvID0ge307CiAgICAgIHRoaXMubWFwRGF0YS5mb3JFYWNoRmVhdHVyZUF0UGl4ZWwocGl4ZWwsIGZ1bmN0aW9uIChmZWF0dXJlLCBsYXllcikgewogICAgICAgIGZlYXR1cmVJbmZvLmZlYXR1cmUgPSBmZWF0dXJlOwogICAgICAgIGZlYXR1cmVJbmZvLmxheWVyID0gbGF5ZXI7CiAgICAgICAgcmV0dXJuIGZlYXR1cmVJbmZvOwogICAgICB9KTsKICAgICAgdmFyIGZlYXR1cmUgPSBmZWF0dXJlSW5mby5mZWF0dXJlOwogICAgICB2YXIgbGF5ZXIgPSBmZWF0dXJlSW5mby5sYXllcjsKCiAgICAgIGlmIChmZWF0dXJlSW5mby5mZWF0dXJlKSB7CiAgICAgICAgLy/mjZXmjYnliLDopoHntKDlkI7vvIzlvLnmoYYKICAgICAgICB2YXIgY29vcmRpbmF0ZSA9IGV2dC5jb29yZGluYXRlOwogICAgICAgIHRoaXMuYWRkUG9wdXAoY29vcmRpbmF0ZSwgZmVhdHVyZSk7CiAgICAgICAgdGhpcy5hZGRIaWdodExpZ3RoQnlMYXllcihmZWF0dXJlLCBsYXllciwgdGhpcyk7IC8v5a+55LqO5Zu+54mH5Zu+5bGC5bGV56S65Zu+54mH5by55qGGCgogICAgICAgIHRoaXMucG9wSW1hZ2UoZmVhdHVyZSwgbGF5ZXIsIGV2dCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5yZW1vdmVQb3B1cCgpOwogICAgICB9CiAgICB9LAogICAgY3JlYXRlSW1hZ2VTdHlsZTogZnVuY3Rpb24gY3JlYXRlSW1hZ2VTdHlsZShmZWF0dXJlLCBpbWFnZSkgewogICAgICB2YXIgem9vbSA9IHRoaXMubWFwRGF0YS5nZXRWaWV3KCkuZ2V0Wm9vbSgpOwogICAgICB2YXIgc2NhbGVDaGFuZ2UgPSAoem9vbSAtIHRoaXMubWFya01pblpvb20pICogMC4yICsgMC4xOwogICAgICByZXR1cm4gbmV3IF9TdHlsZS5kZWZhdWx0KHsKICAgICAgICAvL+Wbvuagh+agt+W8jwogICAgICAgIGltYWdlOiBuZXcgX0ljb24uZGVmYXVsdCh7CiAgICAgICAgICBhbmNob3I6IFsxMCwgMThdLAogICAgICAgICAgc2NhbGU6IHNjYWxlQ2hhbmdlLAogICAgICAgICAgYW5jaG9yT3JpZ2luOiAndG9wLXJpZ2h0JywKICAgICAgICAgIGFuY2hvclhVbml0czogJ3BpeGVscycsCiAgICAgICAgICBhbmNob3JZVW5pdHM6ICdwaXhlbHMnLAogICAgICAgICAgb2Zmc2V0T3JpZ2luOiAnYm90dG9tLWxlZnQnLAogICAgICAgICAgb3BhY2l0eTogMSwKICAgICAgICAgIHNyYzogaW1hZ2UKICAgICAgICB9KQogICAgICB9KTsKICAgIH0sCiAgICBwb3BJbWFnZTogZnVuY3Rpb24gcG9wSW1hZ2UoZmVhdHVyZSwgbGF5ZXIsIGV2dCkgewogICAgICBpZiAoIWZlYXR1cmUudmFsdWVzXy5maWxlX3R5cGUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChmZWF0dXJlLnZhbHVlc18uZmlsZV90eXBlICE9ICdpbWFnZScpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuY3JlYXRlSW1hZ2VPdmVyTGF5ZXIoZmVhdHVyZSwgZXZ0LCBsYXllcik7CiAgICB9LAogICAgbWFwTW92ZWVuZDogZnVuY3Rpb24gbWFwTW92ZWVuZCgpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICB2YXIgem9vbSA9IHRoaXMubWFwRGF0YS5nZXRWaWV3KCkuZ2V0Wm9vbSgpOwoKICAgICAgaWYgKHpvb20gPiB0aGlzLm1hcmtNaW5ab29tKSB7CiAgICAgICAgLy/mmL7npLrmloflrZfmoIfms6gKICAgICAgICB0aGlzLmxheWVyQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgaWYgKGl0ZW0udmFsdWVzXy5tb3ZlZUhpZGUgfHwgaXRlbS52YWx1ZXNfLmluaXRIaWRlKSB7CiAgICAgICAgICAgIGl0ZW0uc2V0VmlzaWJsZSh0cnVlKTsKICAgICAgICAgICAgaXRlbS5zZXQoJ21vdmVlSGlkZScsIGZhbHNlKTsKICAgICAgICAgICAgaXRlbS5zZXQoJ2luaXRIaWRlJywgZmFsc2UpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKHpvb20gPD0gdGhpcy5tYXJrTWluWm9vbSkgewogICAgICAgIHRoaXMubWFya0ZsYWcgPSBmYWxzZTsgLy/pmpDol4/lm77niYflvLnmoYYKCiAgICAgICAgdGhpcy5pbWFnZU92ZXJMYXlBcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ltYWdlUG9wdXAnICsgaXRlbS5pZCk7CgogICAgICAgICAgaWYgKGNvbnRhaW5lciAhPSBudWxsKSB7CiAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgfQogICAgICAgIH0pOyAvL+makOiXj+aWh+Wtl+agh+azqAoKICAgICAgICB0aGlzLmxheWVyQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgaWYgKF90aGlzOS50ZXh0TWFya0xheWVyTm1BcnJheS5pbmRleE9mKGl0ZW0udmFsdWVzXy5uYW1lKSAhPSAtMSkgewogICAgICAgICAgICBpZiAoaXRlbS52YWx1ZXNfLnZpc2libGUpIHsKICAgICAgICAgICAgICAvL+e8qeaUvumakOiXj+agh+ivhgogICAgICAgICAgICAgIGl0ZW0uc2V0KCdtb3ZlZUhpZGUnLCB0cnVlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaXRlbS5zZXRWaXNpYmxlKGZhbHNlKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSAvL+agueaNrue8qeaUvuS6i+S7tuiwg+aVtOW8ueahhuWkp+WwjwoKCiAgICAgIHRoaXMuaW1hZ2VPdmVyTGF5QXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1hZ2VQb3B1cCcgKyBpdGVtLmlkKTsKCiAgICAgICAgaWYgKGNvbnRhaW5lciAhPSBudWxsKSB7CiAgICAgICAgICB2YXIgd2lkdGggPSAoem9vbSAtIF90aGlzOS5tYXJrTWluWm9vbSkgKiAyNTAgKyAxMDA7CiAgICAgICAgICBjb250YWluZXIuc3R5bGUud2lkdGggPSB3aWR0aCArICJweCI7CiAgICAgICAgICBjb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gd2lkdGggKiAwLjU1ODIgKyAicHgiOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZG93bjogZnVuY3Rpb24gZG93bihlLCBpKSB7CiAgICAgIHZhciBfdGhpczEwID0gdGhpczsKCiAgICAgIHZhciBkcmFnT2JqID0gZS5jdXJyZW50VGFyZ2V0OwogICAgICB0aGlzLmlzTW91c2VEb3duID0gdHJ1ZTsKICAgICAgdGhpc1snY3VycmVudFgnICsgaV0gPSBlLmNsaWVudFg7CiAgICAgIHRoaXNbJ2N1cnJlbnRZJyArIGldID0gZS5jbGllbnRZOwogICAgICB0aGlzWydvYmpYJyArIGldID0gZHJhZ09iai5vZmZzZXRMZWZ0OwogICAgICB0aGlzWydvYmpZJyArIGldID0gZHJhZ09iai5vZmZzZXRUb3A7CgogICAgICBkb2N1bWVudC5vbm1vdXNldXAgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzMTAuaXNNb3VzZURvd24gPSBmYWxzZTsgLy/pvKDmoIfmiqzotbfml7blgJnkuI3opoHlnKjot5/pmo/pvKDmoIfnp7vliqgKCiAgICAgICAgaWYgKCFfdGhpczEwLmlzTW91c2VEb3duKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBfdGhpczEwLmlzTW91c2VEb3duID0gZmFsc2U7IC8v6byg5qCH5oqs6LW35pe25YCZ5LiN6KaB5Zyo6Lef6ZqP6byg5qCH56e75YqoCgogICAgICAgIGRyYWdPYmouc3R5bGUuekluZGV4ID0gMTsKICAgICAgfTsKCiAgICAgIGRvY3VtZW50Lm9ubW91c2Vtb3ZlID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBpZiAoX3RoaXMxMC5pc01vdXNlRG93biA9PSBmYWxzZSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdmFyIG1vdmVYID0gZS5jbGllbnRYIC0gX3RoaXMxMFsnY3VycmVudFgnICsgaV07CiAgICAgICAgdmFyIG1vdmVZID0gZS5jbGllbnRZIC0gX3RoaXMxMFsnY3VycmVudFknICsgaV07CiAgICAgICAgZHJhZ09iai5zdHlsZS5sZWZ0ID0gX3RoaXMxMFsnb2JqWCcgKyBpXSArIG1vdmVYICsgJ3B4JzsKICAgICAgICBkcmFnT2JqLnN0eWxlLnRvcCA9IF90aGlzMTBbJ29ialknICsgaV0gKyBtb3ZlWSArICdweCc7CiAgICAgICAgZHJhZ09iai5zdHlsZS56SW5kZXggPSA5OTk7IC8v6K6p5ouW5Yqo55qEZGl25p2D6YeN5pyA5aSnCiAgICAgIH07CiAgICB9LAogICAgc2NhbGVEb206IGZ1bmN0aW9uIHNjYWxlRG9tKGUpIHsKICAgICAgdmFyIGRpdiA9IGUuY3VycmVudFRhcmdldDsKICAgICAgdmFyIHpvb20gPSBwYXJzZUludChkaXYuc3R5bGUuem9vbSwgMTApIHx8IDEwMDsKICAgICAgem9vbSArPSBlLndoZWVsRGVsdGEgLyAxMjsKCiAgICAgIGlmICh6b29tID4gMCkgewogICAgICAgIGRpdi5zdHlsZS56b29tID0gIiIuY29uY2F0KHpvb20sICIlIik7CiAgICAgIH0KICAgIH0KICB9Cn07CmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAwJA;;AAEA;;AAEA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA;AACA,0D,CACA;;AACAA;;AACA,qC,CAEA;;AACA;EACAC,uEADA;EAEAC,UAFA;EAGAC,WAHA;EAIAC,UAJA,CAIA;;AAJA,G,CAQA;;AACA;EACAC;IACAC,SADA;IAEAC;EAFA;AADA,G,CAOA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;EACAF;IACAE;EADA;AADA;eAQA;EACAC,eADA;EAEAC,wBAFA;EAGAC,IAHA,kBAGA;IACA;MACAC,OADA;MAEAC,cAFA;MAGAC,UAHA;MAIAC;QACAC,aADA;QAEAC;MAFA,CAJA;MAQA;MACAC,cATA;MAUA;MACAC,aAXA;MAYA;MACAC,qBAbA;MAcA;MACAC,oBAfA;MAgBA;MACAC,kBAjBA;MAkBAC,kBAlBA;MAmBAC;QACAC,oBADA;QAEAC;MAFA,CAnBA;MAwBAC,iBAxBA;MAyBAC,qBAzBA;MA0BAC,wBA1BA;MA4BAC,iBA5BA;MA6BAC,eA7BA;MA8BAC,mBA9BA;MA+BAC,aA/BA;MAgCAC,aAhCA;MAiCAC,eAjCA;MAkCAC,SAlCA;MAmCAC,OAnCA;MAoCAC,eApCA;MAqCAC,UArCA;MAsCAC,OAtCA;MAuCAC,UAvCA;MAwCAC,MAxCA;MAyCAC,WAzCA;MA0CAC,iBA1CA;MA0CA;MACAC,YA3CA;MA2CA;MACAC,YA5CA;MA4CA;MACAC,QA7CA;MA6CA;MACAC,QA9CA;MA8CA;MACAC;IA/CA;EAiDA,CArDA;EAsDAC,OAtDA,qBAsDA;IAGA;IACA,gDAJA,CAKA;;IACA;IACA;IACAC;EAGA,CAjEA;EAmEAC;IAEAhC;MACA;MACA,6BAFA,CAGA;;MACA;MACA;IACA;EARA,CAnEA;EAkFAiC;IAKAC,iBALA,6BAKAC,KALA,EAKA;MAAA;;MACA;QACA;UACA;QACA;;QACA;;QACA;UACA;UACA,oCAFA,CAGA;;UACAA,4BAJA,CAKA;;UACA;;UACA;YACA;;YACA;cACA;;cACA;gBACA;kBACAC;gBACA;cACA,CAJA,MAIA;gBACAA;cACA;YACA;UACA,CAnBA,CAoBA;;;UACA;UACA;QACA;MAEA,CA9BA;IA+BA,CArCA;IAyCA;IACAC,iBA1CA,6BA0CAF,KA1CA,EA0CA;MAEA;MACAG;MACA,yCAJA,CAKA;;MACA;QACAC,cADA;QAEAC,oBAFA;QAGAC;MAHA,GANA,CAWA;;MACAC;MACAA,mCAbA,CAcA;;MACAP;IACA,CA1DA;IA4DAQ,kBA5DA,8BA4DAC,IA5DA,EA4DAC,GA5DA,EA4DAC,CA5DA,EA4DAC,YA5DA,EA4DA;MAAA;;MACA;;MACA;QACA;;QACA;UACA;QACA;;QAEA;;QACA;UACA;YACAC;YACA;UACA;QACA;;QAEA;UACAH;QACA,CAFA,MAEA;UACAA;UACAI;UACAA;UACAA;UACAA;QACA;MACA,CAzBA,CA2BA;;;MACA;QACA;MACA,CAFA;;MAIA;QACA;UACAH;QACA;;QACA;UACAD;QACA;;QACA;UACAD;YACA;UACA,CAFA;QAGA;MACA;IACA,CAzGA;IA2GA;IACAM,kBA5GA,8BA4GAN,IA5GA,EA4GAO,IA5GA,EA4GA;MAAA;;MACA;QACAA;QACAA;MACA,CAJA,CAKA;;;MACA;;MACA;QACAP;UACA;QACA,CAFA;;QAGA;UACAO;QACA;MACA;IACA,CA3HA;IA6HA;IACAC,gBA9HA,4BA8HAC,QA9HA,EA8HA;MAAA;;MACA;MACAA;QACA;MACA,CAFA;MAGA;IACA,CApIA;IAwIAC,eAxIA,2BAwIAC,YAxIA,EAwIAC,KAxIA,EAwIAC,QAxIA,EAwIAtB,KAxIA,EAwIA;MACA;MACA;;MACA;QACAuB;UACAC;YAAAC;YAAAC;UAAA;QADA;MAGA,CAJA,MAIA;QACAH;UACAC;YAAAC;YAAAC;UAAA;QADA;MAGA;;MACA;QACA3E,uBADA;QAEAG,eAFA;QAGAyE,0BAHA;QAIAC;UACA;QACA;MANA;MASAC;;MACA7B;;MACAA;IAEA,CAjKA;IAqKA;IACA8B,cAtKA,0BAsKA9B,KAtKA,EAsKA+B,SAtKA,EAsKAT,QAtKA,EAsKA;MACA;MACA;;MACA;QACA;MACA;;MACA,kJACA,oEADA,GACAU,6BADA,GACA,GADA,GACAA,yCADA;MAEA;QACAD,oBADA;QAEAJ;MAFA;MAIAE;;MACAI;QAAAC;MAAA;QACA;;QACA;UAEAlC;QACA;MACA,CANA;IAQA,CA3LA;IA6LA;IACAmC,eA9LA,2BA8LAJ,SA9LA,EA8LAJ,SA9LA,EA8LA;MACA;MACA;;MACA;QACA;UACA;YACAS;UACA;;UACA;YACAC;YACA;UACA;QACA;MACA;;MACA;QACA;MACA,CAFA,MAEA;QACAD;QACAA;QACA;MACA;IACA,CAnNA;IAsNAE,iBAtNA,6BAsNA1B,YAtNA,EAsNA;MACA;;MACA;;MACA;QACA;QACA;QACA;;QACA;UACA;QACA;;QACA;UACA;UACA;;UACA;YACA;UACA;;UACA;YACA;YACA;;YACA;cACA;YACA;UACA,CANA,CAMA;YACAiB;UACA;QACA;MACA,CA1BA,CA2BA;;IACA,CAlPA;IAsPAU,WAtPA,uBAsPA3B,YAtPA,EAsPA;MAAA;;MACA;QACA;MACA;;MACA;MACA;QACA;MACA,CAFA;MAIA4B;QAAA;MAAA;MAEA;IACA,CAlQA;IAqQAC,gBArQA,4BAqQAC,OArQA,EAqQAjC,IArQA,EAqQA;MACA;QACA;MACA;;MACA;MAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACAkC;UACAC,mBADA;UAEAC,sBAFA;UAGAC,2BAHA;UAIAH,0BAJA;UAKAI,YALA;UAMAC;YACAC;UADA,EANA;UASAC,oDATA;UAUAC;QAVA,EAbA;QAyBA;QACAnG;MA1BA;MA4BAoG;MACA;IACA,CAzSA;IA4SA;IACAC,cA7SA,0BA6SAX,OA7SA,EA6SAjC,IA7SA,EA6SA6C,cA7SA,EA6SA;MACA;;MACA;QACA;UACA;UACAZ;;UACA;YACAb;YACA;UACA;;UACA;QAEA,CATA,MASA;UACA;;UACA;YACAyB;YACAA;YACA;UACA;;UACAA;UACA;QACA;MACA,CApBA,MAoBA;QACA;MACA;IACA,CAtUA;IAwUAC,eAxUA,2BAwUAb,OAxUA,EAwUAjC,IAxUA,EAwUA;MACA;MACA;MACA;MACA;MACAmB;MACAA;MACAA;MACA;IACA,CAjVA;IAsVA4B,cAtVA,0BAsVAd,OAtVA,EAsVAjC,IAtVA,EAsVA;MACA;MACA;;MACA;QACA;MACA;;MACA;MACA;MACA;MACA;MACA;MACA;MACA,+BAZA,CAaA;MACA;MACA;;MACA;;MACA;QACAgD;UACAR;QADA;MAGA,CArBA,CAsBA;MACA;MACA;MACA;MACA;;;MACA;QACA;UACAQ;YACAC;UADA;QAGA,CAJA,MAIA;UACAD;QACA;MACA;;MACA;QAEAA;MACA;;MACA;QAEAA;MACA;;MACA7B,uBA5CA,CA6CA;;MACA;QACA;UACAqB;QADA;QAGArB;MACA;;MAEAwB;MACA;IACA,CA7YA;IAiZAO,iBAjZA,6BAiZAC,KAjZA,EAiZA;MAAA;;MACA;MACA;MACA;MACA;MACAC;QACAC;MACA,CAFA,EALA,CAQA;;MACA;MACAlD;MACA;MACA,oCAZA,CAaA;;MACA;QACAmD;UACAtD,uBADA,CAEA;QACA,CAHA;QAIA;MACA,CApBA,CAqBA;;;MArBA,2BAsBAuD,CAtBA;QAuBA;UACA;QACA;;QACA;;QACA;UACAD;YACA;cACAtD;YAEA;UACA,CALA;UAMA;QACA;;QACA;UACA;UACA;;UACA;YACA;;YACA,mDACAwD,oDADA,EACA;cACAC;cACAD;cACA;YACA;UAEA,CAZA,CAcA;;;UACA;YACApC;YACAA,4CAFA,CAGA;;YACA;;YACA;cACA;YACA;;YACA;UACA;QACA;MA7DA;;MAsBA;QAAA;;QAAA,yBAYA;MA4BA,CA9DA,CAgEA;;;MACA;QACA;MACA;;MACA;;MACA;QACA;;QACA;UACA;UACA;;UACA;YACA,sEACAkC,gEADA,EACA;cACAG;;cACA;gBACAC;cACA;;cACAJ;cACA;YACA;UACA;QACA;;QACA;UACAA;QAEA;MACA,CA1FA,CA4FA;;;MACA;QACA;QACA;;QACA;UACA;YACAG;YACAH;UACA;QACA;;QACA;UACA;YACAA;UACA;QACA;MAEA,CA5GA,CAgHA;;;MACA;QACA;UACA;YACA;UACA,CAFA,MAEA,CACA;YACA;YACA;UACA;QACA;MACA,CAVA;IAcA,CAhhBA;IAohBA;IACAK,QArhBA,oBAqhBAC,UArhBA,EAqhBA3B,OArhBA,EAqhBA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA,2DAXA,CAaA;;MACA;;MACA;QACA;MACA;;MACA,mBACA,CADA,MACA;QACA;QACA;UACA4B,kBADA;UAGAC;YACAC;cACAC;YADA;UADA;QAHA,GAFA,CAYA;;QACA;MACA,CAjCA,CAkCA;;;MACA;MACA7E;IACA,CA1jBA;IA4jBA;IACA8E,WA7jBA,yBA6jBA;MACA;QACA;QACA,qBACA,mBADA;QAEA;MACA;IAEA,CArkBA;IAukBA;IACAC,cAxkBA,0BAwkBAC,EAxkBA,EAwkBA;MACA;;MACA;QACA;MACA;;MACA;;MACA;QACA;MACA;;MACAjH;QACA;UAEA;YACAkH;UACA;;UACApE;QACA;MACA,CARA;MASA;IACA,CA3lBA;IA6lBA;IACAqE,YA9lBA,wBA8lBAF,EA9lBA,EA8lBAP,UA9lBA,EA8lBA;MACA;QACA;MACA;;MACA;;MACA;QACA;MACA;;MACA1G;QACA;UACA;;UACA;YACAoH;YACAtE;UACA;QACA;MACA,CARA;IASA,CA/mBA;IAknBA;IACAuE,cAnnBA,4BAmnBA;MACA;MACA;MACA;;MACA;QACA;QACA;;QACA;UACA;YACA;YACAC;UACA;QACA;MACA;IAGA,CAnoBA;IAqoBA;IACAC,uBAtoBA,mCAsoBAC,KAtoBA,EAsoBApD,SAtoBA,EAsoBAJ,SAtoBA,EAsoBA;MACA;MACA;;MACA;QACA;UACA;YACA;UACA;;UACA;UACAyD;UACAD;QACA;MACA;IACA,CAnpBA;IAwpBAE,oBAxpBA,gCAwpBA3C,OAxpBA,EAwpBAuB,KAxpBA,EAwpBAkB,KAxpBA,EAwpBA;MACA;MACA;MACA;MACA;MACAG;MACAA;MACAH;MACA;QACA;QACAA;;QACA;UACA;UACAC;UACAD;QACA,CAJA,MAIA;UACAA;QACA;MAGA,CAZA;IAaA,CA7qBA;IA+qBAI,oBA/qBA,kCA+qBA;MACA;QACAvC;UACAC;QADA,EADA;QAIAQ;UACAR,gBADA;UAEAS;QAFA;MAJA;MASA;IACA,CA1rBA;IA6rBA8B,iBA7rBA,6BA6rBAC,UA7rBA,EA6rBAC,OA7rBA,EA6rBA3D,SA7rBA,EA6rBA;MACA;QACA;MACA;;MACA2D;QACA1I,qBADA;QAEAE,eAFA;QAGAH;UACAyE;QADA,EAHA;QAMAI;UACA;QACA;MARA;MAUA8D;MACA;IAEA,CA9sBA;IAgtBAC,SAhtBA,qBAgtBAC,GAhtBA,EAgtBA;MACA;;MACA;QACAC;QACA1F,4BAFA,CAGA;;QACA;MACA,CALA,MAKA;QACA0F;QACA1F;QACA;MACA,CAJA,MAIA;QACA0F;QACA1F;QACA;MACA;IACA,CAhuBA;IAkuBA2F,uBAluBA,mCAkuBApD,OAluBA,EAkuBAO,KAluBA,EAkuBA;MACA;MACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACAN;UACAC,mBADA;UAEAC,sBAFA;UAGAC,2BAHA;UAIAH,0BAJA;UAKAI,YALA;UAMAC;YACAC;UADA,EANA;UASAC,oDATA;UAUAC;QAVA,EAbA;QAyBA;QACAnG;MA1BA;MA4BAoG;MACA;IACA,CAlwBA;IAqwBA2C,eArwBA,2BAqwBAC,QArwBA,EAqwBA;MAAA;;MACA;MACA;QACA;;QACA;UACA;UACA;;UACA;YACA;YACA;;YACA;cACAC;YACA,CAFA,MAEA;cACAA;YACA;;YACAb;UACA;QAEA;MACA,CAjBA;IAkBA,CAzxBA;IA4xBA;IACAc,YA7xBA,0BA6xBA;MACA;;MACA;QACAL;QACA1F;MACA,CAHA,MAGA;QACA0F;QACA1F;MACA;IACA,CAtyBA;IAwyBA;IACAgG,oBAzyBA,gCAyyBAzD,OAzyBA,EAyyBA0D,GAzyBA,EAyyBAnC,KAzyBA,EAyyBA;MACA;MACA;MACApC;;MACA;QACA;MACA;;MACA;MACA;;MACA;;MACA;MACA;MACA;MACAwE;MACAA;MACAA;MACA;MACA;QACA;UACAC;QACA;MACA,CAJA;;MAKA;QACAA;UACAhC,kBADA;UAEAM,MAFA;UAGA2B,eAHA;UAIAC;QAJA;QAQA;MACA;;MACA;MACAF;MACAvB;IACA,CA70BA;IAg1BA;IACA0B,oBAj1BA,gCAi1BA/D,OAj1BA,EAi1BAY,cAj1BA,EAi1BA;MACA;MACAA;MACA;MACA,wDAJA,CAKA;;MACA;QACAoD,gBADA;QAEAtG;MAFA,GANA,CAUA;;MACAuG;QACA;QACAA;MAEA,CAJA;MAMAA;QACA;QACA9E;;QACA;UACA;UACAsD;QACA,CANA,CAOA;;;QACAwB;MACA,CATA;MAWA;MACA;QACA;QACAC;UACAC,gBADA;UAEAC,kBAFA;UAGAC,yBAHA;UAIAC,sBAJA;UAKAC,sBALA;UAMAC,2BANA;UAOAC,UAPA;UAQAC;QARA;MAFA;IAaA,CA33BA;IA83BA;IACAC,QA/3BA,oBA+3BAjB,GA/3BA,EA+3BA;MACA;MACA;MACA,0CACA;QACAkB;QACAA;QACA;MACA,CALA;MAMA;MACA;;MACA;QACA;QACA;QACA;QACA,gDAJA,CAKA;;QACA;MACA,CAPA,MAOA;QAEA;MACA;IACA,CAr5BA;IAu5BAC,gBAv5BA,4BAu5BA7E,OAv5BA,EAu5BAkE,KAv5BA,EAu5BA;MACA;MACA;MACA;QACA;QACAA;UACAC,gBADA;UAEAC,kBAFA;UAGAC,yBAHA;UAIAC,sBAJA;UAKAC,sBALA;UAMAC,2BANA;UAOAC,UAPA;UAQAC;QARA;MAFA;IAaA,CAv6BA;IA26BAI,QA36BA,oBA26BA9E,OA36BA,EA26BAuB,KA36BA,EA26BAmC,GA36BA,EA26BA;MACA;QACA;MACA;;MACA;QACA;MACA;;MAEA;IACA,CAp7BA;IAw7BAqB,UAx7BA,wBAw7BA;MAAA;;MACA;;MACA;QAEA;QACA;UACA;YACAhH;YACAA;YACAA;UACA;QACA,CANA;MAQA,CAXA,MAWA;QACA,sBADA,CAEA;;QACA;UACA;;UACA;YACAsE;UACA;QACA,CALA,EAHA,CAUA;;QACA;UACA;YACA;cACA;cACAtE;YACA;;YACAA;UACA;QACA,CARA;MAYA,CApCA,CAsCA;;;MACA;QACA;;QACA;UACA;UACAsE;UACAA;QACA;MACA,CAPA;IASA,CAx+BA;IAy+BA2C,IAz+BA,gBAy+BAC,CAz+BA,EAy+BA3D,CAz+BA,EAy+BA;MAAA;;MACA;MACA;MACA;MACA;MACA;MACA;;MACApE;QAEA,4BAFA,CAEA;;QACA;UACA;QACA;;QACA,4BANA,CAMA;;QACAgI;MACA,CARA;;MASAhI;QACA;UACA;QACA;;QACA;QACA;QACAgI;QACAA;QACAA,2BARA,CAQA;MACA,CATA;IAWA,CApgCA;IAqgCAC,QArgCA,oBAqgCAF,CArgCA,EAqgCA;MAEA;MACA;MACA7K;;MACA;QAAAgL;MAAA;IACA;EA3gCA;AAlFA,C","names":["proj4","center","minZoom","maxZoom","zoom","source","zIndex","url","name","mixins","data","ac","value1","radio2","addForm","sDeptName","sDeptId","layerArray","treeData2","defaultCheckedIds","defaultExpandIds","imgPopDivArray","markLayerArray","defaultProps","children","label","imagePopArray","imageOverLayArray","textMarkLayerNmArray","markMinZoom","markFlag","markVectorArray","showGk","showBz","projectName","start","end","projectDesc","length","ztz","status","bz","kcsjffh","isDragable","currentX","currentY","objX","objY","activeBtn","mounted","document","watch","methods","findComponentInfo","_this","expandIds","initLayerToMapWfs","wxMapLayer","layers","target","view","map","assembleLayerItems","item","arr","m","checkedArray","existItem","newItem","getCheckedIdsRecur","ids_","getTreecheckedId","treeData","initSingleLayer","featuresData","param","dataItem","vectorSourceTmp","features","featureProjection","dataProjection","filterVal","style","console","addSingleLayer","layerName","encodeURIComponent","axios","timeout","getAreaLineLays","arrays_","isEqual","addVectorLayerWfs","getLayerMap","layerMap","createPointStyle","feature","text","textAlign","textBaseline","font","offsetY","fill","color","rotation","padding","styles","initLayerStyle","vectorLayerTmp","getStyleSetting","initGraphStyle","stroke","width","handleCheckChange","data_","halfCheckNode","halfCheckIds","currentLayers","i","layer","exist","existLayer","addPopup","coordinate","element","autoPan","animation","duration","removePopup","removeImgPopup","id","result","showImgPopup","container","clearHighlight","remove","addHighLightByLayerName","this_","featureArray","addHightLigthByLayer","queryParam","createHighLightStyle","addHighLightStyle","featureObj","thisObj","changeMap","num","gaodeMapLayer","createPointStyleByColor","changeTextStyle","checkVal","changeColor","switchChange","createImageOverLayer","evt","content","overlayTemp","stopEvent","insertFirst","createImageMarkStyle","hitTolerance","translate","image","anchor","scale","anchorOrigin","anchorXUnits","anchorYUnits","offsetOrigin","opacity","src","mapClick","featureInfo","createImageStyle","popImage","mapMoveend","down","e","dragObj","scaleDom","div"],"sourceRoot":"src/views","sources":["index.vue"],"sourcesContent":["<template>\r\n  <div id=\"map\" ref=\"map\">\r\n    <!--点击查看详情弹框-->\r\n    <div id=\"popup\" class=\"ol-popup\">\r\n      <div class=\"popup-nav-title\">\r\n        <span>{{ this.projectName }}</span>\r\n        <span>{{ this.status }}</span>\r\n      </div>\r\n      <el-divider></el-divider>\r\n      <div v-show=\"this.projectDesc != ''\">\r\n        <el-row class=\"popup-item\">\r\n          <el-col :span=\"12\">\r\n            <img src=\"../assets/images/fly_pre.png\" class=\"popup-nav-icon\" />\r\n            <span>{{ this.start }}</span>\r\n            <img\r\n              src=\"../assets/images/right.png\"\r\n              style=\"width: 16px; float: right; margin-right: 0.125rem\"\r\n            />\r\n          </el-col>\r\n\r\n          <el-col :span=\"12\">\r\n            <img src=\"../assets/images/fly_nor.png\" class=\"popup-nav-icon\" />\r\n            <span>{{ this.end }}</span>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row class=\"popup-item\">\r\n          <el-col :span=\"12\">\r\n            <img src=\"../assets/images/cd.png\" class=\"popup-nav-icon\" />\r\n            <span>长度（KM）:{{ this.length }}</span>\r\n          </el-col>\r\n\r\n          <el-col :span=\"12\">\r\n            <img src=\"../assets/images/tz.png\" class=\"popup-nav-icon\" />\r\n            <span>总投资（亿元）:{{ this.ztz }}</span>\r\n          </el-col>\r\n        </el-row>\r\n        <div class=\"popup-item\">\r\n          <span>项目概况</span>\r\n          <i\r\n            class=\"el-icon-caret-right\"\r\n            v-show=\"this.projectDesc != '' && showGk === false\"\r\n            @click=\"showGk = true\"\r\n          ></i>\r\n          <i\r\n            class=\"el-icon-caret-bottom\"\r\n            @click=\"showGk = false\"\r\n            v-show=\"showGk === true\"\r\n          ></i>\r\n          <span v-show=\"this.showGk === true\">{{ this.projectDesc }}</span>\r\n        </div>\r\n        <div class=\"popup-item\">\r\n          <span>勘察设计费复核:</span>\r\n          <span>{{ this.kcsjffh }}</span>\r\n        </div>\r\n        <div class=\"popup-item\">\r\n          <span>备注</span>\r\n          <i\r\n            class=\"el-icon-caret-right\"\r\n            v-show=\"this.bz != '' && showBz === false\"\r\n            @click=\"showBz = true\"\r\n          ></i>\r\n          <i\r\n            class=\"el-icon-caret-bottom\"\r\n            @click=\"showBz = false\"\r\n            v-show=\"showBz === true\"\r\n          ></i>\r\n          <span v-show=\"this.showBz === true\">{{ this.bz }}</span>\r\n        </div>\r\n      </div>\r\n      <img src=\"../assets/images/bg_down.png\" class=\"jt-icon\" />\r\n    </div>\r\n\r\n    <!--图片弹窗-->\r\n    <div v-for=\"(item, index) in imagePopArray\" :key=\"index\">\r\n      <div\r\n        :id=\"'imagePopup' + item\"\r\n        @mousedown.prevent=\"down($event, index + 1)\"\r\n        @mousewheel.prevent=\"scaleDom($event)\"\r\n        style=\"position: relative; width: 250px; height: 250px; display: none\"\r\n      >\r\n        <i\r\n          class=\"el-icon-close ol-popup-closer\"\r\n          @click=\"removeImgPopup(item)\"\r\n        ></i>\r\n        <div :id=\"'imageContent' + item\"></div>\r\n      </div>\r\n    </div>\r\n\r\n    <!--道路选择器-->\r\n    <div id=\"pop-road-selector\" class=\"ol-layer\">\r\n      <div class=\"change-div\">\r\n        <div\r\n          class=\"switch-btn left-btn\"\r\n          @click=\"changeMap('1')\"\r\n          :class=\"{ 'btn-active': activeBtn == 1 }\"\r\n        >\r\n          卫星图\r\n        </div>\r\n        <div\r\n          class=\"switch-btn\"\r\n          @click=\"changeMap('2')\"\r\n          :class=\"{ 'btn-active': activeBtn == 2 }\"\r\n        >\r\n          电子地图\r\n        </div>\r\n        <div\r\n          class=\"switch-btn right-btn\"\r\n          @click=\"changeMap('3')\"\r\n          :class=\"{ 'btn-active': activeBtn == 3 }\"\r\n        >\r\n          隐藏底图\r\n        </div>\r\n      </div>\r\n      <div class=\"road-selector-pop\">\r\n        <el-collapse accordion class=\"nav-select\" v-model=\"ac\">\r\n          <el-collapse-item name=\"1\">\r\n            <template slot=\"title\"> 显示图层 </template>\r\n            <el-tree\r\n              class=\"tree-div\"\r\n              ref=\"tree\"\r\n              :data=\"treeData2\"\r\n              show-checkbox\r\n              node-key=\"id\"\r\n              :default-checked-keys=\"defaultCheckedIds\"\r\n              :default-expanded-keys=\"defaultExpandIds\"\r\n              :props=\"defaultProps\"\r\n              @check=\"handleCheckChange\"\r\n            >\r\n              <div class=\"custom-tree-node\" slot-scope=\"{ node, data }\">\r\n                <span>\r\n                  {{ node.label }}\r\n                </span>\r\n                <span\r\n                  v-if=\"data.fillColor != null\"\r\n                  class=\"dot\"\r\n                  :style=\"{ background: data.fillColor }\"\r\n                ></span>\r\n                <span\r\n                  v-else\r\n                  class=\"dot\"\r\n                  :style=\"{ background: data.strokeColor }\"\r\n                ></span>\r\n              </div>\r\n            </el-tree>\r\n          </el-collapse-item>\r\n        </el-collapse>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport 'ol/ol.css'\r\n\r\nimport * as olControl from 'ol/control'\r\n\r\nimport { Map, View, Feature, Collection } from \"ol\";\r\n\r\nimport { getWidth, getCenter } from 'ol/extent'\r\nimport TileLayer from 'ol/layer/Tile'\r\nimport WMTS from 'ol/source/WMTS'\r\nimport XYZ from 'ol/source/XYZ'\r\nimport WMTSTileGrid from 'ol/tilegrid/WMTS'\r\nimport Projection from 'ol/proj/Projection'\r\nimport { transform } from 'ol/proj'\r\nimport proj4 from 'proj4'\r\nimport { register } from 'ol/proj/proj4';\r\nimport VectorSource from 'ol/source/Vector'\r\nimport { TileWMS } from 'ol/source'\r\nimport VectorLayer from 'ol/layer/Vector'\r\n\r\nimport { Draw, Translate, DragPan } from 'ol/interaction'\r\nimport { Style, Circle, Stroke, Fill } from 'ol/src/style'\r\nimport WKT from 'ol/format/WKT'\r\nimport GeoJSON from 'ol/format/GeoJSON'\r\nimport Overlay from 'ol/Overlay'\r\nimport * as echarts from \"echarts\";\r\nimport axios from 'axios'\r\nimport LineString from 'ol/geom/LineString';\r\nimport MultiLineString from 'ol/geom/MultiLineString';\r\nimport MultiPolygon from 'ol/geom/MultiPolygon';\r\nimport Vue from 'vue'\r\nimport { clone } from \"@/utils/ruoyi\";\r\nimport OlGeomPoint from 'ol/geom/Point'\r\nimport OlStyleStyle from 'ol/style/Style'\r\nimport OlStyleIcon from 'ol/style/Icon'\r\nimport index from \"@/api/index\";\r\nimport Point from 'ol/geom/Point';\r\nimport Text from 'ol/style/Text'\r\nimport { findComponentInfo } from \"@/api/config/component\";\r\nimport { initTree } from \"@/api/tree/tree\";\r\nimport { getHighLightMode } from \"@/api/config/legend\";\r\n\r\nimport { getUrlKey } from '@/utils/request'\r\n\r\n\r\n\r\n\r\n//中心坐标\r\nconst centerCordinate = [656951.22379894, 3560959.26626369]\r\n//坐标定义\r\nproj4.defs(\"EPSG:4548\", \"+proj=tmerc +lat_0=0 +lon_0=117 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs\");\r\nregister(proj4);\r\n\r\n//地图初始化\r\nconst view = new View({\r\n  center: transform(centerCordinate, 'EPSG:4548', 'EPSG:3857'),\r\n  minZoom: 4,\r\n  maxZoom: 18,\r\n  zoom: 14.5 // 地图初始化的缩放级别\r\n})\r\n\r\n\r\n//高德地图图层\r\nconst gaodeMapLayer = new TileLayer({\r\n  source: new XYZ({\r\n    zIndex: 1,\r\n    url: 'http://webst0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scl=2&style=7&x={x}&y={y}&z={z}'\r\n  })\r\n});\r\n\r\n//卫星地图\r\n// const wxMapLayer = new TileLayer({\r\n//   source: new XYZ({\r\n//     crossOrigin: \"anonymous\",\r\n//     url: 'http://t0.tianditu.gov.cn/img_w/wmts?tk=129364168580e7f0e3ff5bd759d41a75&SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&FORMAT=tiles'\r\n//   })\r\n// });\r\n\r\nconst wxMapLayer = new TileLayer({\r\n  source: new XYZ({\r\n    url: 'http://webst0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=6&x={x}&y={y}&z={z}'\r\n  })\r\n});\r\n\r\n\r\n\r\nexport default {\r\n  name: \"project\",\r\n  mixins: [index],\r\n  data () {\r\n    return {\r\n      ac: '1',\r\n      value1: 'true',\r\n      radio2: [],\r\n      addForm: {\r\n        sDeptName: '',\r\n        sDeptId: ''\r\n      },\r\n      //图层对象数组\r\n      layerArray: [],\r\n      //树结构数据\r\n      treeData2: [],\r\n      //默认选中节点\r\n      defaultCheckedIds: [],\r\n      //默认扩展节点\r\n      defaultExpandIds: [],\r\n      //临时图片弹框数组\r\n      imgPopDivArray: [],\r\n      markLayerArray: [],\r\n      defaultProps: {\r\n        children: 'children',\r\n        label: 'label'\r\n      },\r\n\r\n      imagePopArray: [],\r\n      imageOverLayArray: [],\r\n      textMarkLayerNmArray: [],\r\n\r\n      markMinZoom: 14.5,\r\n      markFlag: false,\r\n      markVectorArray: [],\r\n      showGk: false,\r\n      showBz: false,\r\n      projectName: '',\r\n      start: '',\r\n      end: '',\r\n      projectDesc: '',\r\n      length: '',\r\n      ztz: '',\r\n      status: '',\r\n      bz: '',\r\n      kcsjffh: '',\r\n      isDragable: false,//是否可以拖动\r\n      currentX: '', //点击时鼠标距左边的距离\r\n      currentY: '',//点击时鼠标距顶边的距离\r\n      objX: '', //点击时元素距左边的距离\r\n      objY: '', //点击时元素距顶边的距离\r\n      activeBtn: '2'\r\n    }\r\n  },\r\n  mounted () {\r\n\r\n\r\n    //获取菜单ID\r\n    this.menuId = getUrlKey('menuId');\r\n    //根据菜单ID查询组件信息\r\n    this.findComponentInfo(this);\r\n    this.removePopup();\r\n    document.getElementById('popup').style.display = 'none';\r\n\r\n\r\n  },\r\n\r\n  watch: {\r\n\r\n    defaultCheckedIds: function () {\r\n      //初始化地图\r\n      this.initLayerToMapWfs(this);\r\n      //添加自定义图层\r\n      let checkedIds = this.getTreecheckedId(this.treeData2);\r\n      this.addVectorLayerWfs(checkedIds);\r\n    }\r\n  },\r\n\r\n\r\n\r\n\r\n\r\n  methods: {\r\n\r\n\r\n\r\n\r\n    findComponentInfo (_this) {\r\n      findComponentInfo(this.menuId, null).then(response => {\r\n        if (!response.data) {\r\n          return;\r\n        }\r\n        let legendConfigData = response.data.decLegendConfigList;\r\n        if (legendConfigData && legendConfigData.length > 0) {\r\n          //设置树节点数据\r\n          let treeData_ = legendConfigData[0];\r\n          //隐藏设置的节点\r\n          _this.treeData2 = treeData_;\r\n          //设置顶级菜单选中\r\n          let expandIds = [];\r\n          for (let k = 0; k < treeData_.length; k++) {\r\n            let item = treeData_[k];\r\n            if (item.parentId == null) {\r\n              let children_ = item.children;\r\n              if (children_ != null && children_.length != 0) {\r\n                for (let j = 0; j < children_.length; j++) {\r\n                  expandIds.push(children_[j].id);\r\n                }\r\n              } else {\r\n                expandIds.push(item.id);\r\n              }\r\n            }\r\n          }\r\n          //默认展展开二级菜单\r\n          this.defaultExpandIds = expandIds;\r\n          this.defaultCheckedIds = _this.getTreecheckedId(treeData_);\r\n        }\r\n\r\n      });\r\n    },\r\n\r\n\r\n\r\n    // 初始化地图\r\n    initLayerToMapWfs (_this) {\r\n\r\n      const mapContainer = _this.$refs.map\r\n      wxMapLayer.setVisible(false)\r\n      let layers = [gaodeMapLayer, wxMapLayer];\r\n      //将图层加入Map\r\n      const map = new Map({\r\n        layers: layers,\r\n        target: mapContainer,\r\n        view: view\r\n      });\r\n      // 添加鼠标点击事件\r\n      map.on('click', _this.mapClick);\r\n      map.on('moveend', this.mapMoveend);\r\n      // 保存地图\r\n      _this.mapData = map\r\n    },\r\n\r\n    assembleLayerItems (item, arr, m, checkedArray) {\r\n      var newItem = null;\r\n      if (item.layerName != null) {\r\n        var needAdd = item.filterValue || (item.children != null && item.children != undefined);\r\n        if (!needAdd) {\r\n          return;\r\n        }\r\n\r\n        let existItem;\r\n        for (let j = 0; j < m.length; j++) {\r\n          if (m[j].layerName == item.layerName) {\r\n            existItem = m[j];\r\n            break;\r\n          }\r\n        }\r\n\r\n        if (existItem != null) {\r\n          arr = existItem.treeDataItem;\r\n        } else {\r\n          arr = [];\r\n          newItem = {};\r\n          newItem.treeDataItem = arr;\r\n          newItem.layerName = item.layerName;\r\n          newItem.filterKey = item.filterKey;\r\n        }\r\n      }\r\n\r\n      //选中状态\r\n      var idIndex = checkedArray.findIndex(item2 => {\r\n        return item2 == item.id;\r\n      });\r\n\r\n      if (idIndex != -1) {\r\n        if (newItem != null) {\r\n          m.push(newItem);\r\n        }\r\n        if (item.filterValue != null) {\r\n          arr.push(item);\r\n        }\r\n        if (item.children != null && item.children != undefined) {\r\n          item.children.forEach(i => {\r\n            this.assembleLayerItems(i, arr, m, checkedArray);\r\n          })\r\n        }\r\n      }\r\n    },\r\n\r\n    //递归获节点信息\r\n    getCheckedIdsRecur (item, ids_) {\r\n      if (item.id && item.checkStatus == 'Y') {\r\n        ids_ = (ids_ == null ? [] : ids_);\r\n        ids_.push(item.id);\r\n      }\r\n      //如果子节点选中，需要将父节半选中状态节点加入\r\n      let currentLen = ids_.length;\r\n      if (item.children != null) {\r\n        item.children.forEach(item => {\r\n          this.getCheckedIdsRecur(item, ids_)\r\n        })\r\n        if (currentLen < ids_.length && ids_.indexOf(item.id) == -1) {\r\n          ids_.push(item.id);\r\n        }\r\n      }\r\n    },\r\n\r\n    //获取树所有的节点信息\r\n    getTreecheckedId (treeData) {\r\n      let ids = [];\r\n      treeData.forEach(item => {\r\n        this.getCheckedIdsRecur(item, ids);\r\n      })\r\n      return ids;\r\n    },\r\n\r\n\r\n\r\n    initSingleLayer (featuresData, param, dataItem, _this) {\r\n      let layerName = param.layerName;\r\n      let vectorSourceTmp;\r\n      if (layerName == 'Test:xzxw' || layerName == 'Test:jqxw' || layerName == 'Test:yqxw') {\r\n        vectorSourceTmp = new VectorSource({\r\n          features: (new GeoJSON({ featureProjection: 'EPSG:3857', dataProjection: 'EPSG:4326' })).readFeatures(featuresData)\r\n        });\r\n      } else {\r\n        vectorSourceTmp = new VectorSource({\r\n          features: (new GeoJSON({ featureProjection: 'EPSG:3857', dataProjection: 'EPSG:4548' })).readFeatures(featuresData)\r\n        });\r\n      }\r\n      let vectorLayerTmp = new VectorLayer({\r\n        source: vectorSourceTmp,\r\n        name: layerName,\r\n        filterVal: param.filterVal,\r\n        style: (feature, solution) => {\r\n          return _this.initLayerStyle(feature, dataItem, vectorLayerTmp);\r\n        }\r\n      })\r\n\r\n      console.log(param.layerName + \":\" + param.filterVal);\r\n      _this.mapData.addLayer(vectorLayerTmp);\r\n      _this.layerArray.push(vectorLayerTmp);\r\n\r\n    },\r\n\r\n\r\n\r\n    //添加单个图层信息\r\n    addSingleLayer (_this, layerName, dataItem) {\r\n      let filterKey = dataItem.filterKey;\r\n      let filterVal = dataItem.filterValue;\r\n      if (!layerName || !filterVal) {\r\n        return;\r\n      }\r\n      var url = process.env.VUE_APP_GIS_BASE_URL + '/Test/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=' + encodeURIComponent(layerName)\r\n        + '&maxFeatures=500000000&outputFormat=application%2Fjson&cql_filter=' + encodeURIComponent(filterKey) + '=' + encodeURIComponent(\"'\" + filterVal + \"'\");\r\n      let param = {\r\n        layerName: layerName,\r\n        filterVal: filterVal\r\n      }\r\n      console.log(decodeURIComponent(url))\r\n      axios.get(url, param, { timeout: 1200000 }).then(function (res) {\r\n        var featuresData = res.data;\r\n        if (featuresData) {\r\n\r\n          _this.initSingleLayer(featuresData, param, dataItem, _this)\r\n        }\r\n      })\r\n\r\n    },\r\n\r\n    //根据图层名字以及过滤属性值获取图层信息(线和面文件同时查询处理)\r\n    getAreaLineLays (layerName, filterVal) {\r\n      let arrays_ = [];\r\n      let isEqual = false;\r\n      for (let i = 0; i < this.areaLineFilterVals.length; i++) {\r\n        for (let key in this.areaLineFilterVals[i]) {\r\n          if (arrays_.indexOf(key) == -1) {\r\n            arrays_.push(key)\r\n          }\r\n          if (key == layerName && this.areaLineFilterVals[i][layerName] == filterVal) {\r\n            isEqual = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      if (isEqual) {\r\n        return arrays_;\r\n      } else {\r\n        arrays_ = [];\r\n        arrays_.push(layerName)\r\n        return arrays_;\r\n      }\r\n    },\r\n\r\n\r\n    addVectorLayerWfs (checkedArray) {\r\n      let _this = this;\r\n      let checkedLayerMap = this.getLayerMap(checkedArray);\r\n      for (let k = 0; k < checkedLayerMap.length; k++) {\r\n        let item = checkedLayerMap[k];\r\n        let treeDataItems_ = item.treeDataItem;\r\n        let layerName_ = item.layerName;\r\n        if (!treeDataItems_ || treeDataItems_.length == 0 || !layerName_) {\r\n          continue;\r\n        }\r\n        for (let i = 0; i < treeDataItems_.length; i++) {\r\n          var filterVal = treeDataItems_[i].filterValue;\r\n          var filterKey = treeDataItems_[i].filterKey;\r\n          if (!filterKey || !filterVal) {\r\n            continue;\r\n          }\r\n          try {\r\n            //处理线和面两边都存在数据的情况\r\n            let layerFileArray = this.getAreaLineLays(layerName_, filterVal);\r\n            for (let m = 0; m < layerFileArray.length; m++) {\r\n              this.addSingleLayer(this, layerFileArray[m], treeDataItems_[i]);\r\n            }\r\n          } catch (err) {\r\n            console.log(\"图层：\" + layerName_ + \"过滤值：\" + filterVal + \"请求异常：\", err);\r\n          }\r\n        }\r\n      }\r\n      //})\r\n    },\r\n\r\n\r\n\r\n    getLayerMap (checkedArray) {\r\n      if (checkedArray == null) {\r\n        return null;\r\n      }\r\n      var layerMap = [];\r\n      this.treeData2.forEach(item => {\r\n        this.assembleLayerItems(item, null, layerMap, checkedArray);\r\n      })\r\n\r\n      layerMap = layerMap.filter(item => (item.layerName && item.filterKey))\r\n\r\n      return layerMap;\r\n    },\r\n\r\n\r\n    createPointStyle (feature, item) {\r\n      if (!item) {\r\n        return undefined;\r\n      }\r\n      let styles = [];\r\n\r\n      let style = new OlStyleStyle({\r\n        //图标样式\r\n        // image: new OlStyleIcon({\r\n        //   anchor: [10, 18],\r\n        //   scale: 1,\r\n        //   anchorOrigin: 'top-right',\r\n        //   anchorXUnits: 'pixels',\r\n        //   anchorYUnits: 'pixels',\r\n        //   offsetOrigin: 'bottom-left',\r\n        //   opacity: 1,\r\n        //   src: require('../../assets/images/mark.png'),\r\n        // }),\r\n        //文本样式\r\n        text: new Text({\r\n          textAlign: 'center',\r\n          textBaseline: 'middle',\r\n          font: 'normal 0.15rem 微软雅黑',\r\n          text: feature.values_.name,\r\n          offsetY: -25,\r\n          fill: new Fill({\r\n            color: feature.values_.font_color\r\n          }),\r\n          rotation: feature.values_.font_angle * Math.PI / 180,\r\n          padding: [2, 5, 2, 5],\r\n        }),\r\n        // 设置层级\r\n        zIndex: 1999999999\r\n      });\r\n      styles.push(style);\r\n      return styles;\r\n    },\r\n\r\n\r\n    //初始要素样式\r\n    initLayerStyle (feature, item, vectorLayerTmp) {\r\n      let fileType = feature.values_.file_type;\r\n      if (feature.values_.geometry instanceof Point) {\r\n        if (fileType && fileType == 'image') {\r\n          //图片弹框样式\r\n          feature.values_.src = require(\"@/assets/images/img_mark.png\");\r\n          if (this.imagePopArray.indexOf(feature.values_.name) == -1) {\r\n            console.log(feature.values_.name);\r\n            this.imagePopArray.push(feature.values_.name);\r\n          }\r\n          return this.createImageMarkStyle(feature, vectorLayerTmp);\r\n\r\n        } else {\r\n          let layerName = vectorLayerTmp.values_.name;\r\n          if (this.textMarkLayerNmArray.indexOf(layerName) == -1) {\r\n            vectorLayerTmp.setVisible(false)\r\n            vectorLayerTmp.set('initHide', true)\r\n            this.textMarkLayerNmArray.push(layerName);\r\n          }\r\n          vectorLayerTmp.values_.zIndex = 99999999999999\r\n          return this.createPointStyle(feature, item);\r\n        }\r\n      } else {\r\n        return this.initGraphStyle(feature, item);\r\n      }\r\n    },\r\n\r\n    getStyleSetting (feature, item) {\r\n      let style = {};\r\n      let strokeColor = item.strokeColor ? item.strokeColor : (feature.get('border_col') ? feature.get('border_col') : feature.get('line_color'))\r\n      let fillColor = item.fillColor ? item.fillColor : feature.get('fill_color')\r\n      let strokeWidth = item.width ? item.width : (feature.get('border_wid') ? feature.get('border_wid') : feature.get('line_width'))\r\n      style.strokeColor = strokeColor;\r\n      style.fillColor = fillColor;\r\n      style.strokeWidth = strokeWidth;\r\n      return style;\r\n    },\r\n\r\n\r\n\r\n\r\n    initGraphStyle (feature, item) {\r\n      let styles = [];\r\n      var fill_style = feature.get(\"fill_style\");\r\n      if (!item) {\r\n        return undefined;\r\n      }\r\n      let styleSetting = this.getStyleSetting(feature, item);\r\n      var dashOffset = item.dashOffset;\r\n      var dasharray = item.dashArray;\r\n      var lineColor = styleSetting.strokeColor;\r\n      var fillColor = styleSetting.fillColor;\r\n      let strokeWidth = styleSetting.strokeWidth;\r\n      let style = new Style();\r\n      // //线条颜色\r\n      // let strokeColor = item.strokeColor;\r\n      // let strokeWidth = item.width;\r\n      let stroke = null;\r\n      if (lineColor) {\r\n        stroke = new Stroke({\r\n          color: lineColor,\r\n        })\r\n      }\r\n      // if (stroke == null && strokeColor != null) {\r\n      //   stroke = new Stroke({\r\n      //     color: strokeColor,\r\n      //   })\r\n      // }\r\n      if (strokeWidth) {\r\n        if (stroke == null) {\r\n          stroke = new Stroke({\r\n            width: strokeWidth,\r\n          })\r\n        } else {\r\n          stroke.width_ = strokeWidth;\r\n        }\r\n      }\r\n      if (dashOffset) {\r\n\r\n        stroke.lineDashOffset_ = dashOffset;\r\n      }\r\n      if (dasharray) {\r\n\r\n        stroke.lineDash_ = dasharray.split(\",\");\r\n      }\r\n      style.stroke_ = stroke;\r\n      //填充颜色\r\n      if (fillColor && fill_style != '' && fill_style != 'No Fill') {\r\n        let fill = new Fill({\r\n          color: fillColor\r\n        })\r\n        style.fill_ = fill;\r\n      }\r\n\r\n      styles.push(style);\r\n      return styles;\r\n    },\r\n\r\n\r\n\r\n    handleCheckChange (data_) {\r\n      this.clearHighlight();\r\n      this.removePopup();\r\n      let halfCheckNode = this.$refs.tree.getHalfCheckedNodes();\r\n      let halfCheckIds = [];\r\n      halfCheckNode.forEach(item => {\r\n        halfCheckIds.push(item.id)\r\n      });\r\n      //获取选中以及半选中节点\r\n      var checkedArray = this.$refs.tree.getCheckedKeys(false);\r\n      checkedArray = checkedArray.concat(halfCheckIds);\r\n      let checkedLayerArray = this.getLayerMap(checkedArray);\r\n      let currentLayers = this.layerArray;\r\n      //如果当前选中数组为空，当前所有图层隐藏\r\n      if (checkedLayerArray == null || checkedLayerArray.length == 0) {\r\n        currentLayers.forEach(item => {\r\n          item.setVisible(false)\r\n          //this.setLayerVisible(item, false);\r\n        })\r\n        return;\r\n      }\r\n      //获取待添加的图层(图例树初始化部分选中)\r\n      for (let i = 0; i < checkedLayerArray.length; i++) {\r\n        if (!checkedLayerArray[i].layerName) {\r\n          continue;\r\n        }\r\n        let treeDataItem = checkedLayerArray[i].treeDataItem;\r\n        if (!treeDataItem) {\r\n          currentLayers.forEach(item => {\r\n            if (item.values_.name == checkedLayerArray[i].layerName) {\r\n              item.setVisible(false)\r\n\r\n            }\r\n          })\r\n          continue;\r\n        }\r\n        for (let j = 0; j < treeDataItem.length; j++) {\r\n          let item = treeDataItem[j];\r\n          let exist = false;\r\n          for (let n = 0; n < currentLayers.length; n++) {\r\n            let layer = currentLayers[n];\r\n            if (layer.values_.filterVal == item.filterValue &&\r\n              layer.values_.name == checkedLayerArray[i].layerName) {\r\n              exist = true;\r\n              layer.setVisible(true)\r\n              continue;\r\n            }\r\n\r\n          }\r\n\r\n          //新增图层\r\n          if (!exist) {\r\n            console.log(\"新增图层=======================\");\r\n            console.log(checkedLayerArray[i].layerName);\r\n            //处理线和面两边都存在数据的情况\r\n            let layerFileArray = this.getAreaLineLays(checkedLayerArray[i].layerName, item.filterValue);\r\n            for (let m = 0; m < layerFileArray.length; m++) {\r\n              this.addSingleLayer(this, layerFileArray[m], item);\r\n            }\r\n            continue;\r\n          }\r\n        }\r\n      }\r\n\r\n      //隐藏取消勾选的图层\r\n      if (!currentLayers || currentLayers.length == 0) {\r\n        return;\r\n      }\r\n      let existLayer = [];\r\n      for (let k = 0; k < currentLayers.length; k++) {\r\n        let exist = false;\r\n        for (let i = 0; i < checkedLayerArray.length; i++) {\r\n          let tempItems = checkedLayerArray[i].treeDataItem;\r\n          let layArray_ = this.getAreaLineLays(checkedLayerArray[i].layerName, currentLayers[k].values_.filterVal);\r\n          for (let m = 0; m < tempItems.length; m++) {\r\n            if (currentLayers[k].values_.filterVal == tempItems[m].filterValue &&\r\n              currentLayers[k].values_.name == checkedLayerArray[i].layerName) {\r\n              exist = true;\r\n              if (existLayer.indexOf(tempItems[m].filterValue) == -1 && layArray_.length > 1) {\r\n                existLayer.push(tempItems[m].filterValue);\r\n              }\r\n              currentLayers[k].setVisible(true);\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (!exist) {\r\n          currentLayers[k].setVisible(false);\r\n\r\n        }\r\n      }\r\n\r\n      //线和面同时查询显示隐藏控制处理\r\n      for (let n = 0; n < currentLayers.length; n++) {\r\n        let exist = false;\r\n        let areaLineConfig = this.getAreaLineLays(currentLayers[n].values_.name, currentLayers[n].values_.filterVal);\r\n        for (let m = 0; m < existLayer.length; m++) {\r\n          if (currentLayers[n].values_.filterVal == existLayer[m] && areaLineConfig.length > 1) {\r\n            exist = true;\r\n            currentLayers[n].setVisible(true);\r\n          }\r\n        }\r\n        if (!exist) {\r\n          if (areaLineConfig.length > 1) {\r\n            currentLayers[n].setVisible(false);\r\n          }\r\n        }\r\n\r\n      }\r\n\r\n\r\n\r\n      // 图片标注关闭开启时控制显示隐藏\r\n      this.imageOverLayArray.forEach(item => {\r\n        if (item.id == filterVal) {\r\n          if (!visible) {\r\n            this.removeImgPopup(item.id);\r\n          } else {\r\n            // console.log(\"ccccc\");\r\n            // console.log(item);\r\n            //this.showImgPopup(item.id, item.values_.position)\r\n          }\r\n        }\r\n      })\r\n\r\n\r\n\r\n    },\r\n\r\n\r\n\r\n    // 弹出框\r\n    addPopup (coordinate, feature) {\r\n      this.removePopup()\r\n      let featureValues = feature.values_;\r\n      this.projectName = featureValues.layer == null ? '' : featureValues.layer;\r\n      this.projectDesc = featureValues.项目概 == null || featureValues.项目概 == undefined ? '' : featureValues.项目概;\r\n      this.start = featureValues.起点 == null ? '' : featureValues.起点;\r\n      this.end = featureValues.终点 == null ? \"\" : featureValues.终点;\r\n      this.length = featureValues.长度 == null ? \"\" : featureValues.长度;\r\n      this.ztz = featureValues.总投资 == null ? \"\" : featureValues.总投资;\r\n      this.kcsjffh = featureValues.勘察_1 == null ? \"\" : featureValues.勘察_1;\r\n      this.status = featureValues.目前工 == null ? \"\" : featureValues.目前工;\r\n      this.bz = featureValues.备注 == null ? \"\" : featureValues.备注;\r\n\r\n      // 获取弹出层DOM\r\n      let container = document.getElementById('popup')\r\n      if (this.projectName === \"0\") {\r\n        return\r\n      }\r\n      if (this.overlay) {\r\n      } else {\r\n        // 创建Overlay弹出层绑定DOM\r\n        this.overlay = new Overlay({\r\n          element: container,\r\n\r\n          autoPan: {\r\n            animation: {\r\n              duration: 250\r\n            }\r\n          }\r\n        })\r\n\r\n        // 添加到map\r\n        this.mapData.addOverlay(this.overlay)\r\n      }\r\n      // 设置弹出层位置即可出现\r\n      this.overlay.setPosition(coordinate)\r\n      document.getElementById('popup').style.display = 'block';\r\n    },\r\n\r\n    // 清除弹出框\r\n    removePopup () {\r\n      if (this.overlay) {\r\n        this.overlay.setPosition(undefined)\r\n        this.showGk = false,\r\n          this.showBz = false\r\n        this.clearHighlight()\r\n      }\r\n\r\n    },\r\n\r\n    //隐藏图片弹框\r\n    removeImgPopup (id) {\r\n      let result = false;\r\n      if (!id) {\r\n        return result;\r\n      }\r\n      let layerArray = this.imageOverLayArray;\r\n      if (layerArray.length == 0) {\r\n        return result;\r\n      }\r\n      layerArray.forEach(item => {\r\n        if (item.id == id) {\r\n\r\n          if (item.values_.position != undefined) {\r\n            result = true;\r\n          }\r\n          item.setPosition(undefined)\r\n        }\r\n      })\r\n      return result;\r\n    },\r\n\r\n    //显示图片弹框\r\n    showImgPopup (id, coordinate) {\r\n      if (!id) {\r\n        return;\r\n      }\r\n      let layerArray = this.imageOverLayArray;\r\n      if (layerArray.length == 0) {\r\n        return;\r\n      }\r\n      layerArray.forEach(item => {\r\n        if (item.id == id) {\r\n          let container = document.getElementById('imagePopup' + id);\r\n          if (container) {\r\n            container.style.display = 'block';\r\n            item.setPosition(coordinate)\r\n          }\r\n        }\r\n      })\r\n    },\r\n\r\n\r\n    //删除高亮图层\r\n    clearHighlight () {\r\n      let arr = this.mapData.getLayers().array_\r\n      let arrayLen = arr.length;\r\n      let remove = 0;\r\n      for (let k = 0; k < arrayLen; k++) {\r\n        let item = arr[k - remove]\r\n        let layerId = item.values_.id\r\n        if (layerId != null && layerId != undefined) {\r\n          if (layerId.indexOf(\"highlightLayer\") != -1) {\r\n            this.mapData.removeLayer(item);\r\n            remove++;\r\n          }\r\n        }\r\n      }\r\n\r\n\r\n    },\r\n\r\n    //根据图层名字高亮\r\n    addHighLightByLayerName (this_, layerName, filterVal) {\r\n      let layerFileArray = this_.getAreaLineLays(layerName, filterVal);\r\n      let featureArray = [];\r\n      for (let m = 0; m < layerFileArray.length; m++) {\r\n        for (let n = 0; n < this_.layerArray.length; n++) {\r\n          if (layerFileArray[m] != this_.layerArray[n].values_.name || this_.layerArray[n].values_.filterVal != filterVal) {\r\n            continue;\r\n          }\r\n          let vectoryResouce = this_.layerArray[n].getSource();\r\n          featureArray = vectoryResouce.featuresRtree_.getAll();\r\n          this_.addHighLightStyle(featureArray, this_, layerFileArray[m]);\r\n        }\r\n      }\r\n    },\r\n\r\n\r\n\r\n\r\n    addHightLigthByLayer (feature, layer, this_) {\r\n      let layerName = layer.values_.name;\r\n      let filterVal = feature.values_.layer;\r\n      let layerFileArray = this_.getAreaLineLays(layerName, filterVal);\r\n      let queryParam = {};\r\n      queryParam.layerNameArray = layerFileArray;\r\n      queryParam.filterValue = filterVal;\r\n      this_.clearHighlight();\r\n      getHighLightMode(queryParam).then(response => {\r\n        let respData = response.data;\r\n        this_.clearHighlight();\r\n        if (respData == null || respData == 'N') {\r\n          let featureArray = [];\r\n          featureArray.push(feature);\r\n          this_.addHighLightStyle(featureArray, this_, layerName);\r\n        } else {\r\n          this_.addHighLightByLayerName(this_, layerName, filterVal);\r\n        }\r\n\r\n\r\n      });\r\n    },\r\n\r\n    createHighLightStyle () {\r\n      let highLightStyle = new Style({\r\n        fill: new Fill({\r\n          color: \"#ffff00\",\r\n        }),\r\n        stroke: new Stroke({\r\n          color: \"#ffff00\",\r\n          width: 3.5\r\n        }),\r\n      })\r\n      return highLightStyle;\r\n    },\r\n\r\n\r\n    addHighLightStyle (featureObj, thisObj, layerName) {\r\n      if (!featureObj) {\r\n        return;\r\n      }\r\n      thisObj.highLightLayer = new VectorLayer({\r\n        zIndex: 9999999999999,\r\n        name: layerName,\r\n        source: new VectorSource({\r\n          features: featureObj,\r\n        }),\r\n        style: (feature, solution) => {\r\n          return thisObj.createHighLightStyle();\r\n        }\r\n      })\r\n      thisObj.highLightLayer.set(\"id\", \"highlightLayer\" + Math.round(Math.random() * 1000))\r\n      this.mapData.addLayer(thisObj.highLightLayer)\r\n\r\n    },\r\n\r\n    changeMap (num) {\r\n      this.activeBtn = num\r\n      if (this.activeBtn == 1) {\r\n        gaodeMapLayer.setVisible(false)\r\n        wxMapLayer.setVisible(true)\r\n        //修改文字标注样式\r\n        this.changeTextStyle(this.activeBtn)\r\n      } else if (this.activeBtn == 2) {\r\n        gaodeMapLayer.setVisible(true)\r\n        wxMapLayer.setVisible(false)\r\n        this.changeTextStyle(this.activeBtn)\r\n      } else if (this.activeBtn == 3) {\r\n        gaodeMapLayer.setVisible(false)\r\n        wxMapLayer.setVisible(false)\r\n        this.changeTextStyle(this.activeBtn)\r\n      }\r\n    },\r\n\r\n    createPointStyleByColor (feature, color) {\r\n      let styles = [];\r\n      let style = new OlStyleStyle({\r\n        // //图标样式\r\n        // image: new OlStyleIcon({\r\n        //   anchor: [10, 18],\r\n        //   scale: 1,\r\n        //   anchorOrigin: 'top-right',\r\n        //   anchorXUnits: 'pixels',\r\n        //   anchorYUnits: 'pixels',\r\n        //   offsetOrigin: 'bottom-left',\r\n        //   opacity: 1,\r\n        //   src: require('../../assets/images/mark.png'),\r\n        // }),\r\n        //文本样式\r\n        text: new Text({\r\n          textAlign: 'center',\r\n          textBaseline: 'middle',\r\n          font: 'normal 0.15rem 微软雅黑',\r\n          text: feature.values_.name,\r\n          offsetY: -25,\r\n          fill: new Fill({\r\n            color: color\r\n          }),\r\n          rotation: feature.values_.font_angle * Math.PI / 180,\r\n          padding: [2, 5, 2, 5],\r\n        }),\r\n        // 设置层级\r\n        zIndex: 1999999999\r\n      });\r\n      styles.push(style);\r\n      return styles;\r\n    },\r\n\r\n\r\n    changeTextStyle (checkVal) {\r\n      let textLayer = this.textMarkLayerNmArray;\r\n      this.layerArray.forEach(item => {\r\n        let layerName = item.values_.name\r\n        if (textLayer.indexOf(layerName) != -1) {\r\n          let vectoryResouce = item.getSource();\r\n          let featureArray = vectoryResouce.featuresRtree_.getAll();\r\n          for (let m = 0; m < featureArray.length; m++) {\r\n            let fontcolor = featureArray[m].values_.font_color;\r\n            let changeColor;\r\n            if (checkVal == 1) {\r\n              changeColor = '#ffff00'\r\n            } else {\r\n              changeColor = '#000000'\r\n            }\r\n            featureArray[m].setStyle(this.createPointStyleByColor(featureArray[m], changeColor))\r\n          }\r\n\r\n        }\r\n      })\r\n    },\r\n\r\n\r\n    //卫星地图切换\r\n    switchChange () {\r\n      let layerTypeSelect = this.value1;\r\n      if (layerTypeSelect) {\r\n        gaodeMapLayer.setVisible(false)\r\n        wxMapLayer.setVisible(true)\r\n      } else {\r\n        gaodeMapLayer.setVisible(true)\r\n        wxMapLayer.setVisible(false)\r\n      }\r\n    },\r\n\r\n    //创建图片弹框\r\n    createImageOverLayer (feature, evt, layer) {\r\n      let id = feature.values_.name;\r\n      let container = document.getElementById(\"imagePopup\" + id)\r\n      console.log(\"弹窗容器为空\");\r\n      if (container == null) {\r\n        return;\r\n      }\r\n      let content = document.getElementById('imageContent' + id)\r\n      let imageFileName = feature.values_.name + \".png\";\r\n      let src = require(\"@/assets/images/\" + imageFileName);\r\n      var zoom = this.mapData.getView().getZoom();\r\n      let width = (zoom - this.markMinZoom) * 250 + 100;\r\n      let height = width * 0.5582\r\n      content.style.width = width;\r\n      content.style.height = height;\r\n      content.innerHTML = `<img src = ` + src + ` style = 'width:100%` + `;height:100%` + `'/>`;\r\n      let overlayTemp = null;\r\n      this.imageOverLayArray.forEach(item => {\r\n        if (item.id == id) {\r\n          overlayTemp = item;\r\n        }\r\n      })\r\n      if (overlayTemp == null) {\r\n        overlayTemp = new Overlay({\r\n          element: container,\r\n          id: id,\r\n          stopEvent: true,\r\n          insertFirst: false\r\n\r\n\r\n        })\r\n        this.imageOverLayArray.push(overlayTemp);\r\n      }\r\n      this.mapData.addOverlay(overlayTemp)\r\n      overlayTemp.setPosition(evt.coordinate)\r\n      container.style.display = 'block';\r\n    },\r\n\r\n\r\n    //设置标记图片样式\r\n    createImageMarkStyle (feature, vectorLayerTmp) {\r\n      let this_ = this;\r\n      vectorLayerTmp.values_.zIndex = 99999999999999\r\n      var zoom = this.mapData.getView().getZoom();\r\n      let scaleChange = (zoom - this.markMinZoom) * 0.2 + 0.5;\r\n      //设置可拖动\r\n      var translate = new Translate({\r\n        hitTolerance: 20,\r\n        layers: [vectorLayerTmp]\r\n      });\r\n      //图片标注拖动，图片弹窗关闭\r\n      translate.on('translating', function (e) {\r\n        let result = this_.removeImgPopup(feature.values_.name);\r\n        translate.values_.openStatus = result;\r\n\r\n      })\r\n\r\n      translate.on(['translateend'], function (e) {\r\n        let openStatus = translate.values_.openStatus;\r\n        console.log('拖动结束' + openStatus)\r\n        if (openStatus) {\r\n          let coordinate = e.coordinate;\r\n          this_.showImgPopup(feature.values_.name, coordinate);\r\n        }\r\n        //重置状态\r\n        translate.values_.openStatus = null;\r\n      })\r\n\r\n      this.mapData.addInteraction(translate);\r\n      return new OlStyleStyle({\r\n        //图标样式\r\n        image: new OlStyleIcon({\r\n          anchor: [10, 18],\r\n          scale: scaleChange,\r\n          anchorOrigin: 'top-right',\r\n          anchorXUnits: 'pixels',\r\n          anchorYUnits: 'pixels',\r\n          offsetOrigin: 'bottom-left',\r\n          opacity: 1,\r\n          src: feature.values_.src\r\n        }),\r\n      });\r\n    },\r\n\r\n\r\n    // 鼠标点击地图事件\r\n    mapClick (evt) {\r\n      let pixel = this.mapData.getEventPixel(evt.originalEvent);\r\n      let featureInfo = {};\r\n      this.mapData.forEachFeatureAtPixel(pixel,\r\n        function (feature, layer) {\r\n          featureInfo.feature = feature;\r\n          featureInfo.layer = layer;\r\n          return featureInfo;\r\n        });\r\n      let feature = featureInfo.feature;\r\n      let layer = featureInfo.layer;\r\n      if (featureInfo.feature) {\r\n        //捕捉到要素后，弹框\r\n        let coordinate = evt.coordinate\r\n        this.addPopup(coordinate, feature)\r\n        this.addHightLigthByLayer(feature, layer, this)\r\n        //对于图片图层展示图片弹框\r\n        this.popImage(feature, layer, evt);\r\n      } else {\r\n\r\n        this.removePopup();\r\n      }\r\n    },\r\n\r\n    createImageStyle (feature, image) {\r\n      var zoom = this.mapData.getView().getZoom();\r\n      let scaleChange = (zoom - this.markMinZoom) * 0.2 + 0.1;\r\n      return new OlStyleStyle({\r\n        //图标样式\r\n        image: new OlStyleIcon({\r\n          anchor: [10, 18],\r\n          scale: scaleChange,\r\n          anchorOrigin: 'top-right',\r\n          anchorXUnits: 'pixels',\r\n          anchorYUnits: 'pixels',\r\n          offsetOrigin: 'bottom-left',\r\n          opacity: 1,\r\n          src: image\r\n        }),\r\n      });\r\n    },\r\n\r\n\r\n\r\n    popImage (feature, layer, evt) {\r\n      if (!feature.values_.file_type) {\r\n        return;\r\n      }\r\n      if (feature.values_.file_type != 'image') {\r\n        return;\r\n      }\r\n\r\n      this.createImageOverLayer(feature, evt, layer);\r\n    },\r\n\r\n\r\n\r\n    mapMoveend () {\r\n      var zoom = this.mapData.getView().getZoom();\r\n      if (zoom > this.markMinZoom) {\r\n\r\n        //显示文字标注\r\n        this.layerArray.forEach(item => {\r\n          if (item.values_.moveeHide || item.values_.initHide) {\r\n            item.setVisible(true);\r\n            item.set('moveeHide', false);\r\n            item.set('initHide', false);\r\n          }\r\n        })\r\n\r\n      } else if (zoom <= this.markMinZoom) {\r\n        this.markFlag = false;\r\n        //隐藏图片弹框\r\n        this.imageOverLayArray.forEach(item => {\r\n          let container = document.getElementById('imagePopup' + item.id);\r\n          if (container != null) {\r\n            container.style.display = 'none';\r\n          }\r\n        });\r\n\r\n        //隐藏文字标注\r\n        this.layerArray.forEach(item => {\r\n          if (this.textMarkLayerNmArray.indexOf(item.values_.name) != -1) {\r\n            if (item.values_.visible) {\r\n              //缩放隐藏标识\r\n              item.set('moveeHide', true)\r\n            }\r\n            item.setVisible(false);\r\n          }\r\n        })\r\n\r\n\r\n\r\n      }\r\n\r\n      //根据缩放事件调整弹框大小\r\n      this.imageOverLayArray.forEach(item => {\r\n        let container = document.getElementById('imagePopup' + item.id)\r\n        if (container != null) {\r\n          let width = (zoom - this.markMinZoom) * 250 + 100;\r\n          container.style.width = width + \"px\"\r\n          container.style.height = width * 0.5582 + \"px\"\r\n        }\r\n      })\r\n\r\n    },\r\n    down (e, i) {\r\n      let dragObj = e.currentTarget\r\n      this.isMouseDown = true\r\n      this['currentX' + i] = e.clientX\r\n      this['currentY' + i] = e.clientY\r\n      this['objX' + i] = dragObj.offsetLeft\r\n      this['objY' + i] = dragObj.offsetTop\r\n      document.onmouseup = e => {\r\n\r\n        this.isMouseDown = false //鼠标抬起时候不要在跟随鼠标移动\r\n        if (!this.isMouseDown) {\r\n          return false\r\n        }\r\n        this.isMouseDown = false //鼠标抬起时候不要在跟随鼠标移动\r\n        dragObj.style.zIndex = 1\r\n      }\r\n      document.onmousemove = e => {\r\n        if (this.isMouseDown == false) {\r\n          return false\r\n        }\r\n        let moveX = e.clientX - this['currentX' + i]\r\n        let moveY = e.clientY - this['currentY' + i]\r\n        dragObj.style.left = this['objX' + i] + moveX + 'px'\r\n        dragObj.style.top = this['objY' + i] + moveY + 'px'\r\n        dragObj.style.zIndex = 999 //让拖动的div权重最大\r\n      }\r\n\r\n    },\r\n    scaleDom (e) {\r\n\r\n      let div = e.currentTarget\r\n      let zoom = parseInt(div.style.zoom, 10) || 100;\r\n      zoom += e.wheelDelta / 12;\r\n      if (zoom > 0) { div.style.zoom = `${zoom}%` }\r\n    }\r\n\r\n\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.ol-popup {\r\n  position: absolute;\r\n  bottom: 0.1875rem;\r\n  left: -2.1125rem;\r\n  width: 4.8875rem;\r\n  border-radius: 0.0625rem;\r\n  padding: 0.125rem 0.1875rem;\r\n  background: #ffffff;\r\n  border: 0.0125rem solid #d2e3fa;\r\n  box-shadow: 0 0.125rem 0.25rem 0.0125rem rgba(138, 144, 153, 0.4);\r\n  color: #4a4a4a;\r\n}\r\n.ol-popup-closer {\r\n  position: absolute;\r\n  top: 0.1rem;\r\n  color: #999999;\r\n  font-weight: bold;\r\n  font-size: 0.125rem;\r\n  right: 0.1rem;\r\n}\r\n.popup-nav-title {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n.popup-nav-title span:first-child {\r\n  color: #000;\r\n}\r\n.popup-nav-title span:last-child {\r\n  color: #707070;\r\n  font-size: 0.15rem;\r\n}\r\n.el-divider--horizontal {\r\n  margin: 0.1875rem 0;\r\n}\r\n.popup-nav-item {\r\n  display: flex;\r\n  color: #4a4a4a;\r\n}\r\n.popup-nav-icon {\r\n  margin-right: 0.1rem;\r\n  width: 0.1875rem;\r\n}\r\n.popup-item {\r\n  font-size: 0.175rem;\r\n  margin-bottom: 0.1rem;\r\n}\r\n.jt-icon {\r\n  width: 0.375rem;\r\n  position: absolute;\r\n  bottom: -0.175rem;\r\n  left: 1.925rem;\r\n}\r\n::v-deep .el-checkbox {\r\n  position: relative;\r\n  display: block;\r\n  height: 0.325rem;\r\n}\r\n.el-checkbox-group {\r\n  width: 100%;\r\n}\r\n.colorBox {\r\n  width: 0.6rem;\r\n  height: 0.15rem;\r\n  display: inline-block;\r\n  border-radius: 0.025rem;\r\n  position: absolute;\r\n  right: 0.125rem;\r\n}\r\n.road-selector-pop {\r\n  width: 1.5rem;\r\n  height: 2.5rem;\r\n  z-index: 200000;\r\n  position: fixed;\r\n  margin-left: 0.875rem;\r\n  margin-top: 0.6875rem;\r\n  .pop-title {\r\n    font-weight: bold;\r\n    font-size: 0.175rem;\r\n  }\r\n}\r\n.el-collapse-item {\r\n  width: 3.25rem;\r\n  height: 0.55rem;\r\n  opacity: 1;\r\n\r\n  ::v-deep .el-collapse-item__header {\r\n    height: 0.55rem;\r\n    padding-left: 0.125rem;\r\n    background: #ffffff;\r\n    box-shadow: 0 0.125rem 0.25rem 0.0125rem rgba(138, 144, 153, 0.4);\r\n    border-radius: 0.1rem;\r\n  }\r\n}\r\n::v-deep .el-collapse {\r\n  border: none;\r\n  box-shadow: 0 0.125rem 0.25rem 0.0125rem rgba(138, 144, 153, 0.4);\r\n}\r\n::v-deep .el-collapse-item__wrap {\r\n  border-radius: 0 0 0.1rem 0.1rem;\r\n  margin-top: -0.0625rem;\r\n  box-shadow: 0 0.125rem 0.25rem 0.0125rem rgba(138, 144, 153, 0.4);\r\n}\r\n.dot {\r\n  width: 0.3rem;\r\n  height: 0.125rem;\r\n  border-radius: 0.025rem;\r\n  display: inline-block;\r\n  margin-left: 0.1rem;\r\n}\r\n::v-deep .el-tree-node__children {\r\n  overflow: initial !important;\r\n}\r\n.change-div {\r\n  position: absolute;\r\n  right: 0.25rem;\r\n  top: 0.375rem;\r\n  z-index: 999;\r\n  .switch-btn {\r\n    display: inline-block;\r\n    width: 1.2875rem;\r\n    height: 0.475rem;\r\n    text-align: center;\r\n    background: #001d40;\r\n    box-sizing: border-box;\r\n    border: 0.025rem solid #336bb4;\r\n    font-size: 0.175rem;\r\n    font-weight: bold;\r\n    line-height: 0.4375rem;\r\n    color: #ffffff;\r\n    cursor: pointer;\r\n  }\r\n  .left-btn {\r\n    border-radius: 0.2375rem 0 0 0.2375rem;\r\n    margin-right: 0.1rem;\r\n  }\r\n  .right-btn {\r\n    border-radius: 0 0.2375rem 0.2375rem 0;\r\n    margin-left: 0.1rem;\r\n  }\r\n  .switch-btn:hover {\r\n    background: linear-gradient(180deg, #2ca6ff 37%, #00ffb7 100%);\r\n    color: #ffffff;\r\n  }\r\n  .btn-active {\r\n    background: linear-gradient(180deg, #2ca6ff 37%, #00ffb7 100%);\r\n    color: #ffffff;\r\n  }\r\n}\r\n/* 设置滚动条的样式 */\r\n::-webkit-scrollbar {\r\n  width: 0.075rem;\r\n}\r\n/* 滚动槽 */\r\n::-webkit-scrollbar-track {\r\n  -webkit-box-shadow: inset006pxrgba(0, 0, 0, 0.3);\r\n  border-radius: 0.1rem;\r\n}\r\n/* 滚动条滑块 */\r\n::-webkit-scrollbar-thumb {\r\n  border-radius: 0.075rem;\r\n  background: #ebeef5;\r\n  -webkit-box-shadow: inset006pxrgba(0, 0, 0, 0.5);\r\n}\r\n::-webkit-scrollbar-thumb:window-inactive {\r\n  background: #ebeef5;\r\n}\r\n.tree-div {\r\n  height: 4rem;\r\n  overflow: auto;\r\n}\r\n</style>\r\n"]}]}