{"remainingRequest":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\work\\proj\\project_manage\\project-ui\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\work\\proj\\project_manage\\project-ui\\src\\store\\modules\\user.js","dependencies":[{"path":"D:\\work\\proj\\project_manage\\project-ui\\src\\store\\modules\\user.js","mtime":1663479653274},{"path":"D:\\work\\proj\\project_manage\\project-ui\\babel.config.js","mtime":1663229169808},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663230084016},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1663230086097},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1663230084575}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyIpOwoKdmFyIF9sb2dpbiA9IHJlcXVpcmUoIkAvYXBpL2xvZ2luIik7Cgp2YXIgX2F1dGggPSByZXF1aXJlKCJAL3V0aWxzL2F1dGgiKTsKCnZhciB1c2VyID0gewogIHN0YXRlOiB7CiAgICB0b2tlbjogKDAsIF9hdXRoLmdldFRva2VuKSgpLAogICAgbmFtZTogJycsCiAgICBhdmF0YXI6ICcnLAogICAgcm9sZXM6IFtdLAogICAgcGVybWlzc2lvbnM6IFtdCiAgfSwKICBtdXRhdGlvbnM6IHsKICAgIFNFVF9UT0tFTjogZnVuY3Rpb24gU0VUX1RPS0VOKHN0YXRlLCB0b2tlbikgewogICAgICBzdGF0ZS50b2tlbiA9IHRva2VuOwogICAgfSwKICAgIFNFVF9OQU1FOiBmdW5jdGlvbiBTRVRfTkFNRShzdGF0ZSwgbmFtZSkgewogICAgICBzdGF0ZS5uYW1lID0gbmFtZTsKICAgIH0sCiAgICBTRVRfQVZBVEFSOiBmdW5jdGlvbiBTRVRfQVZBVEFSKHN0YXRlLCBhdmF0YXIpIHsKICAgICAgc3RhdGUuYXZhdGFyID0gYXZhdGFyOwogICAgfSwKICAgIFNFVF9ST0xFUzogZnVuY3Rpb24gU0VUX1JPTEVTKHN0YXRlLCByb2xlcykgewogICAgICBzdGF0ZS5yb2xlcyA9IHJvbGVzOwogICAgfSwKICAgIFNFVF9QRVJNSVNTSU9OUzogZnVuY3Rpb24gU0VUX1BFUk1JU1NJT05TKHN0YXRlLCBwZXJtaXNzaW9ucykgewogICAgICBzdGF0ZS5wZXJtaXNzaW9ucyA9IHBlcm1pc3Npb25zOwogICAgfQogIH0sCiAgYWN0aW9uczogewogICAgLy8g55m75b2VCiAgICBMb2dpbjogZnVuY3Rpb24gTG9naW4oX3JlZiwgdXNlckluZm8pIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgICB2YXIgdXNlcm5hbWUgPSB1c2VySW5mby51c2VybmFtZS50cmltKCk7CiAgICAgIHZhciBwYXNzd29yZCA9IHVzZXJJbmZvLnBhc3N3b3JkOwogICAgICB2YXIgY29kZSA9IHVzZXJJbmZvLmNvZGU7CiAgICAgIHZhciB1dWlkID0gdXNlckluZm8udXVpZDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAoMCwgX2xvZ2luLmxvZ2luKSh1c2VybmFtZSwgcGFzc3dvcmQsIGNvZGUsIHV1aWQpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgdmFyIGZpcnN0TG9naW4gPSByZXMuZmlyc3RMb2dpbkZsYWc7CiAgICAgICAgICB2YXIgaW5kZXhNZW51SWQgPSByZXMuaW5kZXhNZW51SWQ7CiAgICAgICAgICAoMCwgX2F1dGguc2V0VG9rZW4pKHJlcy50b2tlbik7CiAgICAgICAgICB2YXIgZGF0YSA9IHsKICAgICAgICAgICAgZmlyc3RMb2dpbjogZmlyc3RMb2dpbiwKICAgICAgICAgICAgaW5kZXhNZW51SWQ6IGluZGV4TWVudUlkCiAgICAgICAgICB9OwogICAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCByZXMudG9rZW4pOwogICAgICAgICAgcmVzb2x2ZShkYXRhKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOiOt+WPlueUqOaIt+S/oeaBrwogICAgR2V0SW5mbzogZnVuY3Rpb24gR2V0SW5mbyhfcmVmMikgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjIuY29tbWl0LAogICAgICAgICAgc3RhdGUgPSBfcmVmMi5zdGF0ZTsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAoMCwgX2xvZ2luLmdldEluZm8pKCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICB2YXIgdXNlciA9IHJlcy51c2VyOwogICAgICAgICAgdmFyIGF2YXRhciA9IHVzZXIuYXZhdGFyID09ICIiIHx8IHVzZXIuYXZhdGFyID09IG51bGwgPyByZXF1aXJlKCJAL2Fzc2V0cy9pbWFnZXMvcHJvZmlsZS5qcGciKSA6IHByb2Nlc3MuZW52LlZVRV9BUFBfQkFTRV9BUEkgKyB1c2VyLmF2YXRhcjsKCiAgICAgICAgICBpZiAocmVzLnJvbGVzICYmIHJlcy5yb2xlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIC8vIOmqjOivgei/lOWbnueahHJvbGVz5piv5ZCm5piv5LiA5Liq6Z2e56m65pWw57uECiAgICAgICAgICAgIGNvbW1pdCgnU0VUX1JPTEVTJywgcmVzLnJvbGVzKTsKICAgICAgICAgICAgY29tbWl0KCdTRVRfUEVSTUlTU0lPTlMnLCByZXMucGVybWlzc2lvbnMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29tbWl0KCdTRVRfUk9MRVMnLCBbJ1JPTEVfREVGQVVMVCddKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb21taXQoJ1NFVF9OQU1FJywgdXNlci51c2VyTmFtZSk7CiAgICAgICAgICBjb21taXQoJ1NFVF9BVkFUQVInLCBhdmF0YXIpOwogICAgICAgICAgcmVzb2x2ZShyZXMpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g6YCA5Ye657O757ufCiAgICBMb2dPdXQ6IGZ1bmN0aW9uIExvZ091dChfcmVmMykgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjMuY29tbWl0LAogICAgICAgICAgc3RhdGUgPSBfcmVmMy5zdGF0ZTsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAoMCwgX2xvZ2luLmxvZ291dCkoc3RhdGUudG9rZW4pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCAnJyk7CiAgICAgICAgICBjb21taXQoJ1NFVF9ST0xFUycsIFtdKTsKICAgICAgICAgIGNvbW1pdCgnU0VUX1BFUk1JU1NJT05TJywgW10pOwogICAgICAgICAgKDAsIF9hdXRoLnJlbW92ZVRva2VuKSgpOwogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5YmN56uvIOeZu+WHugogICAgRmVkTG9nT3V0OiBmdW5jdGlvbiBGZWRMb2dPdXQoX3JlZjQpIHsKICAgICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCAnJyk7CiAgICAgICAgKDAsIF9hdXRoLnJlbW92ZVRva2VuKSgpOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSk7CiAgICB9CiAgfQp9Owp2YXIgX2RlZmF1bHQgPSB1c2VyOwpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDs="},{"version":3,"names":["user","state","token","getToken","name","avatar","roles","permissions","mutations","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","SET_PERMISSIONS","actions","Login","userInfo","commit","username","trim","password","code","uuid","Promise","resolve","reject","login","then","res","firstLogin","firstLoginFlag","indexMenuId","setToken","data","catch","error","GetInfo","getInfo","require","process","env","VUE_APP_BASE_API","length","userName","LogOut","logout","removeToken","FedLogOut"],"sources":["D:/work/proj/project_manage/project-ui/src/store/modules/user.js"],"sourcesContent":["import { login, logout, getInfo } from '@/api/login'\r\nimport { getToken, setToken, removeToken } from '@/utils/auth'\r\n\r\nconst user = {\r\n  state: {\r\n    token: getToken(),\r\n    name: '',\r\n    avatar: '',\r\n    roles: [],\r\n    permissions: []\r\n  },\r\n\r\n  mutations: {\r\n    SET_TOKEN: (state, token) => {\r\n      state.token = token\r\n    },\r\n    SET_NAME: (state, name) => {\r\n      state.name = name\r\n    },\r\n    SET_AVATAR: (state, avatar) => {\r\n      state.avatar = avatar\r\n    },\r\n    SET_ROLES: (state, roles) => {\r\n      state.roles = roles\r\n    },\r\n    SET_PERMISSIONS: (state, permissions) => {\r\n      state.permissions = permissions\r\n    }\r\n  },\r\n\r\n  actions: {\r\n    // 登录\r\n    Login({ commit }, userInfo) {\r\n      const username = userInfo.username.trim()\r\n      const password = userInfo.password\r\n      const code = userInfo.code\r\n      const uuid = userInfo.uuid\r\n      return new Promise((resolve, reject) => {\r\n        login(username, password, code, uuid).then(res => {\r\n          let firstLogin = res.firstLoginFlag;\r\n          let indexMenuId = res.indexMenuId\r\n          setToken(res.token)\r\n          let data={firstLogin,indexMenuId}\r\n          commit('SET_TOKEN', res.token)\r\n          resolve(data)\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 获取用户信息\r\n    GetInfo({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        getInfo().then(res => {\r\n          const user = res.user\r\n          const avatar = (user.avatar == \"\" || user.avatar == null) ? require(\"@/assets/images/profile.jpg\") : process.env.VUE_APP_BASE_API + user.avatar;\r\n          if (res.roles && res.roles.length > 0) { // 验证返回的roles是否是一个非空数组\r\n            commit('SET_ROLES', res.roles)\r\n            commit('SET_PERMISSIONS', res.permissions)\r\n          } else {\r\n            commit('SET_ROLES', ['ROLE_DEFAULT'])\r\n          }\r\n          commit('SET_NAME', user.userName)\r\n          commit('SET_AVATAR', avatar)\r\n          resolve(res)\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 退出系统\r\n    LogOut({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        logout(state.token).then(() => {\r\n          commit('SET_TOKEN', '')\r\n          commit('SET_ROLES', [])\r\n          commit('SET_PERMISSIONS', [])\r\n          removeToken()\r\n          resolve()\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 前端 登出\r\n    FedLogOut({ commit }) {\r\n      return new Promise(resolve => {\r\n        commit('SET_TOKEN', '')\r\n        removeToken()\r\n        resolve()\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport default user\r\n"],"mappings":"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"}]}