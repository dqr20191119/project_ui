{"remainingRequest":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\work\\proj\\project_manage\\project-ui\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\work\\proj\\project_manage\\project-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\proj\\project_manage\\project-ui\\src\\views\\traffic-decision\\components\\tab2-left.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\proj\\project_manage\\project-ui\\src\\views\\traffic-decision\\components\\tab2-left.vue","mtime":1663479653290},{"path":"D:\\work\\proj\\project_manage\\project-ui\\babel.config.js","mtime":1663229169808},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663230084016},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1663230086097},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663230084016},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1663230087832}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkID0gcmVxdWlyZSgiRDovd29yay9wcm9qL3Byb2plY3RfbWFuYWdlL3Byb2plY3QtdWkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVXaWxkY2FyZC5qcyIpLmRlZmF1bHQ7Cgp2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoIkQ6L3dvcmsvcHJvai9wcm9qZWN0X21hbmFnZS9wcm9qZWN0LXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdC5qcyIpLmRlZmF1bHQ7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsKCnZhciBfZGVmaW5lUHJvcGVydHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJEOi93b3JrL3Byb2ovcHJvamVjdF9tYW5hZ2UvcHJvamVjdC11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eS5qcyIpKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuanNvbi5zdHJpbmdpZnkuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLmpzIik7CgpyZXF1aXJlKCJvbC9vbC5jc3MiKTsKCnZhciBfTWFwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9NYXAiKSk7Cgp2YXIgb2xDb250cm9sID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgib2wvY29udHJvbCIpKTsKCnZhciBfVmlldyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgib2wvVmlldyIpKTsKCnZhciBfZXh0ZW50ID0gcmVxdWlyZSgib2wvZXh0ZW50Iik7Cgp2YXIgX1RpbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL2xheWVyL1RpbGUiKSk7Cgp2YXIgX1dNVFMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL3NvdXJjZS9XTVRTIikpOwoKdmFyIF9YWVogPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL3NvdXJjZS9YWVoiKSk7Cgp2YXIgX1dNVFMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC90aWxlZ3JpZC9XTVRTIikpOwoKdmFyIF9Qcm9qZWN0aW9uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9wcm9qL1Byb2plY3Rpb24iKSk7Cgp2YXIgX3Byb2ogPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInByb2o0IikpOwoKdmFyIF9wcm9qMiA9IHJlcXVpcmUoIm9sL3Byb2ovcHJvajQiKTsKCnZhciBfVmVjdG9yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9zb3VyY2UvVmVjdG9yIikpOwoKdmFyIF9zb3VyY2UgPSByZXF1aXJlKCJvbC9zb3VyY2UiKTsKCnZhciBfVmVjdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgib2wvbGF5ZXIvVmVjdG9yIikpOwoKdmFyIF9GZWF0dXJlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9GZWF0dXJlIikpOwoKdmFyIF9pbnRlcmFjdGlvbiA9IHJlcXVpcmUoIm9sL2ludGVyYWN0aW9uIik7Cgp2YXIgX3N0eWxlID0gcmVxdWlyZSgib2wvc3JjL3N0eWxlIik7Cgp2YXIgX1dLVCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgib2wvZm9ybWF0L1dLVCIpKTsKCnZhciBfR2VvSlNPTiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgib2wvZm9ybWF0L0dlb0pTT04iKSk7Cgp2YXIgX092ZXJsYXkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL092ZXJsYXkiKSk7Cgp2YXIgZWNoYXJ0cyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoImVjaGFydHMiKSk7Cgp2YXIgX2F4aW9zID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJheGlvcyIpKTsKCnZhciBfcmVxdWVzdCA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoIkAvdXRpbHMvcmVxdWVzdCIpKTsKCnZhciBfdGFiMlJpZ2h0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCIuL3RhYjItcmlnaHQudnVlIikpOwoKdmFyIF9jb21tb24gPSByZXF1aXJlKCJAL2FwaS9jb21tb24vY29tbW9uIik7Cgp2YXIgX3BsYW5lID0gcmVxdWlyZSgiQC9hcGkvZGVjaXNpb24vcGxhbmUiKTsKCnZhciB0dXJmID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiQHR1cmYvdHVyZiIpKTsKCnZhciBfUG9pbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL2dlb20vUG9pbnQiKSk7Cgp2YXIgX3Byb2ozID0gcmVxdWlyZSgib2wvcHJvaiIpOwoKdmFyIF9MaW5lU3RyaW5nID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9nZW9tL0xpbmVTdHJpbmciKSk7Cgp2YXIgX011bHRpTGluZVN0cmluZyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgib2wvZ2VvbS9NdWx0aUxpbmVTdHJpbmciKSk7Cgp2YXIgX2NvbXBvbmVudCA9IHJlcXVpcmUoIkAvYXBpL2NvbmZpZy9jb21wb25lbnQiKTsKCnZhciBfc3BoZXJlID0gcmVxdWlyZSgib2wvc3BoZXJlIik7Cgp2YXIgX2RlY2lzaW9uID0gcmVxdWlyZSgiQC9hcGkvZGVjaXNpb24tbWFuYWdlL2RlY2lzaW9uIik7CgovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovL+S4reW/g+WdkOaghwp2YXIgY2VudGVyQ29yZGluYXRlID0gWzY1NjgxMy40NDI1NiwgMzU2MDQzMi45ODI0NV07IC8v5Z2Q5qCH5a6a5LmJCgpfcHJvai5kZWZhdWx0LmRlZnMoIkVQU0c6NDU0OCIsICIrcHJvaj10bWVyYyArbGF0XzA9MCArbG9uXzA9MTE3ICtrPTEgK3hfMD01MDAwMDAgK3lfMD0wICtlbGxwcz1HUlM4MCArdW5pdHM9bSArbm9fZGVmcyIpOwoKKDAsIF9wcm9qMi5yZWdpc3RlcikoX3Byb2ouZGVmYXVsdCk7CnZhciBuZXdMaXN0ID0gW107CnZhciBwYXJlbnRWYWwgPSAnJzsgLy/lnLDlm77liJ3lp4vljJYKCnZhciB2aWV3ID0gbmV3IF9WaWV3LmRlZmF1bHQoewogIGNlbnRlcjogKDAsIF9wcm9qMy50cmFuc2Zvcm0pKGNlbnRlckNvcmRpbmF0ZSwgJ0VQU0c6NDU0OCcsICdFUFNHOjM4NTcnKSwKICBtaW5ab29tOiAxMCwKICBtYXhab29tOiAxOCwKICB6b29tOiAxMy41IC8vIOWcsOWbvuWIneWni+WMlueahOe8qeaUvue6p+WIqwoKfSk7IC8v6auY5b635Zyw5Zu+5Zu+5bGCCgp2YXIgZ2FvZGVNYXBMYXllciA9IG5ldyBfVGlsZS5kZWZhdWx0KHsKICBzb3VyY2U6IG5ldyBfWFlaLmRlZmF1bHQoewogICAgdXJsOiAnaHR0cDovL3dlYnN0MHsxLTR9LmlzLmF1dG9uYXZpLmNvbS9hcHBtYXB0aWxlP2xhbmc9emhfY24mc2l6ZT0xJnNjbD0yJnN0eWxlPTcmeD17eH0meT17eX0mej17en0nCiAgfSkKfSk7CnZhciBfZGVmYXVsdCA9IHsKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbGVmdFBsYW5lTGlzdDogW10sCiAgICAgIHBvcFRyYW5zTGlzdDogW3sKICAgICAgICBsYWJlbDogJ0FC5Lqk6YCa6YePJywKICAgICAgICBwcm9wZXJ0aWU6ICdhYl9mbG93JywKICAgICAgICB1bml0OiAncGN1L2gnLAogICAgICAgIHR5cGU6ICdpbnQnCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogJ0JB5Lqk6YCa6YePJywKICAgICAgICBwcm9wZXJ0aWU6ICdiYV9mbG93JywKICAgICAgICB1bml0OiAncGN1L2gnLAogICAgICAgIHR5cGU6ICdpbnQnCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogJ+aAu+S6pOmAmumHjycsCiAgICAgICAgcHJvcGVydGllOiAndG90X2Zsb3cnLAogICAgICAgIHVuaXQ6ICdwY3UvaCcsCiAgICAgICAgdHlwZTogJ2ludCcKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAnQULppbHlkozluqYnLAogICAgICAgIHByb3BlcnRpZTogJ2FiX3ZvYycsCiAgICAgICAgbWF4bGVuZ3RoOiAyLAogICAgICAgIHR5cGU6ICdmbG9hdCcKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAnQkHppbHlkozluqYnLAogICAgICAgIHByb3BlcnRpZTogJ2JhX3ZvYycsCiAgICAgICAgbWF4bGVuZ3RoOiAyLAogICAgICAgIHR5cGU6ICdmbG9hdCcKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAn5pyA5aSn6aWx5ZKM5bqmJywKICAgICAgICBwcm9wZXJ0aWU6ICdtYXhfdm9jJywKICAgICAgICBtYXhsZW5ndGg6IDIsCiAgICAgICAgdHlwZTogJ2Zsb2F0JwogICAgICB9XSwKICAgICAgbGVmdFBsYW5lOiAnJywKICAgICAgcmlnaHRTZWxlY3RlZFBsYW5lOiBudWxsLAogICAgICB2ZWN0b3JMYXllcjogbnVsbCwKICAgICAgem9vbVRocmVzaG9sZDogMTUuNywKICAgICAgaW5pdFN0eWxlRmxhZzogZmFsc2UsCiAgICAgIHN0eWxlOiB7CiAgICAgICAgbGluZV93aWR0aDogMywKICAgICAgICBsaW5lX3N0cm9rZTogJyM0NTljNTAnLAogICAgICAgIGludGVydmFsOiA0MAogICAgICB9LAogICAgICBtYXA6IG51bGwKICAgIH07CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAvL+iOt+WPluiPnOWNlUlECiAgICB0aGlzLm1lbnVJZCA9ICgwLCBfcmVxdWVzdC5nZXRVcmxLZXkpKCdtZW51SWQnKTsgLy/moLnmja7oj5zljZVJROafpeivoue7hOS7tuS/oeaBrwoKICAgIHRoaXMuaW5pdENvbXBvbmVudEluZm8oKTsKICAgIHRoaXMuaW5pdE1hcCgpOyAvLyDpq5jkuq4KCiAgICB0aGlzLiRiYXMuJG9uKCJhZGRMZWZ0SGlnaExpZ2h0U3R5bGUiLCBmdW5jdGlvbiAoaSwgaiwgbnVtKSB7CiAgICAgIF90aGlzLmFkZEhpZ2hMaWdodFN0eWxlKGksIGosIG51bSk7CiAgICB9KTsgLy/muIXpmaTpq5jkuq4KCiAgICB0aGlzLiRiYXMuJG9uKCJjbGVhckhpZ2hsaWdodF9ZIiwgZnVuY3Rpb24gKGkpIHsKICAgICAgX3RoaXMuY2xlYXJIaWdobGlnaHQoKTsKICAgIH0pOwogICAgdGhpcy5sZWZ0UGxhbmVMaXN0ID0gbmV3TGlzdDsKICAgIHRoaXMubGVmdFBsYW5lTGlzdCA9IHRoaXMubGVmdFBsYW5lTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgcmV0dXJuIGl0ZW0uYml6VmFsID09IHBhcmVudFZhbDsKICAgIH0pOwogICAgdGhpcy4kYmFzLiRvbigicmlnaHRQbGFuZUNoYW5nZSIsIGZ1bmN0aW9uIChpKSB7CiAgICAgIF90aGlzLmxlZnRQbGFuZUxpc3QgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG5ld0xpc3QpKTsKICAgICAgX3RoaXMucmlnaHRTZWxlY3RlZFBsYW5lID0gaTsKICAgICAgZGVidWdnZXI7CiAgICAgIGNvbnNvbGUubG9nKHBhcmVudFZhbCk7CiAgICAgIF90aGlzLmxlZnRQbGFuZUxpc3QgPSBfdGhpcy5sZWZ0UGxhbmVMaXN0LmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLnZhbHVlICE9IGkgJiYgaXRlbS5iaXpWYWwgPT0gcGFyZW50VmFsOwogICAgICB9KTsKICAgICAgY29uc29sZS5sb2coX3RoaXMubGVmdFBsYW5lTGlzdCk7CiAgICAgIF90aGlzLmxlZnRQbGFuZSA9IF90aGlzLmxlZnRQbGFuZUxpc3RbMF0udmFsdWU7CiAgICAgIF90aGlzLnJpZ2h0U2VsZWN0ZWRQbGFuZSA9IGk7CgogICAgICBfdGhpcy5pbml0VmVjdG9yTGF5ZXIoKTsKICAgIH0pOyAvL+aLluWKqOebkeWQrOaWueazlQoKICAgIHRoaXMuJGJhcy4kb24oInJpZ2h0UGFuZWxEcmFnZUNoYW5nZSIsIGZ1bmN0aW9uIChjb3JkaW5hdGUsIHpvb20pIHsKICAgICAgaWYgKGNvcmRpbmF0ZSAmJiB6b29tKSB7CiAgICAgICAgX3RoaXMubGVmdEN1cnJlbnRDb3JkaW5hdGUgPSBjb3JkaW5hdGU7CiAgICAgICAgX3RoaXMubGVmdEN1cnJlbnRab29tID0gem9vbTsKICAgICAgICB2aWV3LmFuaW1hdGUoewogICAgICAgICAgY2VudGVyOiBjb3JkaW5hdGUsCiAgICAgICAgICB6b29tOiB6b29tLAogICAgICAgICAgLy8g57yp5pS+57qn5YirCiAgICAgICAgICByb3RhdGlvbjogdW5kZWZpbmVkLAogICAgICAgICAgZHVyYXRpb246IDEwCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOyAvL+e8qeaUvuebkeWQrAoKICAgIHRoaXMuJGJhcy4kb24oInJpZ2h0TW92dmVuZENoYW5nZSIsIGZ1bmN0aW9uIChjb3JkaW5hdGUsIHpvb20pIHsKICAgICAgaWYgKGNvcmRpbmF0ZSAmJiB6b29tKSB7CiAgICAgICAgX3RoaXMubGVmdEN1cnJlbnRDb3JkaW5hdGUgPSBjb3JkaW5hdGU7CiAgICAgICAgX3RoaXMubGVmdEN1cnJlbnRab29tID0gem9vbTsKICAgICAgICB2aWV3LmFuaW1hdGUoewogICAgICAgICAgY2VudGVyOiBjb3JkaW5hdGUsCiAgICAgICAgICB6b29tOiB6b29tLAogICAgICAgICAgLy8g57yp5pS+57qn5YirCiAgICAgICAgICByb3RhdGlvbjogdW5kZWZpbmVkLAogICAgICAgICAgZHVyYXRpb246IDEwCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgLy/kuqTpgJrkv6Hmga/ngrnlh7vmjInpkq4KCiAgICB3aW5kb3cucHJldmlldzEgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbmZvMicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5mbzEnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuMScpLnN0eWxlLmJhY2tncm91bmQgPSAnIzAwNEFCMyc7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4yJykuc3R5bGUuYmFja2dyb3VuZCA9ICcjRDNENkRCJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm80Jykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbmZvMycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4zJykuc3R5bGUuYmFja2dyb3VuZCA9ICcjMDA0QUIzJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bjQnKS5zdHlsZS5iYWNrZ3JvdW5kID0gJyNEM0Q2REInOwogICAgfTsgLy/ln7rmnKzkv6Hmga/ngrnlh7vmjInpkq4KCgogICAgd2luZG93LnByZXZpZXcyID0gZnVuY3Rpb24gKCkgewogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5mbzInKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5mbzEnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bjInKS5zdHlsZS5iYWNrZ3JvdW5kID0gJyMwMDRBQjMnOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuMScpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjRDNENkRCJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm80Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm8zJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG40Jykuc3R5bGUuYmFja2dyb3VuZCA9ICcjMDA0QUIzJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bjMnKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnI0QzRDZEQic7CiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgLy/mt7vliqDot6/mrrXmloflrZfmoIfms6gKICAgIGFkZE1hcmtUZXh0TGF5ZXI6IGZ1bmN0aW9uIGFkZE1hcmtUZXh0TGF5ZXIoKSB7CiAgICAgIHRoaXMuJGVtaXQoJ2FxdWlyZVBvaW50TWFya0RhdGEnLCB0aGlzLm1hcERhdGEpOwogICAgfSwKICAgIGNoYW5nZUNvbXBhcmVJdGVtQnlCaXpUeXBlOiBmdW5jdGlvbiBjaGFuZ2VDb21wYXJlSXRlbUJ5Qml6VHlwZShwYXJlbnRWYWwsIHRoaXNfKSB7CiAgICAgIHBhcmVudFZhbCA9IHBhcmVudFZhbDsKICAgICAgdGhpc18ubGVmdFBsYW5lTGlzdCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkobmV3TGlzdCkpOwogICAgICB0aGlzXy5sZWZ0UGxhbmVMaXN0ID0gdGhpc18ubGVmdFBsYW5lTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5iaXpWYWwgPT0gcGFyZW50VmFsOwogICAgICB9KTsKICAgICAgdGhpc18ubGVmdFBsYW5lID0gdGhpc18ubGVmdFBsYW5lTGlzdFswXS52YWx1ZTsKICAgICAgdGhpc18uaW5pdFZlY3RvckxheWVyKCk7CiAgICAgIHJldHVybiB0aGlzXy5sZWZ0UGxhbmU7CiAgICB9LAogICAgaW5pdENvbXBvbmVudEluZm86IGZ1bmN0aW9uIGluaXRDb21wb25lbnRJbmZvKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBwYXJhbSA9IHt9OwogICAgICB0aGlzLm9wdGlvbnMgPSBbXTsKICAgICAgcGFyYW0uYml6S2V5ID0gJ3BsYW5lX2NvbXBhcmUnOwogICAgICAoMCwgX2RlY2lzaW9uLmluaXRUcmVlTGlzdCkocGFyYW0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHZhciByZXNwb25zZURhdGEgPSByZXMuZGF0YVswXS5jaGlsZHJlbjsgLy/liJ3lp4vljJbpobXpnaLpgInmi6npu5jorqTnrKzkuIDkuKoKCiAgICAgICAgcmVzcG9uc2VEYXRhWzBdLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKHMpIHsKICAgICAgICAgIF90aGlzMi5sZWZ0UGxhbmVMaXN0LnB1c2goewogICAgICAgICAgICBsYXllck5hbWU6IHMubGF5ZXJOYW1lLAogICAgICAgICAgICBuYW1lOiBzLm5hbWUsCiAgICAgICAgICAgIHZhbHVlOiBzLmlkLAogICAgICAgICAgICBiaXpWYWw6IHMucGFyZW50SWQKICAgICAgICAgIH0pOwogICAgICAgIH0pOyAvL25ld2xpc3Qg6I635Y+W5YWo6YOo55qE5pWw5o2uIOetm+mAieeUqAoKICAgICAgICByZXNwb25zZURhdGEuZm9yRWFjaChmdW5jdGlvbiAoc3MpIHsKICAgICAgICAgIHNzLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgbmV3TGlzdC5wdXNoKHsKICAgICAgICAgICAgICBsYXllck5hbWU6IHIubGF5ZXJOYW1lLAogICAgICAgICAgICAgIG5hbWU6IHIubmFtZSwKICAgICAgICAgICAgICB2YWx1ZTogci5pZCwKICAgICAgICAgICAgICBiaXpWYWw6IHIucGFyZW50SWQKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICBkZWJ1Z2dlcjsKICAgICAgICBwYXJlbnRWYWwgPSByZXNwb25zZURhdGFbMF0uaWQ7CiAgICAgICAgX3RoaXMyLnJpZ2h0U2VsZWN0ZWRQbGFuZSA9IF90aGlzMi5sZWZ0UGxhbmVMaXN0WzFdLnZhbHVlOwogICAgICAgIF90aGlzMi5sZWZ0UGxhbmUgPSBfdGhpczIubGVmdFBsYW5lTGlzdFswXS52YWx1ZTsgLy8g5Yid5aeL5YyW5Zu+5bGCCgogICAgICAgIF90aGlzMi5pbml0VmVjdG9yTGF5ZXIoKTsKICAgICAgfSk7CiAgICB9LAogICAgLy8gZ2V0UG9pbnRzQnlMaW5lIChjb29yZHMsIGRpcikgewogICAgLy8gICBsZXQgdGhpc18gPSB0aGlzOwogICAgLy8gICBsZXQgc3R5bGVzID0gW107CiAgICAvLyAgIGxldCBkaXN0YW5jZV8gPSB0aGlzXy5zdHlsZS5pbnRlcnZhbCAvIDI7Ly/pppbkuKrngrnmlL7nva7lnKjot53nprvotbfngrkxLzLpl7TpmpTnmoTkvY3nva4KICAgIC8vICAgbGV0IHBpeF9zdGFydCA9IHRoaXNfLm1hcERhdGEuZ2V0UGl4ZWxGcm9tQ29vcmRpbmF0ZShjb29yZHNbMF0pCiAgICAvLyAgIGxldCBwaXhfZW5kCiAgICAvLyAgIGZvciAobGV0IGkgPSAxOyBpIDwgY29vcmRzLmxlbmd0aDsgaSsrKSB7CiAgICAvLyAgICAgbGV0IGNvb3JkXywgY29vcmRfcGl4OwogICAgLy8gICAgIGxldCBzdHlsZV87CiAgICAvLyAgICAgcGl4X2VuZCA9IHRoaXNfLm1hcERhdGEuZ2V0UGl4ZWxGcm9tQ29vcmRpbmF0ZShjb29yZHNbaV0pOwogICAgLy8gICAgIGxldCBkaXNfc3RhcnQyZW5kID0gTWF0aC5zcXJ0KE1hdGgucG93KChwaXhfc3RhcnRbMF0gLSBwaXhfZW5kWzBdKSwgMikgKyBNYXRoLnBvdygocGl4X3N0YXJ0WzFdIC0gcGl4X2VuZFsxXSksIDIpKSAvLyDorqHnrpfmlLblsL7lnKjlsY/luZXkuIrnmoTot53nprsKICAgIC8vICAgICBpZiAoZGlzX3N0YXJ0MmVuZCA+IGRpc3RhbmNlXykgeyAvLyDot53nprvlpKfkuo7pl7TpmpQKICAgIC8vICAgICAgIC8vIOiuoeeul+i3neemu+W8gOWni+eCueS9jeeahOWDj+e0oOWAvAogICAgLy8gICAgICAgY29vcmRfcGl4ID0gWwogICAgLy8gICAgICAgICAoZGlzdGFuY2VfICogKHBpeF9lbmRbMF0gLSBwaXhfc3RhcnRbMF0pKSAvIGRpc19zdGFydDJlbmQgKyBwaXhfc3RhcnRbMF0sCiAgICAvLyAgICAgICAgIChkaXN0YW5jZV8gKiAocGl4X2VuZFsxXSAtIHBpeF9zdGFydFsxXSkpIC8gZGlzX3N0YXJ0MmVuZCArIHBpeF9zdGFydFsxXQogICAgLy8gICAgICAgXTsKICAgIC8vICAgICAgIC8vIOiuoeeul+e7j+e6rOW6pgogICAgLy8gICAgICAgY29vcmRfID0gdGhpc18ubWFwRGF0YS5nZXRDb29yZGluYXRlRnJvbVBpeGVsKGNvb3JkX3BpeCk7CiAgICAvLyAgICAgICB2YXIgcm90YXRpb24gPSBNYXRoLlBJIC8gMiArIE1hdGguYXRhbjIocGl4X2VuZFsxXSAtIHBpeF9zdGFydFsxXSwgcGl4X2VuZFswXSAtIHBpeF9zdGFydFswXSk7CiAgICAvLyAgICAgICBpZiAoZGlyID09IC0xKSB7CiAgICAvLyAgICAgICAgIHJvdGF0aW9uID0gcm90YXRpb24gKyBNYXRoLlBJCiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgICAvLyDnlJ/miJDmoLflvI8KICAgIC8vICAgICAgIHN0eWxlXyA9IG5ldyBTdHlsZSh7CiAgICAvLyAgICAgICAgIC8vIOeureWktOeCueeahOS9jee9rgogICAgLy8gICAgICAgICBnZW9tZXRyeTogbmV3IFBvaW50KGNvb3JkXyksCiAgICAvLyAgICAgICB9KQogICAgLy8gICAgICAgLy8gIGlmIChkaXIgIT0gMCkgewogICAgLy8gICAgICAgLy8g566t5aS054K555qE5qC35byPCiAgICAvLyAgICAgICBsZXQgaW1hZ2UgPSBuZXcgSWNvbih7CiAgICAvLyAgICAgICAgIHNyYzogcmVxdWlyZSgnQC9hc3NldHMvaW1hZ2VzL2p1ZWNlL3VwMTAtMTAucG5nJyksCiAgICAvLyAgICAgICAgIHJvdGF0ZVdpdGhWaWV3OiB0cnVlLAogICAgLy8gICAgICAgICByb3RhdGlvbjogcm90YXRpb24sCiAgICAvLyAgICAgICAgIHNjYWxlOiB0aGlzLnN0eWxlLmxpbmVfd2lkdGggLyA1LAogICAgLy8gICAgICAgICBpbWdTaXplOiBbMTAsIDEwXQogICAgLy8gICAgICAgfSkKICAgIC8vICAgICAgIHN0eWxlXy5zZXRJbWFnZShpbWFnZSk7CiAgICAvLyAgICAgICAvLyB9CiAgICAvLyAgICAgICAvL+S4i+asoeW+queOr+W8gOWni+eCueS4uuW9k+WJjeeCuQogICAgLy8gICAgICAgcGl4X3N0YXJ0ID0gY29vcmRfcGl4OwogICAgLy8gICAgICAgZGlzdGFuY2VfID0gdGhpc18uc3R5bGUuaW50ZXJ2YWw7CiAgICAvLyAgICAgICBpLS07CiAgICAvLyAgICAgfSBlbHNlIGlmIChkaXNfc3RhcnQyZW5kID09IGRpc3RhbmNlXykgey8vIOi3neemu+etieS6jumXtOmalAogICAgLy8gICAgICAgdmFyIHJvdGF0aW9uID0gTWF0aC5QSSAvIDIgKyBNYXRoLmF0YW4yKHBpeF9lbmRbMV0gLSBwaXhfc3RhcnRbMV0sIHBpeF9lbmRbMF0gLSBwaXhfc3RhcnRbMF0pCiAgICAvLyAgICAgICBpZiAoZGlyID09IC0xKSB7CiAgICAvLyAgICAgICAgIHJvdGF0aW9uID0gcm90YXRpb24gKyBNYXRoLlBJCiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgICAvLyDnlJ/miJDmoLflvI8KICAgIC8vICAgICAgIHN0eWxlXyA9IG5ldyBTdHlsZSh7CiAgICAvLyAgICAgICAgIC8vIOeureWktOeCueeahOS9jee9rgogICAgLy8gICAgICAgICBnZW9tZXRyeTogbmV3IFBvaW50KGNvb3Jkc1tpXSksCiAgICAvLyAgICAgICAgIC8vIOeureWktOeCueeahOagt+W8jwogICAgLy8gICAgICAgICBpbWFnZTogbmV3IEljb24oewogICAgLy8gICAgICAgICAgIHNyYzogcmVxdWlyZSgnQC9hc3NldHMvaW1hZ2VzL2p1ZWNlL3VwMTAtMTAucG5nJyksCiAgICAvLyAgICAgICAgICAgcm90YXRlV2l0aFZpZXc6IHRydWUsCiAgICAvLyAgICAgICAgICAgcm90YXRpb246IHJvdGF0aW9uLAogICAgLy8gICAgICAgICAgIHNjYWxlOiB0aGlzLnN0eWxlLmxpbmVfd2lkdGggLyA1LAogICAgLy8gICAgICAgICAgIGltZ1NpemU6IFsxMCwgMTBdCiAgICAvLyAgICAgICAgIH0pCiAgICAvLyAgICAgICB9KQogICAgLy8gICAgICAgcGl4X3N0YXJ0ID0gcGl4X2VuZDsKICAgIC8vICAgICAgIGRpc3RhbmNlXyA9IHRoaXNfLnN0eWxlLmludGVydmFsOwogICAgLy8gICAgIH0gZWxzZSB7Ly/ot53nprvlsI/kuo7pl7TpmpQKICAgIC8vICAgICAgIGRpc3RhbmNlXyA9IGRpc3RhbmNlXyAtIGRpc19zdGFydDJlbmQ7CiAgICAvLyAgICAgICBwaXhfc3RhcnQgPSBwaXhfZW5kOwogICAgLy8gICAgIH0KICAgIC8vICAgICBzdHlsZV8gJiYgc3R5bGVzLnB1c2goc3R5bGVfKQogICAgLy8gICB9CiAgICAvLyAgIHJldHVybiBzdHlsZXMKICAgIC8vIH0sCiAgICBnZXRQb2ludEV4dGVudDogZnVuY3Rpb24gZ2V0UG9pbnRFeHRlbnQobikgewogICAgICBuID0gbiA/IG4gOiAxLjI7CiAgICAgIHZhciB2aWV3ID0gdGhpcy5tYXBEYXRhLmdldFZpZXcoKTsKICAgICAgdmFyIG1hcHNpemUgPSB0aGlzLm1hcERhdGEuZ2V0U2l6ZSgpLm1hcChmdW5jdGlvbiAoaXRfKSB7CiAgICAgICAgcmV0dXJuIGl0XyAqIG47CiAgICAgIH0pOwogICAgICByZXR1cm4gdmlldy5jYWxjdWxhdGVFeHRlbnQobWFwc2l6ZSk7CiAgICB9LAogICAgZ2V0TWlkZGxlUG9pbnQ6IGZ1bmN0aW9uIGdldE1pZGRsZVBvaW50KGNvb3JkcywgZmVhdHVyZSkgewogICAgICB0cnkgewogICAgICAgIGlmIChjb29yZHMgPT0gbnVsbCB8fCBjb29yZHMubGVuZ3RoID09IDAgfHwgY29vcmRzID09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29vcmRzLmxlbmd0aCA8PSAzKSB7CiAgICAgICAgICB2YXIgcG9pbnRfZmVhdHVyZXMgPSB0dXJmLnBvaW50cyhmZWF0dXJlLmdldEdlb21ldHJ5KCkuZ2V0Q29vcmRpbmF0ZXMoKVswXSk7CiAgICAgICAgICByZXR1cm4gbmV3IF9Qb2ludC5kZWZhdWx0KHR1cmYuY2VudGVyKHBvaW50X2ZlYXR1cmVzKS5nZW9tZXRyeS5jb29yZGluYXRlcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29vcmRzLmxlbmd0aCAlIDIgPT0gMCkgewogICAgICAgICAgcmV0dXJuIG5ldyBfUG9pbnQuZGVmYXVsdChjb29yZHNbY29vcmRzLmxlbmd0aCAvIDJdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIG5ldyBfUG9pbnQuZGVmYXVsdChjb29yZHNbTWF0aC5jZWlsKGNvb3Jkcy5sZW5ndGggLyAyKV0pOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgfQogICAgfSwKICAgIGluaUZsb3dPclZvY1RleHQ6IGZ1bmN0aW9uIGluaUZsb3dPclZvY1RleHQoY29vcmRzLCBmZWF0dXJlLCB0aGlzXywgdGV4dCwgb2Zmc2V0WCwgb2Zmc2V0eSkgewogICAgICB2YXIgY2VudGVyUG9pbnQgPSB0aGlzLmdldE1pZGRsZVBvaW50KGNvb3JkcywgZmVhdHVyZSk7CgogICAgICBpZiAoIWNlbnRlclBvaW50KSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciBwaXhfc3RhcnQgPSB0aGlzXy5tYXBEYXRhLmdldFBpeGVsRnJvbUNvb3JkaW5hdGUoY29vcmRzWzBdKTsKICAgICAgdmFyIHBpeF9lbmQgPSB0aGlzXy5tYXBEYXRhLmdldFBpeGVsRnJvbUNvb3JkaW5hdGUoY2VudGVyUG9pbnQuZmxhdENvb3JkaW5hdGVzKTsKICAgICAgdmFyIHJvdGF0aW9uID0gTWF0aC5QSSArIE1hdGguYXRhbjIocGl4X2VuZFsxXSAtIHBpeF9zdGFydFsxXSwgcGl4X2VuZFswXSAtIHBpeF9zdGFydFswXSk7CgogICAgICBpZiAocGl4X2VuZFswXSA+IHBpeF9zdGFydFswXSkgewogICAgICAgIHJvdGF0aW9uID0gcm90YXRpb24gKyBNYXRoLlBJOwogICAgICB9CgogICAgICB0ZXh0ID0gdGV4dCArICIiOwogICAgICB2YXIgY29sb3IgPSB0aGlzXy5nZXRDb2xvckJ5RmVhdHVyZShmZWF0dXJlKTsKICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlVGV4dFN0eWxlKGNlbnRlclBvaW50LCByb3RhdGlvbiwgdGV4dCwgb2Zmc2V0WCwgb2Zmc2V0eSwgY29sb3IpOwogICAgfSwKICAgIGluaXRGbG93T3JWb2NQb2ludDogZnVuY3Rpb24gaW5pdEZsb3dPclZvY1BvaW50KGZlYXR1cmUsIHRoaXNfLCBpc0Zsb3cpIHsKICAgICAgdmFyIGNvb3JkcyA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKS5nZXRDb29yZGluYXRlcygpOwogICAgICB2YXIgc3R5bGVzID0gW107CiAgICAgIHZhciBleHRlbnRfID0gdGhpc18uZ2V0UG9pbnRFeHRlbnQoKTsKICAgICAgdmFyIGxpbmVfID0gdHVyZi5tdWx0aUxpbmVTdHJpbmcoY29vcmRzKTsKICAgICAgdmFyIGxpbmVfY2xpcF9hcnIgPSB0dXJmLmJib3hDbGlwKGxpbmVfLCBleHRlbnRfKTsKICAgICAgdmFyIGFiX3RleHQgPSBpc0Zsb3cgPyBmZWF0dXJlLmdldCgiYWJfZmxvdyIpIDogZmVhdHVyZS5nZXQoImFiX3ZvYyIpOwogICAgICB2YXIgYmFfdGV4dCA9IGlzRmxvdyA/IGZlYXR1cmUuZ2V0KCJiYV9mbG93IikgOiBmZWF0dXJlLmdldCgiYmFfdm9jIik7CgogICAgICBpZiAoYWJfdGV4dCAhPSBudWxsICYmIGFiX3RleHQgIT0gJycpIHsKICAgICAgICBhYl90ZXh0ID0gaXNGbG93ID8gTWF0aC5mbG9vcihhYl90ZXh0KSA6ICgwLCBfY29tbW9uLmZvcm1hdEZpeE51bSkoYWJfdGV4dCwgMik7CiAgICAgIH0KCiAgICAgIGlmIChiYV90ZXh0ICE9IG51bGwgJiYgYmFfdGV4dCAhPSAnJykgewogICAgICAgIGJhX3RleHQgPSBpc0Zsb3cgPyBNYXRoLmZsb29yKGJhX3RleHQpIDogKDAsIF9jb21tb24uZm9ybWF0Rml4TnVtKShiYV90ZXh0LCAyKTsKICAgICAgfQoKICAgICAgaWYgKGxpbmVfY2xpcF9hcnIuZ2VvbWV0cnkudHlwZSA9PSAiTGluZVN0cmluZyIpIHsKICAgICAgICBpZiAoYWJfdGV4dCAhPSBudWxsICYmIGFiX3RleHQgIT0gJycpIHsKICAgICAgICAgIHZhciBvZmZzZXRYID0gMTU7CiAgICAgICAgICB2YXIgb2Zmc2V0eSA9IDE1OwogICAgICAgICAgdmFyIHN0eWxlX2FiID0gdGhpc18uaW5pRmxvd09yVm9jVGV4dChsaW5lX2NsaXBfYXJyLmdlb21ldHJ5LmNvb3JkaW5hdGVzLCBmZWF0dXJlLCB0aGlzXywgYWJfdGV4dCwgb2Zmc2V0WCwgb2Zmc2V0eSk7CiAgICAgICAgICBzdHlsZXMgPSBzdHlsZXMuY29uY2F0KHN0eWxlX2FiKTsKICAgICAgICB9CgogICAgICAgIGlmIChiYV90ZXh0ICE9IG51bGwgJiYgYmFfdGV4dCAhPSAnJykgewogICAgICAgICAgdmFyIF9vZmZzZXRYID0gLTE1OwoKICAgICAgICAgIHZhciBfb2Zmc2V0eSA9IC0xNTsKCiAgICAgICAgICB2YXIgc3R5bGVfYmEgPSB0aGlzXy5pbmlGbG93T3JWb2NUZXh0KGxpbmVfY2xpcF9hcnIuZ2VvbWV0cnkuY29vcmRpbmF0ZXMsIGZlYXR1cmUsIHRoaXNfLCBiYV90ZXh0LCBfb2Zmc2V0WCwgX29mZnNldHkpOwogICAgICAgICAgc3R5bGVzID0gc3R5bGVzLmNvbmNhdChzdHlsZV9iYSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gc3R5bGVzOwogICAgfSwKICAgIGNyZWF0ZVRleHRTdHlsZTogZnVuY3Rpb24gY3JlYXRlVGV4dFN0eWxlKGNvb3JkaW5hdGUsIHJvYXRpb24sIHRleHQsIG9mZnNldHgsIG9mZnNldHksIGNvbG9yKSB7CiAgICAgIHZhciBfVGV4dDsKCiAgICAgIHZhciBzdHlsZXNfID0gW107CiAgICAgIHZhciB0ZXh0XyA9IG5ldyBfc3R5bGUuVGV4dCgoX1RleHQgPSB7CiAgICAgICAgdGV4dEFsaWduOiAnY2VudGVyJywKICAgICAgICB0ZXh0QmFzZWxpbmU6ICdtaWRkbGUnLAogICAgICAgIGZvbnQ6ICdub3JtYWwgMTVweCDlvq7ova/pm4Xpu5EnLAogICAgICAgIHRleHQ6IHRleHQKICAgICAgfSwgKDAsIF9kZWZpbmVQcm9wZXJ0eTIuZGVmYXVsdCkoX1RleHQsICJ0ZXh0QmFzZWxpbmUiLCAibWlkZGxlIiksICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKF9UZXh0LCAib2Zmc2V0WSIsIG9mZnNldHgpLCAoMCwgX2RlZmluZVByb3BlcnR5Mi5kZWZhdWx0KShfVGV4dCwgIm9mZnNldFgiLCBvZmZzZXR5KSwgKDAsIF9kZWZpbmVQcm9wZXJ0eTIuZGVmYXVsdCkoX1RleHQsICJmaWxsIiwgbmV3IF9zdHlsZS5GaWxsKHsKICAgICAgICBjb2xvcjogY29sb3IKICAgICAgfSkpLCAoMCwgX2RlZmluZVByb3BlcnR5Mi5kZWZhdWx0KShfVGV4dCwgInJvdGF0aW9uIiwgcm9hdGlvbiksIF9UZXh0KSk7CiAgICAgIHZhciBzdHlsZV8gPSBuZXcgX3N0eWxlLlN0eWxlKHsKICAgICAgICBnZW9tZXRyeTogY29vcmRpbmF0ZQogICAgICB9KTsKICAgICAgc3R5bGVfLnNldFRleHQodGV4dF8pOwogICAgICBzdHlsZXNfLnB1c2goc3R5bGVfKTsKICAgICAgcmV0dXJuIHN0eWxlc187CiAgICB9LAogICAgZ2V0Q29sb3JCeUZlYXR1cmU6IGZ1bmN0aW9uIGdldENvbG9yQnlGZWF0dXJlKGZlYXR1cmUpIHsKICAgICAgLy8g6aWx5ZKM5bqmCiAgICAgIHZhciBtYXhfdm9jID0gZmVhdHVyZS5nZXQoIm1heF92b2MiKTsKICAgICAgdmFyIGNvbG9yID0gdGhpcy5zdHlsZS5saW5lX3N0cm9rZTsKCiAgICAgIGlmIChtYXhfdm9jID4gMCAmJiBtYXhfdm9jIDw9IDAuMjUpIHsKICAgICAgICBjb2xvciA9ICcjMTg1ODE3JzsKICAgICAgfSBlbHNlIGlmIChtYXhfdm9jID4gMC4yNSAmJiBtYXhfdm9jIDw9IDAuNSkgewogICAgICAgIGNvbG9yID0gJyM2MWE0M2EnOwogICAgICB9IGVsc2UgaWYgKG1heF92b2MgPiAwLjUgJiYgbWF4X3ZvYyA8PSAwLjc1KSB7CiAgICAgICAgY29sb3IgPSAnI2NmZTA1ZCc7CiAgICAgIH0gZWxzZSBpZiAobWF4X3ZvYyA+IDAuNzUgJiYgbWF4X3ZvYyA8PSAxKSB7CiAgICAgICAgY29sb3IgPSAnI2Q4Yzk2NCc7CiAgICAgIH0gZWxzZSBpZiAobWF4X3ZvYyA+IDEgJiYgbWF4X3ZvYyA8PSAxLjI1KSB7CiAgICAgICAgY29sb3IgPSAnI2Q3OTU1MCc7CiAgICAgIH0gZWxzZSBpZiAobWF4X3ZvYyA+IDEuMjUgJiYgbWF4X3ZvYyA8PSAxLjUpIHsKICAgICAgICBjb2xvciA9ICcjYzc1YjQxJzsKICAgICAgfSBlbHNlIGlmIChtYXhfdm9jID4gMS41ICYmIG1heF92b2MgPD0gMS43NSkgewogICAgICAgIGNvbG9yID0gJyNjNzViNDEnOwogICAgICB9IGVsc2UgaWYgKG1heF92b2MgPiAxLjc1KSB7CiAgICAgICAgY29sb3IgPSAnIzAwMDAwMCc7CiAgICAgIH0KCiAgICAgIHJldHVybiBjb2xvcjsKICAgIH0sCiAgICBnZXRQb2ludHNTdHlsZTogZnVuY3Rpb24gZ2V0UG9pbnRzU3R5bGUoZmVhdHVyZSkgewogICAgICB2YXIgY29vcmRzID0gZmVhdHVyZS5nZXRHZW9tZXRyeSgpLmdldENvb3JkaW5hdGVzKCk7CiAgICAgIHZhciB0aGlzXyA9IHRoaXM7CiAgICAgIHZhciBzdHlsZXMgPSBbXTsgLy8g5pa55ZCR77yIMeWNleWQke+8jC0x5Y+N5ZCR5Y2V5ZCR77yMMOWPjOWQke+8iQoKICAgICAgdmFyIGRpciA9IGZlYXR1cmUuZ2V0KCJkaXIiKTsgLy8g5rWB6YePCgogICAgICB2YXIgdG90X2Zsb3cgPSBmZWF0dXJlLmdldCgidG90X2Zsb3ciKTsgLy8g6aKc6Imy6buY6K6k5YC8CgogICAgICB2YXIgY29sb3IgPSB0aGlzLmdldENvbG9yQnlGZWF0dXJlKGZlYXR1cmUpOyAvLyDnspfnu4bpu5jorqTlgLwKCiAgICAgIHZhciB3aWR0aCA9IHRoaXNfLnN0eWxlLmxpbmVfd2lkdGg7CiAgICAgIHZhciBwZWMgPSAyOwoKICAgICAgaWYgKHRvdF9mbG93ID4gMCAmJiB0b3RfZmxvdyA8PSAxMjUwKSB7CiAgICAgICAgd2lkdGggPSAxICogcGVjOwogICAgICB9IGVsc2UgaWYgKHRvdF9mbG93ID4gMTI1MCAmJiB0b3RfZmxvdyA8PSAyNTAwKSB7CiAgICAgICAgd2lkdGggPSAyICogcGVjOwogICAgICB9IGVsc2UgaWYgKHRvdF9mbG93ID49IDI1MDApIHsKICAgICAgICB3aWR0aCA9IDQgKiBwZWM7CiAgICAgIH0KCiAgICAgIHN0eWxlcy5wdXNoKG5ldyBfc3R5bGUuU3R5bGUoewogICAgICAgIHN0cm9rZTogbmV3IF9zdHlsZS5TdHJva2UoewogICAgICAgICAgY29sb3I6IGNvbG9yLAogICAgICAgICAgd2lkdGg6IHdpZHRoCiAgICAgICAgfSkKICAgICAgfSkpOyAvLyBsZXQgZXh0ZW50XyA9IHRoaXMuZ2V0UG9pbnRFeHRlbnQoKTsKICAgICAgLy8gbGV0IGxpbmVfID0gdHVyZi5tdWx0aUxpbmVTdHJpbmcoY29vcmRzKTsKICAgICAgLy8gbGV0IGxpbmVfY2xpcF9hcnIgPSB0dXJmLmJib3hDbGlwKGxpbmVfLCBleHRlbnRfKQogICAgICAvLyBpZiAobGluZV9jbGlwX2FyciAmJiBsaW5lX2NsaXBfYXJyLmdlb21ldHJ5KSB7CiAgICAgIC8vICAgaWYgKGxpbmVfY2xpcF9hcnIuZ2VvbWV0cnkudHlwZSA9PSAiTGluZVN0cmluZyIpIHsKICAgICAgLy8gICAgIGxldCBzdHlsZV8gPSB0aGlzXy5nZXRQb2ludHNCeUxpbmUobGluZV9jbGlwX2Fyci5nZW9tZXRyeS5jb29yZGluYXRlcywgZGlyKTsKICAgICAgLy8gICAgIGlmIChzdHlsZV8gaW5zdGFuY2VvZiBBcnJheSkgewogICAgICAvLyAgICAgICBzdHlsZXMgPSBzdHlsZXMuY29uY2F0KHN0eWxlXykKICAgICAgLy8gICAgIH0gZWxzZSB7CiAgICAgIC8vICAgICAgIHN0eWxlcy5wdXNoKHN0eWxlXykKICAgICAgLy8gICAgIH0KICAgICAgLy8gICB9IGVsc2UgaWYgKGxpbmVfY2xpcF9hcnIuZ2VvbWV0cnkudHlwZSA9PSAiTXVsdGlMaW5lU3RyaW5nIikgewogICAgICAvLyAgICAgbGluZV9jbGlwX2Fyci5nZW9tZXRyeS5jb29yZGluYXRlcy5mb3JFYWNoKGNvb3JkcyA9PiB7CiAgICAgIC8vICAgICAgIGxldCBzdHlsZV8gPSB0aGlzXy5nZXRQb2ludHNCeUxpbmUoY29vcmRzLCBkaXIpCiAgICAgIC8vICAgICAgIGlmIChzdHlsZV8gaW5zdGFuY2VvZiBBcnJheSkgewogICAgICAvLyAgICAgICAgIHN0eWxlcyA9IHN0eWxlcy5jb25jYXQoc3R5bGVfKQogICAgICAvLyAgICAgICB9IGVsc2UgewogICAgICAvLyAgICAgICAgIHN0eWxlcy5wdXNoKHN0eWxlXykKICAgICAgLy8gICAgICAgfQogICAgICAvLyAgICAgfSkKICAgICAgLy8gICB9CiAgICAgIC8vIH0KCiAgICAgIHJldHVybiBzdHlsZXM7CiAgICB9LAogICAgaW5pdFZlY3RvckxheWVyOiBmdW5jdGlvbiBpbml0VmVjdG9yTGF5ZXIoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIHBsYW5lSW5mbyA9IHRoaXMubGVmdFBsYW5lTGlzdC5maW5kKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0udmFsdWUgPT0gX3RoaXMzLmxlZnRQbGFuZTsKICAgICAgfSk7IC8vIOWIneWni+WMluaLv+WIsOWFrOWFseaVsOaNrgoKICAgICAgdmFyICRtYXAgPSB0aGlzLm1hcERhdGE7CiAgICAgIHZhciAkdGhpcyA9IHRoaXM7CiAgICAgICRtYXAucmVtb3ZlTGF5ZXIoJHRoaXMudmVjdG9yTGF5ZXIpOyAvLyDor7fmsYLmlbDmja4KCiAgICAgIHZhciB1cmwgPSBwcm9jZXNzLmVudi5WVUVfQVBQX0dJU19CQVNFX1VSTCArICcvVGVzdC9vd3M/c2VydmljZT1XRlMmdmVyc2lvbj0xLjAuMCZyZXF1ZXN0PUdldEZlYXR1cmUmdHlwZU5hbWU9JyArIGVuY29kZVVSSShwbGFuZUluZm8ubGF5ZXJOYW1lKSArICcmbWF4RmVhdHVyZXM9NTAwMDAwMDAwJm91dHB1dEZvcm1hdD1hcHBsaWNhdGlvbiUyRmpzb24nOwoKICAgICAgX2F4aW9zLmRlZmF1bHQuZ2V0KHVybCwgbnVsbCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgdmFyIGZlYXR1cmVzRGF0YSA9IHJlcy5kYXRhOwogICAgICAgIHZhciB2ZWN0b3JTb3VyY2UgPSBuZXcgX1ZlY3Rvci5kZWZhdWx0KHsKICAgICAgICAgIGZlYXR1cmVzOiBuZXcgX0dlb0pTT04uZGVmYXVsdCh7CiAgICAgICAgICAgIGZlYXR1cmVQcm9qZWN0aW9uOiAnRVBTRzozODU3JywKICAgICAgICAgICAgZGF0YVByb2plY3Rpb246ICdFUFNHOjQ1NDgnCiAgICAgICAgICB9KS5yZWFkRmVhdHVyZXMoZmVhdHVyZXNEYXRhKQogICAgICAgIH0pOwogICAgICAgICR0aGlzLnZlY3RvckxheWVyID0gbmV3IF9WZWN0b3IyLmRlZmF1bHQoewogICAgICAgICAgc291cmNlOiB2ZWN0b3JTb3VyY2UsCiAgICAgICAgICBzdHlsZTogZnVuY3Rpb24gc3R5bGUoZmVhdHVyZSwgc29sdXRpb24pIHsKICAgICAgICAgICAgdmFyIHN0eWxlcyA9ICR0aGlzLmdldFBvaW50c1N0eWxlKGZlYXR1cmUpOyAvL+agueaNruaWh+Wtl+aOp+WItuaMiemSruaWsOWinuaWh+Wtl+agt+W8jwoKICAgICAgICAgICAgdmFyIGFjdGl2ZUJ0biA9ICR0aGlzLiRwYXJlbnQuJHBhcmVudC4kcGFyZW50LmFjdGl2ZUJ0bjsKCiAgICAgICAgICAgIGlmIChhY3RpdmVCdG4gIT0gJycgJiYgYWN0aXZlQnRuICE9IDMpIHsKICAgICAgICAgICAgICB2YXIgaXNGbG93ID0gYWN0aXZlQnRuID09IDM7CiAgICAgICAgICAgICAgdmFyIGZsb3dTdHlsZSA9ICR0aGlzLmluaXRGbG93T3JWb2NQb2ludChmZWF0dXJlLCAkdGhpcywgaXNGbG93KTsKCiAgICAgICAgICAgICAgaWYgKGZsb3dTdHlsZSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBzdHlsZXMgPSBzdHlsZXMuY29uY2F0KGZsb3dTdHlsZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gc3R5bGVzOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgICR0aGlzLm1hcERhdGEuYWRkTGF5ZXIoJHRoaXMudmVjdG9yTGF5ZXIpOwogICAgICB9KTsKICAgIH0sCiAgICBsZWZ0UG9pbnRlcmRyYWc6IGZ1bmN0aW9uIGxlZnRQb2ludGVyZHJhZygpIHsKICAgICAgdGhpcy5sZWZ0Q3VycmVudENvcmRpbmF0ZSA9IHZpZXcuZ2V0Q2VudGVyKCk7CiAgICAgIHRoaXMubGVmdEN1cnJlbnRab29tID0gdmlldy5nZXRab29tKCk7CiAgICAgIHRoaXMuJGJhcy4kZW1pdCgibGVmdFBhbmVsRHJhZ2VDaGFuZ2UiLCB0aGlzLmxlZnRDdXJyZW50Q29yZGluYXRlLCB0aGlzLmxlZnRDdXJyZW50Wm9vbSk7CiAgICB9LAogICAgbGVmdE1vdnZlbmQ6IGZ1bmN0aW9uIGxlZnRNb3Z2ZW5kKCkgewogICAgICB0aGlzLmxlZnRDdXJyZW50Q29yZGluYXRlID0gdmlldy5nZXRDZW50ZXIoKTsKICAgICAgdGhpcy5sZWZ0Q3VycmVudFpvb20gPSB2aWV3LmdldFpvb20oKTsKICAgICAgdGhpcy4kYmFzLiRlbWl0KCJsZWZ0TW92dmVuZENoYW5nZSIsIHRoaXMubGVmdEN1cnJlbnRDb3JkaW5hdGUsIHRoaXMubGVmdEN1cnJlbnRab29tKTsgLy/moLnmja7nvKnmlL7nuqfliKvmlLnlj5jmtYHph4/mloflrZfmoLflvI8KICAgICAgLy90aGlzLmNoYW5nZUZsb3dUZXh0U3R5bGVCeUN1cnJlbnRab29tKCk7CiAgICB9LAogICAgc2hvd0Zsb3dUZXh0OiBmdW5jdGlvbiBzaG93Rmxvd1RleHQodGhpc18sIGlzRmxvdykgewogICAgICB0aGlzXy52ZWN0b3JMYXllci5zZXRTdHlsZShmdW5jdGlvbiAoZmVhdHVyZSwgc29sdXRpb24pIHsKICAgICAgICB2YXIgc3R5bGVzID0gW107CiAgICAgICAgdmFyIHBvaW50QXJyb3dTdHlsZSA9IHRoaXNfLmdldFBvaW50c1N0eWxlKGZlYXR1cmUpOwogICAgICAgIHZhciBmbG93U3R5bGUgPSB0aGlzXy5pbml0Rmxvd09yVm9jUG9pbnQoZmVhdHVyZSwgdGhpc18sIGlzRmxvdyk7CgogICAgICAgIGlmIChwb2ludEFycm93U3R5bGUgIT0gbnVsbCAmJiBwb2ludEFycm93U3R5bGUubGVuZ3RoID4gMCkgewogICAgICAgICAgc3R5bGVzID0gc3R5bGVzLmNvbmNhdChwb2ludEFycm93U3R5bGUpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGZsb3dTdHlsZSAhPSBudWxsICYmIGZsb3dTdHlsZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICBzdHlsZXMgPSBzdHlsZXMuY29uY2F0KGZsb3dTdHlsZSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gc3R5bGVzOwogICAgICB9KTsKICAgIH0sCiAgICBoaWRlRmxvd1RleHQ6IGZ1bmN0aW9uIGhpZGVGbG93VGV4dCh0aGlzXykgewogICAgICBpZiAodGhpc18udmVjdG9yTGF5ZXIpIHsKICAgICAgICB0aGlzXy52ZWN0b3JMYXllci5zZXRTdHlsZShudWxsKTsKICAgICAgICB0aGlzXy52ZWN0b3JMYXllci5zZXRTdHlsZShmdW5jdGlvbiAoZmVhdHVyZSwgc29sdXRpb24pIHsKICAgICAgICAgIHZhciBzdHlsZXMgPSBbXTsKICAgICAgICAgIHZhciBwb2ludEFycm93U3R5bGUgPSB0aGlzXy5nZXRQb2ludHNTdHlsZShmZWF0dXJlKTsKCiAgICAgICAgICBpZiAocG9pbnRBcnJvd1N0eWxlICE9IG51bGwgJiYgcG9pbnRBcnJvd1N0eWxlLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgc3R5bGVzID0gc3R5bGVzLmNvbmNhdChwb2ludEFycm93U3R5bGUpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBzdHlsZXM7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBjaGFuZ2VGbG93VGV4dFN0eWxlQnlDdXJyZW50Wm9vbTogZnVuY3Rpb24gY2hhbmdlRmxvd1RleHRTdHlsZUJ5Q3VycmVudFpvb20oKSB7CiAgICAgIHZhciB0aGlzXyA9IHRoaXM7IC8v6ZqQ6JeP5paH5a2XCgogICAgICBpZiAodGhpc18ubGVmdEN1cnJlbnRab29tIDwgdGhpc18uem9vbVRocmVzaG9sZCAmJiB0aGlzXy5pbml0U3R5bGVGbGFnKSB7CiAgICAgICAgdGhpcy5pbml0U3R5bGVGbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy5oaWRlRmxvd1RleHQodGhpc18pOwogICAgICB9IC8v5pi+56S65paH5a2XCgoKICAgICAgaWYgKHRoaXNfLmxlZnRDdXJyZW50Wm9vbSA+PSB0aGlzXy56b29tVGhyZXNob2xkICYmICF0aGlzXy5pbml0U3R5bGVGbGFnKSB7CiAgICAgICAgdGhpcy5zaG93Rmxvd1RleHQodGhpc18pOwogICAgICAgIHRoaXMuaW5pdFN0eWxlRmxhZyA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgICAvLyDliJ3lp4vljJblnLDlm74KICAgIGluaXRNYXA6IGZ1bmN0aW9uIGluaXRNYXAoKSB7CiAgICAgIHZhciBtYXBDb250YWluZXIgPSB0aGlzLiRyZWZzLm1hcDsgLy/lsIblm77lsYLliqDlhaVNYXAKCiAgICAgIHZhciBtYXAgPSBuZXcgX01hcC5kZWZhdWx0KHsKICAgICAgICBsYXllcnM6IFtnYW9kZU1hcExheWVyXSwKICAgICAgICB0YXJnZXQ6IG1hcENvbnRhaW5lciwKICAgICAgICB2aWV3OiB2aWV3CiAgICAgIH0pOyAvLyDmt7vliqDmi5bliqjkuovku7YKCiAgICAgIG1hcC5vbigncG9pbnRlcmRyYWcnLCB0aGlzLmxlZnRQb2ludGVyZHJhZyk7IC8vIOa3u+WKoOm8oOagh+eCueWHu+S6i+S7tgoKICAgICAgbWFwLm9uKCdjbGljaycsIHRoaXMubWFwQ2xpY2spOyAvLyDnvKnmlL7nm5HlkKwKCiAgICAgIG1hcC5vbignbW92ZWVuZCcsIHRoaXMubGVmdE1vdnZlbmQpOyAvLyDkv53lrZjlnLDlm74KCiAgICAgIHRoaXMubWFwRGF0YSA9IG1hcDsgLy/mt7vliqDmloflrZfmoIfms6gKCiAgICAgIHRoaXMuYWRkTWFya1RleHRMYXllcigpOwogICAgfSwKICAgIGxlZnRQbGFuZUNoYW5nZTogZnVuY3Rpb24gbGVmdFBsYW5lQ2hhbmdlKCkgewogICAgICB0aGlzLnJlbW92ZVBvcHVwKCk7CiAgICAgIHRoaXMubWFwRGF0YS5yZW1vdmVMYXllcih0aGlzLnZlY3RvckxheWVyKTsKICAgICAgdGhpcy5pbml0VmVjdG9yTGF5ZXIoKTsKICAgICAgdGhpcy4kYmFzLiRlbWl0KCJsZWZ0UGxhbmVDaGFuZ2UiLCB0aGlzLmxlZnRQbGFuZSk7CiAgICB9LAogICAgLy/nu4Too4Xlt6bkvqfkuqTpgJrkv6Hmga/ooagKICAgIGFzc2VibGVMZWZ0VHJhbnNQb3BDb250ZW50OiBmdW5jdGlvbiBhc3NlYmxlTGVmdFRyYW5zUG9wQ29udGVudChmZWF0dXJlLCBjb21wYWlyZUZlYXR1cmUsIGxheWVyKSB7CiAgICAgIHZhciBjb21wYWlyZVJlc3VsdCA9IHt9OwoKICAgICAgaWYgKGNvbXBhaXJlRmVhdHVyZSAhPSBudWxsICYmIGNvbXBhaXJlRmVhdHVyZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICBjb21wYWlyZVJlc3VsdCA9ICgwLCBfcGxhbmUuZmVhdHVyZUNvbXBhaXJlKShmZWF0dXJlLnByb3BlcnRpZXMsIGNvbXBhaXJlRmVhdHVyZS5wcm9wZXJ0aWVzKTsKICAgICAgfQoKICAgICAgdmFyIGRvd25VcmwgPSByZXF1aXJlKCdAL2Fzc2V0cy9pbWFnZXMvbmF2L2Rvd24ucG5nJyk7CgogICAgICB2YXIgdXBVcmwgPSByZXF1aXJlKCdAL2Fzc2V0cy9pbWFnZXMvbmF2L3VwLnBuZycpOwoKICAgICAgdmFyIGNvbnRlbnQgPSAiPGRpdiBzdHlsZT0nY29sb3I6IzEyMTkyNDtmb250LXdlaWdodDogYm9sZDt3aWR0aDoxMDAlO3otaW5kZXg6NDtoZWlnaHQ6OTVweDtwYWRkaW5nOjZweDtmb250LXNpemU6IDE1cHgnPiIgKyBsYXllciArICJcbiAgICAgICAgPGRpdiBzdHlsZSA9ICdtYXJnaW4tdG9wOjEwcHgnID48YnV0dG9uIGlkPSdidG4xJyBzdHlsZT0nbWFyZ2luLXJpZ2h0OjEwcHg7Ym9yZGVyOiBub25lO2hlaWdodDogMjhweDtsaW5lLWhlaWdodDogMjhweDtib3JkZXItcmFkaXVzOiA0cHg7d2lkdGg6IDgwcHg7YmFja2dyb3VuZDogIzAwNEFCMztjb2xvcjogI2ZmZmZmZjsnIG9uY2xpY2s9XCJwcmV2aWV3MSgpXCI+XHU1N0ZBXHU2NzJDXHU0RkUxXHU2MDZGPC9idXR0b24+XG4gICAgICAgICAgICA8YnV0dG9uIGlkPSdidG4yJyBzdHlsZT1cImJvcmRlcjogbm9uZTtoZWlnaHQ6IDI4cHg7bGluZS1oZWlnaHQ6IDI4cHg7Ym9yZGVyLXJhZGl1czogNHB4O3dpZHRoOiA4MHB4O2JhY2tncm91bmQ6ICNEM0Q2REI7Y29sb3I6ICNmZmZmZmY7XCIgb25jbGljaz1cInByZXZpZXcyKClcIj5cdTRFQTRcdTkwMUFcdTRGRTFcdTYwNkY8L2J1dHRvbj48L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IHN0eWxlPSdmb250LXNpemU6IDEwcHg7d2lkdGg6MTAwJScgaWQ9J2luZm8xJz4iOwogICAgICB0aGlzLnBvcFRyYW5zTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgdmFyIHByb3BWYWwgPSBmZWF0dXJlLnByb3BlcnRpZXNbZWxlbWVudC5wcm9wZXJ0aWVdOwoKICAgICAgICBpZiAocHJvcFZhbCAhPSBudWxsKSB7CiAgICAgICAgICB2YXIgbWF4TGVuID0gZWxlbWVudC5tYXhsZW5ndGg7CiAgICAgICAgICB2YXIgdHlwZSA9IGVsZW1lbnQudHlwZTsgLy/moLzlvI/ljJYKCiAgICAgICAgICBpZiAobWF4TGVuICE9IG51bGwgJiYgdHlwZSA9PSAnZmxvYXQnKSB7CiAgICAgICAgICAgIHByb3BWYWwgPSAoMCwgX2NvbW1vbi5mb3JtYXRGaXhOdW0pKHByb3BWYWwsIG1heExlbik7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHR5cGUgPT0gJ2ludCcpIHsKICAgICAgICAgICAgcHJvcFZhbCA9IE1hdGguZmxvb3IocHJvcFZhbCk7CiAgICAgICAgICB9IC8v5ou85o6l5Y2V5L2NCgoKICAgICAgICAgIHZhciB1bml0ID0gZWxlbWVudC51bml0OwoKICAgICAgICAgIGlmICh1bml0ICE9IG51bGwgJiYgcHJvcFZhbCAhPSBudWxsKSB7CiAgICAgICAgICAgIHByb3BWYWwgPSBwcm9wVmFsICsgIiZuYnNwIiArIHVuaXQ7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHByb3BWYWwgPSAnJzsKICAgICAgICB9CgogICAgICAgIGNvbnRlbnQgPSBjb250ZW50ICsgIjxkaXYgc3R5bGU9XCJoZWlnaHQ6IDI2cHg7d2lkdGg6MTAwJVwiPlxuICAgICAgICAgICAgICAgICAgICA8YSBzdHlsZT1cImNvbG9yOiM2NDY1NjY7d2lkdGg6NDAlO2Rpc3BsYXk6IGlubGluZS1ibG9jaztcIj4iICsgZWxlbWVudC5sYWJlbCArICI6PC9hPlxuICAgICAgICAgICAgICAgICAgICA8YSBzdHlsZT1cInRleHQtYWxpZ246IHJpZ2h0O2ZvbnQtc2l6ZToxNHB4O3dpZHRoOjUwJTtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XCI+IiArIHByb3BWYWwgKyAiPC9hPiI7CgogICAgICAgIGlmIChjb21wYWlyZVJlc3VsdFtlbGVtZW50LnByb3BlcnRpZV0gPT0gJz4nKSB7CiAgICAgICAgICBjb250ZW50ID0gY29udGVudCArICI8aW1nIHNyYyA9ICIgKyB1cFVybCArICIgc3R5bGUgPSAnd2lkdGg6MjBweDtoZWlnaHQ6MThweCcgLz4iOwogICAgICAgIH0gZWxzZSBpZiAoY29tcGFpcmVSZXN1bHRbZWxlbWVudC5wcm9wZXJ0aWVdID09ICc8JykgewogICAgICAgICAgY29udGVudCA9IGNvbnRlbnQgKyAiPGltZyBzcmMgPSAiICsgZG93blVybCArICIgc3R5bGUgPSAnd2lkdGg6MjBweDtoZWlnaHQ6MThweCcgLz4iOwogICAgICAgIH0KCiAgICAgICAgY29udGVudCA9IGNvbnRlbnQgKyAiPC9kaXY+IjsKICAgICAgfSk7CiAgICAgIGNvbnRlbnQgPSBjb250ZW50ICsgJzwvZGl2Pic7CiAgICAgIHJldHVybiBjb250ZW50OwogICAgfSwKICAgIC8vIOW8ueWHuuahhgogICAgYWRkTGVmdFBvcHVwOiBmdW5jdGlvbiBhZGRMZWZ0UG9wdXAoY29vcmRpbmF0ZSwgZmVhdHVyZSwgY29tcGFpcmVGZWF0dXJlKSB7CiAgICAgIHRoaXMucmVtb3ZlUG9wdXAoKTsgLy8g6I635Y+W5by55Ye65bGCRE9NCgogICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwJyk7CiAgICAgIHZhciBjb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwLWNvbnRlbnQnKTsKCiAgICAgIGlmICh0aGlzLm92ZXJsYXkpIHt9IGVsc2UgewogICAgICAgIC8vIOWIm+W7uk92ZXJsYXnlvLnlh7rlsYLnu5HlrppET00KICAgICAgICB0aGlzLm92ZXJsYXkgPSBuZXcgX092ZXJsYXkuZGVmYXVsdCh7CiAgICAgICAgICBlbGVtZW50OiBjb250YWluZXIKICAgICAgICB9KTsgLy8g5re75Yqg5YiwbWFwCgogICAgICAgIHRoaXMubWFwRGF0YS5hZGRPdmVybGF5KHRoaXMub3ZlcmxheSk7CiAgICAgIH0gLy8g6YGT6Lev5L+h5oGvCgoKICAgICAgdmFyIGxheWVyID0gZmVhdHVyZS5wcm9wZXJ0aWVzLmxheWVyID09IG51bGwgPyAiIiA6IGZlYXR1cmUucHJvcGVydGllcy5sYXllcjsKICAgICAgdmFyIGhhbmRsZSA9IGZlYXR1cmUucHJvcGVydGllcy5oYW5kbGUgPT0gbnVsbCA/ICIiIDogZmVhdHVyZS5wcm9wZXJ0aWVzLmhhbmRsZTsKICAgICAgdmFyIGxlbmd0aCA9IGZlYXR1cmUucHJvcGVydGllcy5sZW5ndGggPT0gbnVsbCA/ICIiIDogTWF0aC5mbG9vcihmZWF0dXJlLnByb3BlcnRpZXMubGVuZ3RoKSArICIgbSI7CiAgICAgIHZhciBjYXBhY2l0eSA9IGZlYXR1cmUucHJvcGVydGllcy5jYXBhY2l0eSA9PSBudWxsID8gIiIgOiBmZWF0dXJlLnByb3BlcnRpZXMuY2FwYWNpdHkgKyAnIHBjdS9oJzsgLy8g5pa55ZCR77yIMeWNleWQke+8jC0x5Y+N5ZCR5Y2V5ZCR77yMMOWPjOWQke+8iQoKICAgICAgdmFyIGRpciA9IGZlYXR1cmUucHJvcGVydGllcy5kaXIgPT0gMSA/ICLljZXlkJEiIDogZmVhdHVyZS5wcm9wZXJ0aWVzLmRpciA9PSAtMSA/ICLlj43lkJHljZXlkJEiIDogZmVhdHVyZS5wcm9wZXJ0aWVzLmRpciA9PSAwID8gIuWPjOWQkSIgOiAnJzsgLy/kuqTpgJrmtYHph48KCiAgICAgIHZhciB0cmFuc1BvcENvbnRlbnQgPSB0aGlzLmFzc2VibGVMZWZ0VHJhbnNQb3BDb250ZW50KGZlYXR1cmUsIGNvbXBhaXJlRmVhdHVyZSwgbGF5ZXIpOwogICAgICB0cmFuc1BvcENvbnRlbnQgPSB0cmFuc1BvcENvbnRlbnQgKyAiPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBzdHlsZT0nZm9udC1zaXplOiAxMHB4O3dpZHRoOjEwMCUnIGlkPSdpbmZvMic+XG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiaGVpZ2h0OiAyNnB4O3dpZHRoOjEwMCVcIj5cbiAgICAgICAgICAgICAgPGEgc3R5bGU9XCJjb2xvcjojNjQ2NTY2O3dpZHRoOjQ1JTtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XCI+XHU5MDUzXHU4REVGSUQ6PC9hPlxuICAgICAgICAgICAgICA8YSBzdHlsZT1cInRleHQtYWxpZ246IHJpZ2h0O2ZvbnQtc2l6ZToxNHB4O3dpZHRoOjUwJTtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XCI+IiArIGhhbmRsZSArICI8L2E+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJoZWlnaHQ6IDI2cHg7d2lkdGg6MTAwJVwiPlxuICAgICAgICAgICAgICA8YSBzdHlsZT1cImNvbG9yOiM2NDY1NjY7d2lkdGg6NDUlO2Rpc3BsYXk6IGlubGluZS1ibG9jaztcIj5cdTdCNDlcdTdFQTc6PC9hPlxuICAgICAgICAgICAgICA8YSBzdHlsZT1cInRleHQtYWxpZ246IHJpZ2h0O2ZvbnQtc2l6ZToxNHB4O3dpZHRoOjUwJTtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XCI+IiArIGxheWVyICsgIjwvYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBzdHlsZT1cImhlaWdodDogMjZweDt3aWR0aDoxMDAlXCI+XG4gICAgICAgICAgICAgIDxhIHN0eWxlPVwiY29sb3I6IzY0NjU2Njt3aWR0aDo0NSU7ZGlzcGxheTogaW5saW5lLWJsb2NrO1wiPlx1OTU3Rlx1NUVBNjo8L2E+XG4gICAgICAgICAgICAgIDxhIHN0eWxlPVwidGV4dC1hbGlnbjogcmlnaHQ7Zm9udC1zaXplOjE0cHg7d2lkdGg6NTAlO2Rpc3BsYXk6IGlubGluZS1ibG9jaztcIj4iICsgbGVuZ3RoICsgIjwvYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBzdHlsZT1cImhlaWdodDogMjZweDt3aWR0aDoxMDAlXCI+XG4gICAgICAgICAgICAgIDxhIHN0eWxlPVwiY29sb3I6IzY0NjU2Njt3aWR0aDo0NSU7ZGlzcGxheTogaW5saW5lLWJsb2NrO1wiPlx1OTAxQVx1ODg0Q1x1ODBGRFx1NTI5Qjo8L2E+XG4gICAgICAgICAgICAgIDxhIHN0eWxlPVwidGV4dC1hbGlnbjogcmlnaHQ7Zm9udC1zaXplOjE0cHg7d2lkdGg6NTAlO2Rpc3BsYXk6IGlubGluZS1ibG9jaztcIj4iICsgY2FwYWNpdHkgKyAiPC9hPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgPGRpdiBzdHlsZT1cImhlaWdodDogMjZweDt3aWR0aDoxMDAlXCI+XG4gICAgICAgICAgICAgIDxhIHN0eWxlPVwiY29sb3I6IzY0NjU2Njt3aWR0aDo0NSU7ZGlzcGxheTogaW5saW5lLWJsb2NrO1wiPlx1NjVCOVx1NTQxMTo8L2E+XG4gICAgICAgICAgICAgIDxhIHN0eWxlPVwidGV4dC1hbGlnbjogcmlnaHQ7Zm9udC1zaXplOjE0cHg7d2lkdGg6NTAlO2Rpc3BsYXk6IGlubGluZS1ibG9jaztcIj4iICsgZGlyICsgIjwvYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PiI7CiAgICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gdHJhbnNQb3BDb250ZW50OyAvLyDorr7nva7lvLnlh7rlsYLkvY3nva7ljbPlj6/lh7rnjrAKCiAgICAgIHRoaXMub3ZlcmxheS5zZXRQb3NpdGlvbihjb29yZGluYXRlKTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm8xJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICB9LAogICAgLy8g5riF6Zmk5by55Ye65qGGCiAgICByZW1vdmVQb3B1cDogZnVuY3Rpb24gcmVtb3ZlUG9wdXAoKSB7CiAgICAgIGlmICh0aGlzLm92ZXJsYXkpIHsKICAgICAgICAvLyDorr7nva7kvY3nva51bmRlZmluZWTlj6/ovr7liLDpmpDol4/muIXpmaTlvLnlh7rmoYYKICAgICAgICB0aGlzLm92ZXJsYXkuc2V0UG9zaXRpb24odW5kZWZpbmVkKTsKICAgICAgfQogICAgfSwKICAgIHJlbW92ZUJ0bjI6IGZ1bmN0aW9uIHJlbW92ZUJ0bjIoKSB7CiAgICAgIGlmICh0aGlzLm92ZXJsYXkpIHsKICAgICAgICAvLyDorr7nva7kvY3nva51bmRlZmluZWTlj6/ovr7liLDpmpDol4/muIXpmaTlvLnlh7rmoYYKICAgICAgICB0aGlzLm92ZXJsYXkuc2V0UG9zaXRpb24odW5kZWZpbmVkKTsKCiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cDInKS5zdHlsZS5kaXNwbGF5ID09ICdibG9jaycpIHsKICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cDInKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jbGVhckhpZ2hsaWdodCgpOyAvL+a4hemZpOWvuemdoumrmOS6rgoKICAgICAgICB0aGlzLiRiYXMuJGVtaXQoJ2NsZWFySGlnaGxpZ2h0X0wnLCAnMScpOwogICAgICB9CiAgICB9LAogICAgcGFyc2VGZWF0dXJlRGV0YWlsOiBmdW5jdGlvbiBwYXJzZUZlYXR1cmVEZXRhaWwoZmVhdHVyZVJlc3AsIGZlYXR1cmUpIHsKICAgICAgaWYgKCFmZWF0dXJlUmVzcCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIganNvbk9iaiA9IEpTT04ucGFyc2UoZmVhdHVyZVJlc3ApOwogICAgICB2YXIgZmVhdHVyZXMgPSBqc29uT2JqLmZlYXR1cmVzOwoKICAgICAgaWYgKGZlYXR1cmVzID09IG51bGwgfHwgZmVhdHVyZXMubGVuZ3RoID09IDApIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgdmFyIGNvbXBhaXJlRmVhdHVyZTsKCiAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZmVhdHVyZXMubGVuZ3RoOyBrKyspIHsKICAgICAgICB2YXIgcHJvcGVydGllcyA9IGZlYXR1cmVzW2tdLnByb3BlcnRpZXM7CiAgICAgICAgdmFyIGNvb3JkaW5hdGVzID0gZmVhdHVyZXNba10uY29vcmRpbmF0ZXM7CgogICAgICAgIGlmIChwcm9wZXJ0aWVzLmxheWVyID09IGZlYXR1cmUucHJvcGVydGllcy5sYXllciAmJiBmZWF0dXJlLnByb3BlcnRpZXMuaGFuZGxlID09IHByb3BlcnRpZXMuaGFuZGxlKSB7CiAgICAgICAgICBjb21wYWlyZUZlYXR1cmUgPSBmZWF0dXJlc1trXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGNvbXBhaXJlRmVhdHVyZTsKICAgIH0sCiAgICAvL+agueaNrumBk+i3r0lE5p+l6K+i5a+55q+U5pa55qGI6K+m5oOFCiAgICBhc3NlbWJsZUxlZnRDb21wYWlyZVBvcDogZnVuY3Rpb24gYXNzZW1ibGVMZWZ0Q29tcGFpcmVQb3AoZmVhdHVyZSwgdGhpc09iaiwgZXZ0KSB7CiAgICAgIGRlYnVnZ2VyOwogICAgICB2YXIgc2VsZWN0ZWRQbGFuZVZhbCA9IHRoaXNPYmoucmlnaHRTZWxlY3RlZFBsYW5lOyAvLyBpZiAoc2VsZWN0ZWRQbGFuZVZhbCA9PSBudWxsIHx8IHNlbGVjdGVkUGxhbmVWYWwgPT0gdW5kZWZpbmVkKSB7CiAgICAgIC8vICAgc2VsZWN0ZWRQbGFuZVZhbCA9IHRoaXMubGVmdFBsYW5lKzE7CiAgICAgIC8vIH0KCiAgICAgIHZhciBoYW5kbGUgPSBmZWF0dXJlLnByb3BlcnRpZXMuaGFuZGxlOwoKICAgICAgaWYgKGhhbmRsZSA9PSBudWxsKSB7CiAgICAgICAgdGhpc09iai5hZGRMZWZ0UG9wdXAoZXZ0LmNvb3JkaW5hdGUsIGZlYXR1cmUsIG51bGwpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHJpZ2h0TGF5ZXJOYW1lOwogICAgICBuZXdMaXN0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICBpZiAoaXRlbS52YWx1ZSA9PSBzZWxlY3RlZFBsYW5lVmFsKSB7CiAgICAgICAgICByaWdodExheWVyTmFtZSA9IGl0ZW0ubGF5ZXJOYW1lOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICBpZiAoIXJpZ2h0TGF5ZXJOYW1lKSB7CiAgICAgICAgdGhpc09iai5hZGRMZWZ0UG9wdXAoZXZ0LmNvb3JkaW5hdGUsIGZlYXR1cmUsIG51bGwpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHByb3BlcnR5TmFtZSA9ICdUZXN0OmhhbmRsZSc7CiAgICAgIHZhciByZXNwUHJvcGVydGllcyA9ICdsYXllcixoYW5kbGUsbGVuZ3RoLGNhcGFjaXR5LGFiX2Zsb3csYmFfZmxvdyx0b3RfZmxvdyxhYl92b2MsYmFfdm9jLG1heF92b2MsZ2VvbSc7CiAgICAgIHZhciB1cmwgPSBwcm9jZXNzLmVudi5WVUVfQVBQX0dJU19CQVNFX1VSTCArICcvd2ZzP3JlcXVlc3Q9R2V0RmVhdHVyZSZ2ZXJzaW9uPTEuMS4wJnR5cGVOYW1lPScgKyByaWdodExheWVyTmFtZSArICcmcHJvcGVydHlOYW1lPScgKyByZXNwUHJvcGVydGllcyArICcmb3V0cHV0Rm9ybWF0PUpTT04mRklMVEVSPTxGaWx0ZXIgeG1sbnM9Imh0dHA6Ly93d3cub3Blbmdpcy5uZXQvb2djIj48UHJvcGVydHlJc0VxdWFsVG8+PFByb3BlcnR5TmFtZT4nICsgcHJvcGVydHlOYW1lICsgJzwvUHJvcGVydHlOYW1lPjxMaXRlcmFsPicgKyBoYW5kbGUgKyAnPC9MaXRlcmFsPjwvUHJvcGVydHlJc0VxdWFsVG8+PC9GaWx0ZXI+JzsgLy/or7fmsYJ1cmzlr7nmr5TmlrnmoYjpgZPot6/or6bmg4UKCiAgICAgIGZldGNoKHVybCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICByZXR1cm4gcmVzcG9uc2UudGV4dCgpOwogICAgICB9KS50aGVuKGZ1bmN0aW9uIChpbmZvKSB7CiAgICAgICAgaWYgKGluZm8gIT0gbnVsbCkgewogICAgICAgICAgdmFyIGNvbXBhaXJlRmVhdHVyZSA9IHRoaXNPYmoucGFyc2VGZWF0dXJlRGV0YWlsKGluZm8sIGZlYXR1cmUpOwogICAgICAgICAgdGhpc09iai5hZGRMZWZ0UG9wdXAoZXZ0LmNvb3JkaW5hdGUsIGZlYXR1cmUsIGNvbXBhaXJlRmVhdHVyZSk7IC8v5by55Ye65Y+z6L655by55Ye65qGGCgogICAgICAgICAgdGhpc09iai4kZW1pdCgnYWRkUmlnaHRQb3B1cEJ5UGFyZW50JywgZXZ0LmNvb3JkaW5hdGUsIGNvbXBhaXJlRmVhdHVyZSwgZmVhdHVyZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXNPYmouYWRkTGVmdFBvcHVwKGV2dC5jb29yZGluYXRlLCBmZWF0dXJlLCBudWxsKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOm8oOagh+eCueWHu+WcsOWbvuS6i+S7tgogICAgbWFwQ2xpY2s6IGZ1bmN0aW9uIG1hcENsaWNrKGV2dCkgewogICAgICB2YXIgcGl4ZWwgPSB0aGlzLm1hcERhdGEuZ2V0RXZlbnRQaXhlbChldnQub3JpZ2luYWxFdmVudCk7CiAgICAgIHZhciBmZWF0dXJlID0gdGhpcy5tYXBEYXRhLmZvckVhY2hGZWF0dXJlQXRQaXhlbChwaXhlbCwgZnVuY3Rpb24gKGZlYXR1cmUsIGxheWVyKSB7CiAgICAgICAgcmV0dXJuIGZlYXR1cmU7CiAgICAgIH0pOwoKICAgICAgaWYgKGZlYXR1cmUpIHsKICAgICAgICAvL+aNleaNieWIsOimgee0oOWQju+8jOW8ueahhgogICAgICAgIHZhciBmZWF0dXJlQ29udmVydCA9ICgwLCBfY29tbW9uLmNvbnZlcnRGZWF0dXJlKShmZWF0dXJlKTsKICAgICAgICB0aGlzLmFkZEhpZ2hMaWdodFN0eWxlKGZlYXR1cmUsIHRoaXMsICcnKTsKICAgICAgICBkZWJ1Z2dlcjsKICAgICAgICB0aGlzLmFzc2VtYmxlTGVmdENvbXBhaXJlUG9wKGZlYXR1cmVDb252ZXJ0LCB0aGlzLCBldnQpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucmVtb3ZlQnRuMigpOwogICAgICB9CiAgICB9LAogICAgYWRkSGlnaExpZ2h0U3R5bGU6IGZ1bmN0aW9uIGFkZEhpZ2hMaWdodFN0eWxlKGNsaWNrRmVhdHVyZSwgdGhpc09iaiwgbnVtKSB7CiAgICAgIHZhciBmZWF0dXJlT2JqID0gW107CiAgICAgIGZlYXR1cmVPYmoucHVzaChjbGlja0ZlYXR1cmUpOwogICAgICB0aGlzLmNsZWFySGlnaGxpZ2h0KCk7CiAgICAgIHZhciBoaWdoTGlnaHRTdHlsZSA9IG5ldyBfc3R5bGUuU3R5bGUoewogICAgICAgIGZpbGw6IG5ldyBfc3R5bGUuRmlsbCh7CiAgICAgICAgICBjb2xvcjogIiNmZmZmMDAiCiAgICAgICAgfSksCiAgICAgICAgc3Ryb2tlOiBuZXcgX3N0eWxlLlN0cm9rZSh7CiAgICAgICAgICBjb2xvcjogIiNmZmZmMDAiLAogICAgICAgICAgd2lkdGg6IDgKICAgICAgICB9KQogICAgICB9KTsKICAgICAgdGhpc09iai5oaWdoTGlnaHRMYXllciA9IG5ldyBfVmVjdG9yMi5kZWZhdWx0KHsKICAgICAgICBuYW1lOiAiZGsiLAogICAgICAgIHNvdXJjZTogbmV3IF9WZWN0b3IuZGVmYXVsdCh7CiAgICAgICAgICBmZWF0dXJlczogZmVhdHVyZU9iagogICAgICAgIH0pLAogICAgICAgIHN0eWxlOiBmdW5jdGlvbiBzdHlsZShmZWF0dXJlLCBzb2x1dGlvbikgewogICAgICAgICAgcmV0dXJuIGhpZ2hMaWdodFN0eWxlOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHRoaXNPYmouaGlnaExpZ2h0TGF5ZXIuc2V0KCJpZCIsICJoaWdobGlnaHRMYXllciIpOwogICAgICB0aGlzLm1hcERhdGEuYWRkTGF5ZXIodGhpc09iai5oaWdoTGlnaHRMYXllcik7CgogICAgICBpZiAobnVtID09ICcnKSB7CiAgICAgICAgLy/lj7Povrnpq5jkuq4KICAgICAgICB0aGlzLiRiYXMuJGVtaXQoImFkZFJpZ2h0SGlnaExpZ2h0U3R5bGUiLCBjbGlja0ZlYXR1cmUsIHRoaXNPYmosICcxJyk7CiAgICAgIH0KICAgIH0sCiAgICAvL+WIoOmZpOmrmOS6ruWbvuWxggogICAgY2xlYXJIaWdobGlnaHQ6IGZ1bmN0aW9uIGNsZWFySGlnaGxpZ2h0KCkgewogICAgICB2YXIgYXJyID0gdGhpcy5tYXBEYXRhLmdldExheWVycygpLmFycmF5XzsKICAgICAgdmFyIGhpZ2hsaWdodExheWVyID0ge307CiAgICAgIGFyci5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0uZ2V0KCJpZCIpID09ICJoaWdobGlnaHRMYXllciIpIHsKICAgICAgICAgIGhpZ2hsaWdodExheWVyID0gaXRlbTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgaWYgKGhpZ2hsaWdodExheWVyICYmIGhpZ2hsaWdodExheWVyLmNsYXNzTmFtZV8pIHsKICAgICAgICB0aGlzLm1hcERhdGEucmVtb3ZlTGF5ZXIoaGlnaGxpZ2h0TGF5ZXIpOwogICAgICB9CiAgICB9CiAgfQp9OwpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA;AACA,oD,CACA;;AACAA;;AACA;AACA;AACA,mB,CACA;;AACA;EACAC,wEADA;EAEAC,WAFA;EAGAC,WAHA;EAIAC,UAJA,CAIA;;AAJA,G,CAQA;;AACA;EACAC;IACAC;EADA;AADA;eAOA;EACAC,IADA,kBACA;IACA;MACAC,iBADA;MAEAC,eACA;QAAAC;QAAAC;QAAAC;QAAAC;MAAA,CADA,EAEA;QAAAH;QAAAC;QAAAC;QAAAC;MAAA,CAFA,EAGA;QAAAH;QAAAC;QAAAC;QAAAC;MAAA,CAHA,EAIA;QAAAH;QAAAC;QAAAG;QAAAD;MAAA,CAJA,EAKA;QAAAH;QAAAC;QAAAG;QAAAD;MAAA,CALA,EAMA;QAAAH;QAAAC;QAAAG;QAAAD;MAAA,CANA,CAFA;MAUAE,aAVA;MAWAC,wBAXA;MAYAC,iBAZA;MAaAC,mBAbA;MAcAC,oBAdA;MAeAC;QACAC,aADA;QAEAC,sBAFA;QAGAC;MAHA,CAfA;MAoBAC;IApBA;EAsBA,CAxBA;EAyBAC,OAzBA,qBAyBA;IAAA;;IAEA;IACA,gDAHA,CAIA;;IACA;IAEA,eAPA,CAUA;;IACA;MACA;IACA,CAFA,EAXA,CAcA;;IACA;MACA;IACA,CAFA;IAIA;IACA;MACA;IACA,CAFA;IAIA;MACA;MACA;MACA;MACAC;MACA;QACA;MACA,CAFA;MAGAA;MACA;MACA;;MACA;IACA,CAZA,EAxBA,CAsCA;;IACA;MACA;QACA;QACA;QACAC;UACA1B,iBADA;UAEAG,UAFA;UAEA;UACAwB,mBAHA;UAIAC;QAJA;MAMA;IACA,CAXA,EAvCA,CAoDA;;IACA;MACA;QACA;QACA;QACAF;UACA1B,iBADA;UAEAG,UAFA;UAEA;UACAwB,mBAHA;UAIAC;QAJA;MAMA;IACA,CAXA;IAYAC,wDAjEA,CAkEA;;IACAC;MACAD;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;IACA,CATA,CAnEA,CA6EA;;;IACAC;MACAD;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;IACA,CATA;EAUA,CAjHA;EAkHAE;IAEA;IACAC,gBAHA,8BAGA;MACA;IACA,CALA;IAOAC,0BAPA,sCAOAC,SAPA,EAOAC,KAPA,EAOA;MACAD;MACAC;MACAA;QACA;MACA,CAFA;MAGAA;MACAA;MACA;IACA,CAhBA;IAkBAC,iBAlBA,+BAkBA;MAAA;;MACA;MACA;MACAC;MACA;QACA,wCADA,CAEA;;QACAC;UACA;YACAC,sBADA;YAEAC,YAFA;YAGAC,WAHA;YAIAC;UAJA;QAMA,CAPA,EAHA,CAWA;;QACAJ;UACAK;YACAC;cACAL,sBADA;cAEAC,YAFA;cAGAC,WAHA;cAIAC;YAJA;UAMA,CAPA;QAQA,CATA;QAUA;QACAR;QACA;QACA,iDAzBA,CA0BA;;QACA;MACA,CA5BA;IA6BA,CAnDA;IAsDA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAGA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEAW,cAhIA,0BAgIAC,CAhIA,EAgIA;MACAA;MACA;MACA;QACA;MACA,CAFA;MAGA;IACA,CAvIA;IA0IAC,cA1IA,0BA0IAC,MA1IA,EA0IAC,OA1IA,EA0IA;MACA;QACA;UACA;QACA;;QACA;UACA;UACA;QACA;;QACA;UACA;QACA,CAFA,MAEA;UACA;QACA;MACA,CAbA,CAaA;QACAxB;MACA;IAEA,CA5JA;IA+JAyB,gBA/JA,4BA+JAF,MA/JA,EA+JAC,OA/JA,EA+JAd,KA/JA,EA+JAgB,IA/JA,EA+JAC,OA/JA,EA+JAC,OA/JA,EA+JA;MACA;;MACA;QACA;MACA;;MACA;MACA;MACA;;MACA;QACA1B;MACA;;MACAwB;MACA;MACA;IACA,CA7KA;IAiLAG,kBAjLA,8BAiLAL,OAjLA,EAiLAd,KAjLA,EAiLAoB,MAjLA,EAiLA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MACA;QACAC;MACA;;MACA;QACAC;MACA;;MAEA;QACA;UACA;UACA;UACA;UACAC;QACA;;QACA;UACA;;UACA;;UACA;UACAA;QACA;MAEA;;MACA;IACA,CAhNA;IAmNAC,eAnNA,2BAmNAC,UAnNA,EAmNAC,OAnNA,EAmNAV,IAnNA,EAmNAW,OAnNA,EAmNAT,OAnNA,EAmNAU,KAnNA,EAmNA;MAAA;;MACA;MACA;QACAC,mBADA;QAEAC,sBAFA;QAGAC,wBAHA;QAIAf;MAJA,wDAKA,QALA,mDAMAW,OANA,mDAOAT,OAPA,gDAQA;QACAU;MADA,EARA,oDAWAF,OAXA;MAaA;QACAM;MADA;MAGAC;MACAC;MACA;IACA,CAxOA;IA0OAC,iBA1OA,6BA0OArB,OA1OA,EA0OA;MACA;MACA;MACA;;MACA;QACAc;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA;;MACA;IACA,CAhQA;IAoQAQ,cApQA,0BAoQAtB,OApQA,EAoQA;MACA;MACA;MACA,gBAHA,CAIA;;MACA,6BALA,CAMA;;MACA,uCAPA,CAQA;;MACA,4CATA,CAUA;;MACA;MAEA;;MACA;QACAuB;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA;;MACAd,YACA;QACAe;UACAV,YADA;UAEAS;QAFA;MADA,EADA,EArBA,CA6BA;MACA;MACA;MAEA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MACA;IACA,CAzTA;IA2TAE,eA3TA,6BA2TA;MAAA;;MACA;QAAA;MAAA,GADA,CAEA;;MACA;MACA;MACAC,oCALA,CAMA;;MACA;;MACAC;QACA;QACA;UACAC;YAAAC;YAAAC;UAAA;QADA;QAGAC;UACA5E,oBADA;UAEAe;YACA,2CADA,CAEA;;YACA;;YACA;cACA;cACA;;cACA;gBACAuC;cACA;YACA;;YACA;UACA;QAdA;QAiBAsB;MACA,CAvBA;IAwBA,CA3VA;IA6VAC,eA7VA,6BA6VA;MACA;MACA;MACA;IACA,CAjWA;IAmWAC,WAnWA,yBAmWA;MACA;MACA;MACA,sFAHA,CAIA;MACA;IAEA,CA1WA;IA4WAC,YA5WA,wBA4WAhD,KA5WA,EA4WAoB,MA5WA,EA4WA;MACApB;QACA;QACA;QACA;;QACA;UACAuB;QACA;;QACA;UACAA;QACA;;QACA;MACA,CAXA;IAaA,CA1XA;IA4XA0B,YA5XA,wBA4XAjD,KA5XA,EA4XA;MACA;QACAA;QACAA;UACA;UACA;;UACA;YACAuB;UACA;;UACA;QACA,CAPA;MAQA;IAEA,CAzYA;IA4YA2B,gCA5YA,8CA4YA;MACA,iBADA,CAEA;;MACA;QACA;QACA;MACA,CANA,CAOA;;;MACA;QACA;QACA;MACA;IACA,CAxZA;IA0ZA;IACAC,OA3ZA,qBA2ZA;MACA,kCADA,CAEA;;MACA;QACAC,uBADA;QAEAC,oBAFA;QAGA9D;MAHA,GAHA,CAQA;;MACAH,4CATA,CAUA;;MACAA,+BAXA,CAYA;;MACAA,oCAbA,CAcA;;MACA,mBAfA,CAgBA;;MACA;IACA,CA7aA;IA+aAkE,eA/aA,6BA+aA;MACA;MACA;MACA;MACA;IACA,CApbA;IAsbA;IACAC,0BAvbA,sCAubAzC,OAvbA,EAubA0C,eAvbA,EAubAC,KAvbA,EAubA;MACA;;MACA;QACAC;MACA;;MACA;;MACA;;MACA;MAKA;QACA;;QACA;UACA;UACA,wBAFA,CAGA;;UACA;YACAC;UACA;;UACA;YACAA;UACA,CATA,CAUA;;;UACA;;UACA;YACAA;UACA;QACA,CAfA,MAeA;UACAA;QACA;;QACAC,kJACAC,aADA,kHAEAF,OAFA;;QAGA;UACAC;QACA,CAFA,MAEA;UACAA;QACA;;QACAA;MAIA,CAhCA;MAiCAA;MACA;IACA,CAteA;IA0eA;IACAE,YA3eA,wBA2eArC,UA3eA,EA2eAX,OA3eA,EA2eA0C,eA3eA,EA2eA;MACA,mBADA,CAEA;;MACA;MACA;;MACA,mBACA,CADA,MACA;QACA;QACA;UACAK;QADA,GAFA,CAKA;;QACA;MACA,CAbA,CAcA;;;MACA;MACA;MACA;MACA,iGAlBA,CAmBA;;MACA,+HApBA,CAqBA;;MACA;MAEAE,mXAKAC,MALA,iRASAP,KATA,iRAaAQ,MAbA,6RAiBAC,QAjBA,kRAqBAC,GArBA;MAwBAP,oCAhDA,CAiDA;;MACA;MACAlE;MACAA;IACA,CAhiBA;IAkiBA;IACA0E,WAniBA,yBAmiBA;MACA;QACA;QACA;MACA;IACA,CAxiBA;IAyiBAC,UAziBA,wBAyiBA;MACA;QACA;QACA;;QAEA;UACA3E;QACA;;QACA,sBAPA,CAQA;;QACA;MACA;IACA,CArjBA;IAsjBA4E,kBAtjBA,8BAsjBAC,WAtjBA,EAsjBAzD,OAtjBA,EAsjBA;MACA;QACA;MACA;;MACA;MACA;;MACA;QACA;MACA;;MACA;;MACA;QACA;QACA;;QACA,oDACAA,8CADA,EACA;UACA0C;UACA;QACA;MACA;;MACA;IAEA,CA3kBA;IA6kBA;IACAgB,uBA9kBA,mCA8kBA1D,OA9kBA,EA8kBA2D,OA9kBA,EA8kBAC,GA9kBA,EA8kBA;MACA;MACA,kDAFA,CAGA;MACA;MACA;;MACA;;MACA;QACAD;QACA;MACA;;MACA;MACAhE;QACA;UACAkE;QACA;MACA,CAJA;;MAKA;QACAF;QACA;MACA;;MACA;MACA;MACA,iGACAE,cADA,GACA,gBADA,GACAC,cADA,GACA,wGADA,GAEAC,YAFA,GAEA,0BAFA,GAEAb,MAFA,GAEA,yCAFA,CAvBA,CA0BA;;MACAc,WACAC,IADA,CACA;QACA;MACA,CAHA,EAIAA,IAJA,CAIA;QACA;UAEA;UACAN,+DAHA,CAIA;;UACAA;QACA,CANA,MAMA;UACAA;QACA;MACA,CAdA;IAiBA,CA1nBA;IA4nBA;IACAO,QA7nBA,oBA6nBAN,GA7nBA,EA6nBA;MACA;MACA,wDACA;QACA;MACA,CAHA;;MAIA;QACA;QACA;QACA;QACA;QACA;MAEA,CAPA,MAOA;QACA;MACA;IAEA,CA9oBA;IA+oBAO,iBA/oBA,6BA+oBAC,YA/oBA,EA+oBAT,OA/oBA,EA+oBAU,GA/oBA,EA+oBA;MACA;MACAC;MACA;MACA;QACAC;UACAzD;QADA,EADA;QAIAU;UACAV,gBADA;UAEAS;QAFA;MAJA;MASAoC;QACApE,UADA;QAEApC;UACAyE;QADA,EAFA;QAKA1D;UACA;QACA;MAPA;MASAyF;MACA;;MACA;QACA;QACA;MACA;IACA,CA3qBA;IA4qBA;IACAa,cA7qBA,4BA6qBA;MACA;MACA;MACAC;QACA;UACAC;QACA;MACA,CAJA;;MAKA;QACA;MACA;IACA;EAxrBA;AAlHA,C","names":["proj4","center","minZoom","maxZoom","zoom","source","url","data","leftPlaneList","popTransList","label","propertie","unit","type","maxlength","leftPlane","rightSelectedPlane","vectorLayer","zoomThreshold","initStyleFlag","style","line_width","line_stroke","interval","map","mounted","console","view","rotation","duration","document","window","methods","addMarkTextLayer","changeCompareItemByBizType","parentVal","this_","initComponentInfo","param","responseData","layerName","name","value","bizVal","ss","newList","getPointExtent","n","getMiddlePoint","coords","feature","iniFlowOrVocText","text","offsetX","offsety","initFlowOrVocPoint","isFlow","ab_text","ba_text","styles","createTextStyle","coordinate","roation","offsetx","color","textAlign","textBaseline","font","geometry","style_","styles_","getColorByFeature","getPointsStyle","width","stroke","initVectorLayer","$map","axios","features","featureProjection","dataProjection","$this","leftPointerdrag","leftMovvend","showFlowText","hideFlowText","changeFlowTextStyleByCurrentZoom","initMap","layers","target","leftPlaneChange","assebleLeftTransPopContent","compaireFeature","layer","compaireResult","propVal","content","element","addLeftPopup","transPopContent","handle","length","capacity","dir","removePopup","removeBtn2","parseFeatureDetail","featureResp","assembleLeftCompairePop","thisObj","evt","rightLayerName","respProperties","propertyName","fetch","then","mapClick","addHighLightStyle","clickFeature","num","featureObj","fill","clearHighlight","arr","highlightLayer"],"sourceRoot":"src/views/traffic-decision/components","sources":["tab2-left.vue"],"sourcesContent":["<template>\r\n  <div class=\"content\">\r\n    <!--  -->\r\n    <div class=\"select-div\">\r\n      <div class=\"select-title\">左侧方案</div>\r\n      <div>\r\n        <el-select\r\n          v-model=\"leftPlane\"\r\n          placeholder=\"请选择\"\r\n          @change=\"leftPlaneChange\"\r\n        >\r\n          <el-option\r\n            v-for=\"item in leftPlaneList\"\r\n            :key=\"item.key\"\r\n            :label=\"item.name\"\r\n            :value=\"item.value\"\r\n          >\r\n          </el-option>\r\n        </el-select>\r\n      </div>\r\n    </div>\r\n    <div id=\"map\" ref=\"map\" style=\"width: 100%; height: 890px\">\r\n      <!--点击查看详情弹框-->\r\n      <div id=\"popup\" class=\"ol-popup2\">\r\n        <a\r\n          href=\"#\"\r\n          id=\"popup-closer\"\r\n          class=\"ol-popup-closer2\"\r\n          @click=\"removeBtn2\"\r\n        />\r\n        <div id=\"popup-content\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport 'ol/ol.css'\r\nimport Map from 'ol/Map'\r\nimport * as olControl from 'ol/control'\r\nimport View from 'ol/View'\r\nimport { getWidth, getCenter } from 'ol/extent'\r\nimport TileLayer from 'ol/layer/Tile'\r\nimport WMTS from 'ol/source/WMTS'\r\nimport XYZ from 'ol/source/XYZ'\r\nimport WMTSTileGrid from 'ol/tilegrid/WMTS'\r\nimport Projection from 'ol/proj/Projection'\r\nimport proj4 from 'proj4'\r\nimport { register } from 'ol/proj/proj4';\r\nimport VectorSource from 'ol/source/Vector'\r\nimport { TileWMS } from 'ol/source'\r\nimport VectorLayer from 'ol/layer/Vector'\r\nimport Feature from 'ol/Feature'\r\nimport { Draw } from 'ol/interaction'\r\nimport { Style, Circle, Stroke, Fill, Icon, IconImage, Image, Text } from 'ol/src/style'\r\nimport WKT from 'ol/format/WKT'\r\nimport GeoJSON from 'ol/format/GeoJSON'\r\nimport Overlay from 'ol/Overlay'\r\nimport * as echarts from \"echarts\";\r\nimport axios from 'axios'\r\nimport request from '@/utils/request'\r\nimport tab2RightVue from './tab2-right.vue'\r\nimport { formatFixNum, convertFeature } from \"@/api/common/common\";\r\nimport { featureCompaire } from \"@/api/decision/plane\";\r\nimport * as turf from '@turf/turf';\r\nimport Point from 'ol/geom/Point';\r\nimport { fromLonLat, toLonLat, transformExtent, transform } from 'ol/proj'\r\nimport LineString from 'ol/geom/LineString';\r\nimport MultiLineString from 'ol/geom/MultiLineString';\r\nimport { findComponentInfo } from \"@/api/config/component\";\r\nimport { getUrlKey } from '@/utils/request'\r\nimport { getArea, getLength } from 'ol/sphere';\r\nimport { initTreeList } from \"@/api/decision-manage/decision\";\r\n\r\n\r\n\r\n//中心坐标\r\nconst centerCordinate = [656813.44256, 3560432.98245]\r\n//坐标定义\r\nproj4.defs(\"EPSG:4548\", \"+proj=tmerc +lat_0=0 +lon_0=117 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs\");\r\nregister(proj4);\r\nlet newList = []\r\nlet parentVal=''\r\n//地图初始化\r\nconst view = new View({\r\n  center: transform(centerCordinate, 'EPSG:4548', 'EPSG:3857'),\r\n  minZoom: 10,\r\n  maxZoom: 18,\r\n  zoom: 13.5// 地图初始化的缩放级别\r\n})\r\n\r\n\r\n//高德地图图层\r\nconst gaodeMapLayer = new TileLayer({\r\n  source: new XYZ({\r\n    url: 'http://webst0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scl=2&style=7&x={x}&y={y}&z={z}'\r\n  })\r\n});\r\n\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      leftPlaneList: [],\r\n      popTransList: [\r\n        { label: 'AB交通量', propertie: 'ab_flow', unit: 'pcu/h', type: 'int' },\r\n        { label: 'BA交通量', propertie: 'ba_flow', unit: 'pcu/h', type: 'int' },\r\n        { label: '总交通量', propertie: 'tot_flow', unit: 'pcu/h', type: 'int' },\r\n        { label: 'AB饱和度', propertie: 'ab_voc', maxlength: 2, type: 'float' },\r\n        { label: 'BA饱和度', propertie: 'ba_voc', maxlength: 2, type: 'float' },\r\n        { label: '最大饱和度', propertie: 'max_voc', maxlength: 2, type: 'float' },\r\n      ],\r\n      leftPlane: '',\r\n      rightSelectedPlane: null,\r\n      vectorLayer: null,\r\n      zoomThreshold: 15.7,\r\n      initStyleFlag: false,\r\n      style: {\r\n        line_width: 3,\r\n        line_stroke: '#459c50',\r\n        interval: 40\r\n      },\r\n      map: null\r\n    }\r\n  },\r\n  mounted () {\r\n\r\n    //获取菜单ID\r\n    this.menuId = getUrlKey('menuId');\r\n    //根据菜单ID查询组件信息\r\n    this.initComponentInfo();\r\n\r\n    this.initMap();\r\n\r\n\r\n    // 高亮\r\n    this.$bas.$on(\"addLeftHighLightStyle\", (i, j, num) => {\r\n      this.addHighLightStyle(i, j, num)\r\n    })\r\n    //清除高亮\r\n    this.$bas.$on(\"clearHighlight_Y\", (i) => {\r\n      this.clearHighlight()\r\n    })\r\n\r\n    this.leftPlaneList = newList;\r\n    this.leftPlaneList = this.leftPlaneList.filter((item) => {\r\n      return item.bizVal == parentVal\r\n    })\r\n\r\n    this.$bas.$on(\"rightPlaneChange\", (i) => {\r\n      this.leftPlaneList = JSON.parse(JSON.stringify(newList));\r\n      this.rightSelectedPlane = i;\r\n      debugger\r\n      console.log(parentVal)\r\n      this.leftPlaneList = this.leftPlaneList.filter((item) => {\r\n        return item.value != i && item.bizVal == parentVal\r\n      })\r\n      console.log(this.leftPlaneList);\r\n      this.leftPlane = this.leftPlaneList[0].value\r\n      this.rightSelectedPlane=i\r\n      this.initVectorLayer()\r\n    })\r\n\r\n    //拖动监听方法\r\n    this.$bas.$on(\"rightPanelDrageChange\", (cordinate, zoom) => {\r\n      if (cordinate && zoom) {\r\n        this.leftCurrentCordinate = cordinate;\r\n        this.leftCurrentZoom = zoom;\r\n        view.animate({\r\n          center: cordinate,\r\n          zoom: zoom, // 缩放级别\r\n          rotation: undefined,\r\n          duration: 10\r\n        })\r\n      }\r\n    })\r\n\r\n    //缩放监听\r\n    this.$bas.$on(\"rightMovvendChange\", (cordinate, zoom) => {\r\n      if (cordinate && zoom) {\r\n        this.leftCurrentCordinate = cordinate;\r\n        this.leftCurrentZoom = zoom;\r\n        view.animate({\r\n          center: cordinate,\r\n          zoom: zoom, // 缩放级别\r\n          rotation: undefined,\r\n          duration: 10\r\n        })\r\n      }\r\n    })\r\n    document.getElementById('popup').style.display = 'none';\r\n    //交通信息点击按钮\r\n    window.preview1 = function () {\r\n      document.getElementById('info2').style.display = 'block';\r\n      document.getElementById('info1').style.display = 'none';\r\n      document.getElementById('btn1').style.background = '#004AB3';\r\n      document.getElementById('btn2').style.background = '#D3D6DB';\r\n      document.getElementById('info4').style.display = 'block';\r\n      document.getElementById('info3').style.display = 'none';\r\n      document.getElementById('btn3').style.background = '#004AB3';\r\n      document.getElementById('btn4').style.background = '#D3D6DB';\r\n    }\r\n    //基本信息点击按钮\r\n    window.preview2 = function () {\r\n      document.getElementById('info2').style.display = 'none';\r\n      document.getElementById('info1').style.display = 'block';\r\n      document.getElementById('btn2').style.background = '#004AB3';\r\n      document.getElementById('btn1').style.backgroundColor = '#D3D6DB';\r\n      document.getElementById('info4').style.display = 'none';\r\n      document.getElementById('info3').style.display = 'block';\r\n      document.getElementById('btn4').style.background = '#004AB3';\r\n      document.getElementById('btn3').style.backgroundColor = '#D3D6DB';\r\n    }\r\n  },\r\n  methods: {\r\n\r\n    //添加路段文字标注\r\n    addMarkTextLayer () {\r\n      this.$emit('aquirePointMarkData', this.mapData);\r\n    },\r\n\r\n    changeCompareItemByBizType (parentVal, this_) {\r\n      parentVal=parentVal\r\n      this_.leftPlaneList = JSON.parse(JSON.stringify(newList));\r\n      this_.leftPlaneList = this_.leftPlaneList.filter((item) => {\r\n        return item.bizVal == parentVal\r\n      })\r\n      this_.leftPlane = this_.leftPlaneList[0].value\r\n      this_.initVectorLayer()\r\n      return this_.leftPlane;\r\n    },\r\n\r\n    initComponentInfo () {\r\n      let param = {};\r\n      this.options=[]\r\n      param.bizKey = 'plane_compare'\r\n      initTreeList(param).then(res=> {\r\n        let responseData = res.data[0].children;\r\n        //初始化页面选择默认第一个\r\n        responseData[0].children.forEach(s=>{\r\n          this.leftPlaneList.push({\r\n            layerName: s.layerName,\r\n            name:s.name, \r\n            value: s.id,\r\n            bizVal: s.parentId\r\n          })\r\n        })\r\n        //newlist 获取全部的数据 筛选用\r\n        responseData.forEach(ss=>{\r\n          ss.children.forEach(r=>{\r\n            newList.push({\r\n            layerName: r.layerName,\r\n            name:r.name, \r\n            value: r.id,\r\n            bizVal: r.parentId,\r\n          })\r\n        })\r\n        })\r\n        debugger\r\n      parentVal=responseData[0].id\r\n      this.rightSelectedPlane=this.leftPlaneList[1].value\r\n      this.leftPlane=this.leftPlaneList[0].value\r\n      // 初始化图层\r\n      this.initVectorLayer();\r\n      });\r\n    },\r\n\r\n\r\n    // getPointsByLine (coords, dir) {\r\n    //   let this_ = this;\r\n    //   let styles = [];\r\n    //   let distance_ = this_.style.interval / 2;//首个点放置在距离起点1/2间隔的位置\r\n    //   let pix_start = this_.mapData.getPixelFromCoordinate(coords[0])\r\n    //   let pix_end\r\n    //   for (let i = 1; i < coords.length; i++) {\r\n    //     let coord_, coord_pix;\r\n    //     let style_;\r\n    //     pix_end = this_.mapData.getPixelFromCoordinate(coords[i]);\r\n    //     let dis_start2end = Math.sqrt(Math.pow((pix_start[0] - pix_end[0]), 2) + Math.pow((pix_start[1] - pix_end[1]), 2)) // 计算收尾在屏幕上的距离\r\n    //     if (dis_start2end > distance_) { // 距离大于间隔\r\n    //       // 计算距离开始点位的像素值\r\n    //       coord_pix = [\r\n    //         (distance_ * (pix_end[0] - pix_start[0])) / dis_start2end + pix_start[0],\r\n    //         (distance_ * (pix_end[1] - pix_start[1])) / dis_start2end + pix_start[1]\r\n    //       ];\r\n    //       // 计算经纬度\r\n    //       coord_ = this_.mapData.getCoordinateFromPixel(coord_pix);\r\n    //       var rotation = Math.PI / 2 + Math.atan2(pix_end[1] - pix_start[1], pix_end[0] - pix_start[0]);\r\n    //       if (dir == -1) {\r\n    //         rotation = rotation + Math.PI\r\n    //       }\r\n    //       // 生成样式\r\n    //       style_ = new Style({\r\n    //         // 箭头点的位置\r\n    //         geometry: new Point(coord_),\r\n    //       })\r\n    //       //  if (dir != 0) {\r\n    //       // 箭头点的样式\r\n    //       let image = new Icon({\r\n    //         src: require('@/assets/images/juece/up10-10.png'),\r\n    //         rotateWithView: true,\r\n    //         rotation: rotation,\r\n    //         scale: this.style.line_width / 5,\r\n    //         imgSize: [10, 10]\r\n    //       })\r\n    //       style_.setImage(image);\r\n    //       // }\r\n\r\n\r\n    //       //下次循环开始点为当前点\r\n    //       pix_start = coord_pix;\r\n    //       distance_ = this_.style.interval;\r\n    //       i--;\r\n    //     } else if (dis_start2end == distance_) {// 距离等于间隔\r\n    //       var rotation = Math.PI / 2 + Math.atan2(pix_end[1] - pix_start[1], pix_end[0] - pix_start[0])\r\n    //       if (dir == -1) {\r\n    //         rotation = rotation + Math.PI\r\n    //       }\r\n    //       // 生成样式\r\n    //       style_ = new Style({\r\n    //         // 箭头点的位置\r\n    //         geometry: new Point(coords[i]),\r\n    //         // 箭头点的样式\r\n    //         image: new Icon({\r\n    //           src: require('@/assets/images/juece/up10-10.png'),\r\n    //           rotateWithView: true,\r\n    //           rotation: rotation,\r\n    //           scale: this.style.line_width / 5,\r\n    //           imgSize: [10, 10]\r\n    //         })\r\n    //       })\r\n    //       pix_start = pix_end;\r\n    //       distance_ = this_.style.interval;\r\n    //     } else {//距离小于间隔\r\n    //       distance_ = distance_ - dis_start2end;\r\n    //       pix_start = pix_end;\r\n    //     }\r\n    //     style_ && styles.push(style_)\r\n    //   }\r\n    //   return styles\r\n    // },\r\n\r\n    getPointExtent (n) {\r\n      n = n ? n : 1.2;\r\n      let view = this.mapData.getView();\r\n      let mapsize = this.mapData.getSize().map(it_ => {\r\n        return it_ * n\r\n      });\r\n      return view.calculateExtent(mapsize);\r\n    },\r\n\r\n\r\n    getMiddlePoint (coords, feature) {\r\n      try {\r\n        if (coords == null || coords.length == 0 || coords == undefined) {\r\n          return null;\r\n        }\r\n        if (coords.length <= 3) {\r\n          var point_features = turf.points(feature.getGeometry().getCoordinates()[0]);\r\n          return new Point(turf.center(point_features).geometry.coordinates);\r\n        }\r\n        if (coords.length % 2 == 0) {\r\n          return new Point(coords[coords.length / 2])\r\n        } else {\r\n          return new Point(coords[Math.ceil(coords.length / 2)])\r\n        }\r\n      } catch (err) {\r\n        console.log(err)\r\n      }\r\n\r\n    },\r\n\r\n\r\n    iniFlowOrVocText (coords, feature, this_, text, offsetX, offsety) {\r\n      let centerPoint = this.getMiddlePoint(coords, feature);\r\n      if (!centerPoint) {\r\n        return null;\r\n      }\r\n      let pix_start = this_.mapData.getPixelFromCoordinate(coords[0])\r\n      let pix_end = this_.mapData.getPixelFromCoordinate(centerPoint.flatCoordinates);\r\n      var rotation = Math.PI + Math.atan2(pix_end[1] - pix_start[1], pix_end[0] - pix_start[0]);\r\n      if (pix_end[0] > pix_start[0]) {\r\n        rotation = rotation + Math.PI\r\n      }\r\n      text = text + \"\";\r\n      let color = this_.getColorByFeature(feature);\r\n      return this.createTextStyle(centerPoint, rotation, text, offsetX, offsety, color);\r\n    },\r\n\r\n\r\n\r\n    initFlowOrVocPoint (feature, this_, isFlow) {\r\n      let coords = feature.getGeometry().getCoordinates();\r\n      let styles = [];\r\n      let extent_ = this_.getPointExtent();\r\n      let line_ = turf.multiLineString(coords);\r\n      let line_clip_arr = turf.bboxClip(line_, extent_)\r\n      let ab_text = isFlow ? feature.get(\"ab_flow\") : feature.get(\"ab_voc\");\r\n      let ba_text = isFlow ? feature.get(\"ba_flow\") : feature.get(\"ba_voc\");\r\n      if (ab_text != null && ab_text != '') {\r\n        ab_text = isFlow ? Math.floor(ab_text) : formatFixNum(ab_text, 2);\r\n      }\r\n      if (ba_text != null && ba_text != '') {\r\n        ba_text = isFlow ? Math.floor(ba_text) : formatFixNum(ba_text, 2);\r\n      }\r\n\r\n      if (line_clip_arr.geometry.type == \"LineString\") {\r\n        if (ab_text != null && ab_text != '') {\r\n          let offsetX = 15;\r\n          let offsety = 15;\r\n          let style_ab = this_.iniFlowOrVocText(line_clip_arr.geometry.coordinates, feature, this_, ab_text, offsetX, offsety);\r\n          styles = styles.concat(style_ab)\r\n        }\r\n        if (ba_text != null && ba_text != '') {\r\n          let offsetX = -15;\r\n          let offsety = -15;\r\n          let style_ba = this_.iniFlowOrVocText(line_clip_arr.geometry.coordinates, feature, this_, ba_text, offsetX, offsety);\r\n          styles = styles.concat(style_ba)\r\n        }\r\n\r\n      }\r\n      return styles;\r\n    },\r\n\r\n\r\n    createTextStyle (coordinate, roation, text, offsetx, offsety, color) {\r\n      let styles_ = [];\r\n      let text_ = new Text({\r\n        textAlign: 'center',\r\n        textBaseline: 'middle',\r\n        font: 'normal 15px 微软雅黑',\r\n        text: text,\r\n        textBaseline: \"middle\", //文本基线\r\n        offsetY: offsetx,\r\n        offsetX: offsety,\r\n        fill: new Fill({\r\n          color: color\r\n        }),\r\n        rotation: roation,\r\n      })\r\n      let style_ = new Style({\r\n        geometry: coordinate,\r\n      })\r\n      style_.setText(text_)\r\n      styles_.push(style_)\r\n      return styles_;\r\n    },\r\n\r\n    getColorByFeature (feature) {\r\n      // 饱和度\r\n      var max_voc = feature.get(\"max_voc\");\r\n      var color = this.style.line_stroke;\r\n      if (max_voc > 0 && max_voc <= 0.25) {\r\n        color = '#185817';\r\n      } else if (max_voc > 0.25 && max_voc <= 0.5) {\r\n        color = '#61a43a';\r\n      } else if (max_voc > 0.5 && max_voc <= 0.75) {\r\n        color = '#cfe05d';\r\n      } else if (max_voc > 0.75 && max_voc <= 1) {\r\n        color = '#d8c964';\r\n      } else if (max_voc > 1 && max_voc <= 1.25) {\r\n        color = '#d79550';\r\n      } else if (max_voc > 1.25 && max_voc <= 1.5) {\r\n        color = '#c75b41';\r\n      } else if (max_voc > 1.5 && max_voc <= 1.75) {\r\n        color = '#c75b41';\r\n      } else if (max_voc > 1.75) {\r\n        color = '#000000';\r\n      }\r\n      return color;\r\n    },\r\n\r\n\r\n\r\n    getPointsStyle (feature) {\r\n      let coords = feature.getGeometry().getCoordinates();\r\n      let this_ = this;\r\n      let styles = [];\r\n      // 方向（1单向，-1反向单向，0双向）\r\n      var dir = feature.get(\"dir\");\r\n      // 流量\r\n      var tot_flow = feature.get(\"tot_flow\");\r\n      // 颜色默认值\r\n      var color = this.getColorByFeature(feature);\r\n      // 粗细默认值\r\n      var width = this_.style.line_width;\r\n\r\n      var pec = 2;\r\n      if (tot_flow > 0 && tot_flow <= 1250) {\r\n        width = 1 * pec;\r\n      } else if (tot_flow > 1250 && tot_flow <= 2500) {\r\n        width = 2 * pec;\r\n      } else if (tot_flow >= 2500) {\r\n        width = 4 * pec;\r\n      }\r\n      styles.push(\r\n        new Style({\r\n          stroke: new Stroke({\r\n            color: color,\r\n            width: width,\r\n          }),\r\n        })\r\n      )\r\n      // let extent_ = this.getPointExtent();\r\n      // let line_ = turf.multiLineString(coords);\r\n      // let line_clip_arr = turf.bboxClip(line_, extent_)\r\n\r\n      // if (line_clip_arr && line_clip_arr.geometry) {\r\n      //   if (line_clip_arr.geometry.type == \"LineString\") {\r\n      //     let style_ = this_.getPointsByLine(line_clip_arr.geometry.coordinates, dir);\r\n      //     if (style_ instanceof Array) {\r\n      //       styles = styles.concat(style_)\r\n      //     } else {\r\n      //       styles.push(style_)\r\n      //     }\r\n      //   } else if (line_clip_arr.geometry.type == \"MultiLineString\") {\r\n      //     line_clip_arr.geometry.coordinates.forEach(coords => {\r\n      //       let style_ = this_.getPointsByLine(coords, dir)\r\n      //       if (style_ instanceof Array) {\r\n      //         styles = styles.concat(style_)\r\n      //       } else {\r\n      //         styles.push(style_)\r\n      //       }\r\n      //     })\r\n      //   }\r\n      // }\r\n      return styles\r\n    },\r\n\r\n    initVectorLayer () {\r\n      let planeInfo = this.leftPlaneList.find(item => item.value == this.leftPlane)\r\n      // 初始化拿到公共数据\r\n      var $map = this.mapData;\r\n      var $this = this;\r\n      $map.removeLayer($this.vectorLayer);\r\n      // 请求数据\r\n      var url = process.env.VUE_APP_GIS_BASE_URL + '/Test/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=' + encodeURI(planeInfo.layerName) + '&maxFeatures=500000000&outputFormat=application%2Fjson';\r\n      axios.get(url, null).then(function (res) {\r\n        var featuresData = res.data;\r\n        var vectorSource = new VectorSource({\r\n          features: (new GeoJSON({ featureProjection: 'EPSG:3857', dataProjection: 'EPSG:4548' })).readFeatures(featuresData)\r\n        });\r\n        $this.vectorLayer = new VectorLayer({\r\n          source: vectorSource,\r\n          style: (feature, solution) => {\r\n            let styles = $this.getPointsStyle(feature);\r\n            //根据文字控制按钮新增文字样式\r\n            let activeBtn = $this.$parent.$parent.$parent.activeBtn;\r\n            if (activeBtn != '' && activeBtn != 3) {\r\n              let isFlow = activeBtn == 3;\r\n              let flowStyle = $this.initFlowOrVocPoint(feature, $this, isFlow)\r\n              if (flowStyle != null) {\r\n                styles = styles.concat(flowStyle);\r\n              }\r\n            }\r\n            return styles\r\n          }\r\n        })\r\n\r\n        $this.mapData.addLayer($this.vectorLayer);\r\n      });\r\n    },\r\n\r\n    leftPointerdrag () {\r\n      this.leftCurrentCordinate = view.getCenter();\r\n      this.leftCurrentZoom = view.getZoom()\r\n      this.$bas.$emit(\"leftPanelDrageChange\", this.leftCurrentCordinate, this.leftCurrentZoom)\r\n    },\r\n\r\n    leftMovvend () {\r\n      this.leftCurrentCordinate = view.getCenter();\r\n      this.leftCurrentZoom = view.getZoom()\r\n      this.$bas.$emit(\"leftMovvendChange\", this.leftCurrentCordinate, this.leftCurrentZoom)\r\n      //根据缩放级别改变流量文字样式\r\n      //this.changeFlowTextStyleByCurrentZoom();\r\n\r\n    },\r\n\r\n    showFlowText (this_, isFlow) {\r\n      this_.vectorLayer.setStyle((feature, solution) => {\r\n        let styles = [];\r\n        let pointArrowStyle = this_.getPointsStyle(feature);\r\n        let flowStyle = this_.initFlowOrVocPoint(feature, this_, isFlow)\r\n        if (pointArrowStyle != null && pointArrowStyle.length > 0) {\r\n          styles = styles.concat(pointArrowStyle)\r\n        }\r\n        if (flowStyle != null && flowStyle.length > 0) {\r\n          styles = styles.concat(flowStyle)\r\n        }\r\n        return styles;\r\n      })\r\n\r\n    },\r\n\r\n    hideFlowText (this_) {\r\n      if (this_.vectorLayer) {\r\n        this_.vectorLayer.setStyle(null);\r\n        this_.vectorLayer.setStyle((feature, solution) => {\r\n          let styles = [];\r\n          let pointArrowStyle = this_.getPointsStyle(feature);\r\n          if (pointArrowStyle != null && pointArrowStyle.length > 0) {\r\n            styles = styles.concat(pointArrowStyle)\r\n          }\r\n          return styles;\r\n        })\r\n      }\r\n\r\n    },\r\n\r\n\r\n    changeFlowTextStyleByCurrentZoom () {\r\n      let this_ = this;\r\n      //隐藏文字\r\n      if (this_.leftCurrentZoom < this_.zoomThreshold && this_.initStyleFlag) {\r\n        this.initStyleFlag = false;\r\n        this.hideFlowText(this_)\r\n      }\r\n      //显示文字\r\n      if (this_.leftCurrentZoom >= this_.zoomThreshold && !this_.initStyleFlag) {\r\n        this.showFlowText(this_)\r\n        this.initStyleFlag = true;\r\n      }\r\n    },\r\n\r\n    // 初始化地图\r\n    initMap () {\r\n      const mapContainer = this.$refs.map;\r\n      //将图层加入Map\r\n      const map = new Map({\r\n        layers: [gaodeMapLayer],\r\n        target: mapContainer,\r\n        view: view\r\n      });\r\n      // 添加拖动事件\r\n      map.on('pointerdrag', this.leftPointerdrag);\r\n      // 添加鼠标点击事件\r\n      map.on('click', this.mapClick);\r\n      // 缩放监听\r\n      map.on('moveend', this.leftMovvend);\r\n      // 保存地图\r\n      this.mapData = map\r\n      //添加文字标注\r\n      this.addMarkTextLayer();\r\n    },\r\n\r\n    leftPlaneChange () {\r\n      this.removePopup();\r\n      this.mapData.removeLayer(this.vectorLayer);\r\n      this.initVectorLayer();\r\n      this.$bas.$emit(\"leftPlaneChange\", this.leftPlane)\r\n    },\r\n\r\n    //组装左侧交通信息表\r\n    assebleLeftTransPopContent (feature, compaireFeature, layer) {\r\n      let compaireResult = {}\r\n      if (compaireFeature != null && compaireFeature != undefined) {\r\n        compaireResult = featureCompaire(feature.properties, compaireFeature.properties);\r\n      }\r\n      let downUrl = require('@/assets/images/nav/down.png');\r\n      let upUrl = require('@/assets/images/nav/up.png');\r\n      let content = `<div style='color:#121924;font-weight: bold;width:100%;z-index:4;height:95px;padding:6px;font-size: 15px'>` + layer + `\r\n        <div style = 'margin-top:10px' ><button id='btn1' style='margin-right:10px;border: none;height: 28px;line-height: 28px;border-radius: 4px;width: 80px;background: #004AB3;color: #ffffff;' onclick=\"preview1()\">基本信息</button>\r\n            <button id='btn2' style=\"border: none;height: 28px;line-height: 28px;border-radius: 4px;width: 80px;background: #D3D6DB;color: #ffffff;\" onclick=\"preview2()\">交通信息</button></div>\r\n            </div>\r\n        <div style='font-size: 10px;width:100%' id='info1'>`\r\n      this.popTransList.forEach(element => {\r\n        let propVal = feature.properties[element.propertie];\r\n        if (propVal != null) {\r\n          let maxLen = element.maxlength;\r\n          let type = element.type;\r\n          //格式化\r\n          if (maxLen != null && type == 'float') {\r\n            propVal = formatFixNum(propVal, maxLen)\r\n          }\r\n          if (type == 'int') {\r\n            propVal = Math.floor(propVal)\r\n          }\r\n          //拼接单位\r\n          let unit = element.unit;\r\n          if (unit != null && propVal != null) {\r\n            propVal = propVal + \"&nbsp\" + unit;\r\n          }\r\n        } else {\r\n          propVal = ''\r\n        }\r\n        content = content + `<div style=\"height: 26px;width:100%\">\r\n                    <a style=\"color:#646566;width:40%;display: inline-block;\">`+ element.label + `:</a>\r\n                    <a style=\"text-align: right;font-size:14px;width:50%;display: inline-block;\">`+ propVal + `</a>`\r\n        if (compaireResult[element.propertie] == '>') {\r\n          content = content + `<img src = ` + upUrl + ` style = 'width:20px;height:18px' />`\r\n        } else if (compaireResult[element.propertie] == '<') {\r\n          content = content + `<img src = ` + downUrl + ` style = 'width:20px;height:18px' />`\r\n        }\r\n        content = content + `</div>`\r\n\r\n\r\n\r\n      });\r\n      content = content + '</div>';\r\n      return content;\r\n    },\r\n\r\n\r\n\r\n    // 弹出框\r\n    addLeftPopup (coordinate, feature, compaireFeature) {\r\n      this.removePopup()\r\n      // 获取弹出层DOM\r\n      let container = document.getElementById('popup')\r\n      let content = document.getElementById('popup-content')\r\n      if (this.overlay) {\r\n      } else {\r\n        // 创建Overlay弹出层绑定DOM\r\n        this.overlay = new Overlay({\r\n          element: container,\r\n        })\r\n        // 添加到map\r\n        this.mapData.addOverlay(this.overlay)\r\n      }\r\n      // 道路信息\r\n      let layer = feature.properties.layer == null ? \"\" : feature.properties.layer;\r\n      let handle = feature.properties.handle == null ? \"\" : feature.properties.handle;\r\n      let length = feature.properties.length == null ? \"\" : Math.floor(feature.properties.length) + \" m\";\r\n      let capacity = feature.properties.capacity == null ? \"\" : feature.properties.capacity + ' pcu/h';\r\n      // 方向（1单向，-1反向单向，0双向）\r\n      let dir = feature.properties.dir == 1 ? \"单向\" : feature.properties.dir == -1 ? \"反向单向\" : feature.properties.dir == 0 ? \"双向\" : '';\r\n      //交通流量\r\n      let transPopContent = this.assebleLeftTransPopContent(feature, compaireFeature, layer);\r\n\r\n      transPopContent = transPopContent + `</div>\r\n          </div>\r\n          <div style='font-size: 10px;width:100%' id='info2'>\r\n            <div style=\"height: 26px;width:100%\">\r\n              <a style=\"color:#646566;width:45%;display: inline-block;\">道路ID:</a>\r\n              <a style=\"text-align: right;font-size:14px;width:50%;display: inline-block;\">`+ handle + `</a>\r\n            </div>\r\n            <div style=\"height: 26px;width:100%\">\r\n              <a style=\"color:#646566;width:45%;display: inline-block;\">等级:</a>\r\n              <a style=\"text-align: right;font-size:14px;width:50%;display: inline-block;\">`+ layer + `</a>\r\n            </div>\r\n            <div style=\"height: 26px;width:100%\">\r\n              <a style=\"color:#646566;width:45%;display: inline-block;\">长度:</a>\r\n              <a style=\"text-align: right;font-size:14px;width:50%;display: inline-block;\">`+ length + `</a>\r\n            </div>\r\n            <div style=\"height: 26px;width:100%\">\r\n              <a style=\"color:#646566;width:45%;display: inline-block;\">通行能力:</a>\r\n              <a style=\"text-align: right;font-size:14px;width:50%;display: inline-block;\">`+ capacity + `</a>\r\n            </div>\r\n             <div style=\"height: 26px;width:100%\">\r\n              <a style=\"color:#646566;width:45%;display: inline-block;\">方向:</a>\r\n              <a style=\"text-align: right;font-size:14px;width:50%;display: inline-block;\">`+ dir + `</a>\r\n            </div>\r\n          </div>`;\r\n      content.innerHTML = transPopContent;\r\n      // 设置弹出层位置即可出现\r\n      this.overlay.setPosition(coordinate)\r\n      document.getElementById('info1').style.display = 'none';\r\n      document.getElementById('popup').style.display = 'block';\r\n    },\r\n\r\n    // 清除弹出框\r\n    removePopup () {\r\n      if (this.overlay) {\r\n        // 设置位置undefined可达到隐藏清除弹出框\r\n        this.overlay.setPosition(undefined)\r\n      }\r\n    },\r\n    removeBtn2 () {\r\n      if (this.overlay) {\r\n        // 设置位置undefined可达到隐藏清除弹出框\r\n        this.overlay.setPosition(undefined)\r\n\r\n        if (document.getElementById('popup2').style.display == 'block') {\r\n          document.getElementById('popup2').style.display = 'none'\r\n        }\r\n        this.clearHighlight()\r\n        //清除对面高亮\r\n        this.$bas.$emit('clearHighlight_L', '1')\r\n      }\r\n    },\r\n    parseFeatureDetail (featureResp, feature) {\r\n      if (!featureResp) {\r\n        return null;\r\n      }\r\n      var jsonObj = JSON.parse(featureResp);\r\n      var features = jsonObj.features;\r\n      if (features == null || features.length == 0) {\r\n        return null;\r\n      }\r\n      let compaireFeature;\r\n      for (let k = 0; k < features.length; k++) {\r\n        let properties = features[k].properties;\r\n        let coordinates = features[k].coordinates;\r\n        if (properties.layer == feature.properties.layer\r\n          && feature.properties.handle == properties.handle) {\r\n          compaireFeature = features[k];\r\n          break;\r\n        }\r\n      }\r\n      return compaireFeature;\r\n\r\n    },\r\n\r\n    //根据道路ID查询对比方案详情\r\n    assembleLeftCompairePop (feature, thisObj, evt) {\r\n      debugger\r\n      let selectedPlaneVal = thisObj.rightSelectedPlane;\r\n      // if (selectedPlaneVal == null || selectedPlaneVal == undefined) {\r\n      //   selectedPlaneVal = this.leftPlane+1;\r\n      // }\r\n      let handle = feature.properties.handle\r\n      if (handle == null) {\r\n        thisObj.addLeftPopup(evt.coordinate, feature, null);\r\n        return;\r\n      }\r\n      let rightLayerName;\r\n      newList.forEach(item => {\r\n        if (item.value == selectedPlaneVal) {\r\n          rightLayerName = item.layerName\r\n        }\r\n      })\r\n      if (!rightLayerName) {\r\n        thisObj.addLeftPopup(evt.coordinate, feature, null);\r\n        return;\r\n      }\r\n      let propertyName = 'Test:handle';\r\n      let respProperties = 'layer,handle,length,capacity,ab_flow,ba_flow,tot_flow,ab_voc,ba_voc,max_voc,geom';\r\n      let url = process.env.VUE_APP_GIS_BASE_URL + '/wfs?request=GetFeature&version=1.1.0&typeName='\r\n        + rightLayerName + '&propertyName=' + respProperties + '&outputFormat=JSON&FILTER=<Filter xmlns=\"http://www.opengis.net/ogc\"><PropertyIsEqualTo><PropertyName>'\r\n        + propertyName + '</PropertyName><Literal>' + handle + '</Literal></PropertyIsEqualTo></Filter>'\r\n      //请求url对比方案道路详情\r\n      fetch(url)\r\n        .then(function (response) {\r\n          return response.text();\r\n        })\r\n        .then(function (info) {\r\n          if (info != null) {\r\n           \r\n            let compaireFeature = thisObj.parseFeatureDetail(info, feature);\r\n            thisObj.addLeftPopup(evt.coordinate, feature, compaireFeature);\r\n            //弹出右边弹出框\r\n            thisObj.$emit('addRightPopupByParent', evt.coordinate, compaireFeature, feature);\r\n          } else {\r\n            thisObj.addLeftPopup(evt.coordinate, feature, null);\r\n          }\r\n        })\r\n\r\n\r\n    },\r\n\r\n    // 鼠标点击地图事件\r\n    mapClick (evt) {\r\n      let pixel = this.mapData.getEventPixel(evt.originalEvent);\r\n      let feature = this.mapData.forEachFeatureAtPixel(pixel,\r\n        function (feature, layer) {\r\n          return feature;\r\n        });\r\n      if (feature) {\r\n        //捕捉到要素后，弹框\r\n        let featureConvert = convertFeature(feature);\r\n        this.addHighLightStyle(feature, this, '')\r\n        debugger\r\n        this.assembleLeftCompairePop(featureConvert, this, evt);\r\n\r\n      } else {\r\n        this.removeBtn2();\r\n      }\r\n\r\n    },\r\n    addHighLightStyle (clickFeature, thisObj, num) {\r\n      let featureObj = [];\r\n      featureObj.push(clickFeature);\r\n      this.clearHighlight();\r\n      let highLightStyle = new Style({\r\n        fill: new Fill({\r\n          color: \"#ffff00\",\r\n        }),\r\n        stroke: new Stroke({\r\n          color: \"#ffff00\",\r\n          width: 8\r\n        }),\r\n      })\r\n      thisObj.highLightLayer = new VectorLayer({\r\n        name: \"dk\",\r\n        source: new VectorSource({\r\n          features: featureObj,\r\n        }),\r\n        style: (feature, solution) => {\r\n          return highLightStyle;\r\n        }\r\n      })\r\n      thisObj.highLightLayer.set(\"id\", \"highlightLayer\")\r\n      this.mapData.addLayer(thisObj.highLightLayer)\r\n      if (num == '') {\r\n        //右边高亮\r\n        this.$bas.$emit(\"addRightHighLightStyle\", clickFeature, thisObj, '1')\r\n      }\r\n    },\r\n    //删除高亮图层\r\n    clearHighlight () {\r\n      let arr = this.mapData.getLayers().array_\r\n      let highlightLayer = {}\r\n      arr.forEach(item => {\r\n        if (item.get(\"id\") == \"highlightLayer\") {\r\n          highlightLayer = item\r\n        }\r\n      })\r\n      if (highlightLayer && highlightLayer.className_) {\r\n        this.mapData.removeLayer(highlightLayer)\r\n      }\r\n    },\r\n\r\n\r\n\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '~@/assets/styles/popup.scss';\r\n@import '~@/assets/styles/traffic.scss';\r\n.content {\r\n  position: relative;\r\n}\r\n.select-div {\r\n  right: 28px;\r\n  top: 70px;\r\n  padding: 10px 16px 0 16px;\r\n}\r\n</style>\r\n"]}]}