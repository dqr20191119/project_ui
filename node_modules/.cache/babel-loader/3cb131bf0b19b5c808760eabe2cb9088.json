{"remainingRequest":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\work\\proj\\project_manage\\project-ui\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\work\\proj\\project_manage\\project-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\proj\\project_manage\\project-ui\\src\\views\\traffic-decision\\components\\tab2-right.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\proj\\project_manage\\project-ui\\src\\views\\traffic-decision\\components\\tab2-right.vue","mtime":1663479653290},{"path":"D:\\work\\proj\\project_manage\\project-ui\\babel.config.js","mtime":1663229169808},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663230084016},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1663230086097},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663230084016},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1663230087832}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkID0gcmVxdWlyZSgiRDovd29yay9wcm9qL3Byb2plY3RfbWFuYWdlL3Byb2plY3QtdWkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVXaWxkY2FyZC5qcyIpLmRlZmF1bHQ7Cgp2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoIkQ6L3dvcmsvcHJvai9wcm9qZWN0X21hbmFnZS9wcm9qZWN0LXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdC5qcyIpLmRlZmF1bHQ7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsKCnZhciBfZGVmaW5lUHJvcGVydHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJEOi93b3JrL3Byb2ovcHJvamVjdF9tYW5hZ2UvcHJvamVjdC11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eS5qcyIpKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuanNvbi5zdHJpbmdpZnkuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIik7CgpyZXF1aXJlKCJvbC9vbC5jc3MiKTsKCnZhciBfTWFwID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9NYXAiKSk7Cgp2YXIgb2xDb250cm9sID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgib2wvY29udHJvbCIpKTsKCnZhciBfVmlldyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgib2wvVmlldyIpKTsKCnZhciBfZXh0ZW50ID0gcmVxdWlyZSgib2wvZXh0ZW50Iik7Cgp2YXIgX1RpbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL2xheWVyL1RpbGUiKSk7Cgp2YXIgX1dNVFMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL3NvdXJjZS9XTVRTIikpOwoKdmFyIF9YWVogPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL3NvdXJjZS9YWVoiKSk7Cgp2YXIgX1dNVFMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC90aWxlZ3JpZC9XTVRTIikpOwoKdmFyIF9Qcm9qZWN0aW9uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9wcm9qL1Byb2plY3Rpb24iKSk7Cgp2YXIgX3Byb2ogPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoInByb2o0IikpOwoKdmFyIF9wcm9qMiA9IHJlcXVpcmUoIm9sL3Byb2ovcHJvajQiKTsKCnZhciBfVmVjdG9yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9zb3VyY2UvVmVjdG9yIikpOwoKdmFyIF9zb3VyY2UgPSByZXF1aXJlKCJvbC9zb3VyY2UiKTsKCnZhciBfVmVjdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgib2wvbGF5ZXIvVmVjdG9yIikpOwoKdmFyIF9GZWF0dXJlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9GZWF0dXJlIikpOwoKdmFyIF9pbnRlcmFjdGlvbiA9IHJlcXVpcmUoIm9sL2ludGVyYWN0aW9uIik7Cgp2YXIgX3N0eWxlID0gcmVxdWlyZSgib2wvc3JjL3N0eWxlIik7Cgp2YXIgX1dLVCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgib2wvZm9ybWF0L1dLVCIpKTsKCnZhciBfR2VvSlNPTiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgib2wvZm9ybWF0L0dlb0pTT04iKSk7Cgp2YXIgX092ZXJsYXkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL092ZXJsYXkiKSk7Cgp2YXIgZWNoYXJ0cyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoImVjaGFydHMiKSk7Cgp2YXIgX2F4aW9zID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJheGlvcyIpKTsKCnZhciBfcmVxdWVzdCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQC91dGlscy9yZXF1ZXN0IikpOwoKdmFyIF90YWIyTGVmdCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiLi90YWIyLWxlZnQudnVlIikpOwoKdmFyIF9jb21tb24gPSByZXF1aXJlKCJAL2FwaS9jb21tb24vY29tbW9uIik7Cgp2YXIgX3BsYW5lID0gcmVxdWlyZSgiQC9hcGkvZGVjaXNpb24vcGxhbmUiKTsKCnZhciB0dXJmID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZSgiQHR1cmYvdHVyZiIpKTsKCnZhciBfUG9pbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIm9sL2dlb20vUG9pbnQiKSk7Cgp2YXIgX3Byb2ozID0gcmVxdWlyZSgib2wvcHJvaiIpOwoKdmFyIF9MaW5lU3RyaW5nID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJvbC9nZW9tL0xpbmVTdHJpbmciKSk7Cgp2YXIgX011bHRpTGluZVN0cmluZyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgib2wvZ2VvbS9NdWx0aUxpbmVTdHJpbmciKSk7Cgp2YXIgX2RlY2lzaW9uID0gcmVxdWlyZSgiQC9hcGkvZGVjaXNpb24tbWFuYWdlL2RlY2lzaW9uIik7CgovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovL+S4reW/g+WdkOaghwp2YXIgY2VudGVyQ29yZGluYXRlID0gWzY1NjgxMy40NDI1NiwgMzU2MDQzMi45ODI0NV07IC8v5Z2Q5qCH5a6a5LmJCgpfcHJvai5kZWZhdWx0LmRlZnMoIkVQU0c6NDU0OCIsICIrcHJvaj10bWVyYyArbGF0XzA9MCArbG9uXzA9MTE3ICtrPTEgK3hfMD01MDAwMDAgK3lfMD0wICtlbGxwcz1HUlM4MCArdW5pdHM9bSArbm9fZGVmcyIpOwoKKDAsIF9wcm9qMi5yZWdpc3RlcikoX3Byb2ouZGVmYXVsdCk7CnZhciBuZXdMaXN0ID0gW107CnZhciBwYXJlbnRWYWwgPSAnJzsgLy/lnLDlm77liJ3lp4vljJYKCnZhciB2aWV3MiA9IG5ldyBfVmlldy5kZWZhdWx0KHsKICBjZW50ZXI6ICgwLCBfcHJvajMudHJhbnNmb3JtKShjZW50ZXJDb3JkaW5hdGUsICdFUFNHOjQ1NDgnLCAnRVBTRzozODU3JyksCiAgbWluWm9vbTogMTAsCiAgbWF4Wm9vbTogMTgsCiAgem9vbTogMTMuNSAvLyDlnLDlm77liJ3lp4vljJbnmoTnvKnmlL7nuqfliKsKCn0pOyAvL+mrmOW+t+WcsOWbvuWbvuWxggoKdmFyIGdhb2RlTWFwTGF5ZXIgPSBuZXcgX1RpbGUuZGVmYXVsdCh7CiAgc291cmNlOiBuZXcgX1hZWi5kZWZhdWx0KHsKICAgIHVybDogJ2h0dHA6Ly93ZWJzdDB7MS00fS5pcy5hdXRvbmF2aS5jb20vYXBwbWFwdGlsZT9sYW5nPXpoX2NuJnNpemU9MSZzY2w9MiZzdHlsZT03Jng9e3h9Jnk9e3l9Jno9e3p9JwogIH0pCn0pOwp2YXIgX2RlZmF1bHQgPSB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHJpZ2h0UGxhbmVMaXN0OiBbXSwKICAgICAgcG9wVHJhbnNMaXN0OiBbewogICAgICAgIGxhYmVsOiAnQULkuqTpgJrph48nLAogICAgICAgIHByb3BlcnRpZTogJ2FiX2Zsb3cnLAogICAgICAgIHVuaXQ6ICdwY3UvaCcsCiAgICAgICAgdHlwZTogJ2ludCcKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAnQkHkuqTpgJrph48nLAogICAgICAgIHByb3BlcnRpZTogJ2JhX2Zsb3cnLAogICAgICAgIHVuaXQ6ICdwY3UvaCcsCiAgICAgICAgdHlwZTogJ2ludCcKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAn5oC75Lqk6YCa6YePJywKICAgICAgICBwcm9wZXJ0aWU6ICd0b3RfZmxvdycsCiAgICAgICAgdW5pdDogJ3BjdS9oJywKICAgICAgICB0eXBlOiAnaW50JwogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICdBQumlseWSjOW6picsCiAgICAgICAgcHJvcGVydGllOiAnYWJfdm9jJywKICAgICAgICBtYXhsZW5ndGg6IDIsCiAgICAgICAgdHlwZTogJ2Zsb2F0JwogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICdCQemlseWSjOW6picsCiAgICAgICAgcHJvcGVydGllOiAnYmFfdm9jJywKICAgICAgICBtYXhsZW5ndGg6IDIsCiAgICAgICAgdHlwZTogJ2Zsb2F0JwogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICfmnIDlpKfppbHlkozluqYnLAogICAgICAgIHByb3BlcnRpZTogJ21heF92b2MnLAogICAgICAgIG1heGxlbmd0aDogMiwKICAgICAgICB0eXBlOiAnZmxvYXQnCiAgICAgIH1dLAogICAgICByaWdodFBsYW5lOiAnJywKICAgICAgbGVmdFNlbGVjdGVkUGxhbmU6IG51bGwsCiAgICAgIHZlY3RvckxheWVyOiBudWxsLAogICAgICBzdHlsZTogewogICAgICAgIGxpbmVfd2lkdGg6IDMsCiAgICAgICAgbGluZV9zdHJva2U6ICcjNDU5YzUwJywKICAgICAgICBpbnRlcnZhbDogNDAKICAgICAgfSwKICAgICAgbWFwOiBudWxsCiAgICB9OwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdGhpcy5pbml0Q29tcG9uZW50SW5mbygpOwogICAgdGhpcy5pbml0TWFwKCk7IC8vIOmrmOS6rgoKICAgIHRoaXMuJGJhcy4kb24oImFkZFJpZ2h0SGlnaExpZ2h0U3R5bGUiLCBmdW5jdGlvbiAoaSwgaiwgbnVtKSB7CiAgICAgIF90aGlzLmFkZEhpZ2hMaWdodFN0eWxlKGksIGosIG51bSk7CiAgICB9KTsgLy/muIXpmaTpq5jkuq4KCiAgICB0aGlzLiRiYXMuJG9uKCJjbGVhckhpZ2hsaWdodF9MIiwgZnVuY3Rpb24gKGkpIHsKICAgICAgX3RoaXMuY2xlYXJIaWdobGlnaHQoKTsKICAgIH0pOwogICAgdGhpcy5yaWdodFBsYW5lTGlzdCA9IHRoaXMucmlnaHRQbGFuZUxpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgIHJldHVybiBpdGVtLmJpelZhbCA9PSBwYXJlbnRWYWw7CiAgICB9KTsKICAgIHRoaXMuJGJhcy4kb24oImxlZnRQbGFuZUNoYW5nZSIsIGZ1bmN0aW9uIChpKSB7CiAgICAgIF90aGlzLnJpZ2h0UGxhbmVMaXN0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShuZXdMaXN0KSk7CiAgICAgIGNvbnNvbGUubG9nKF90aGlzLnJpZ2h0UGxhbmVMaXN0KTsKICAgICAgX3RoaXMucmlnaHRQbGFuZUxpc3QgPSBfdGhpcy5yaWdodFBsYW5lTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS52YWx1ZSAhPSBpICYmIGl0ZW0uYml6VmFsID09IHBhcmVudFZhbDsKICAgICAgfSk7CiAgICAgIF90aGlzLnJpZ2h0UGxhbmUgPSBfdGhpcy5yaWdodFBsYW5lTGlzdFswXS52YWx1ZTsKICAgICAgX3RoaXMubGVmdFNlbGVjdGVkUGxhbmUgPSBpOwoKICAgICAgX3RoaXMuaW5pdFZlY3RvckxheWVyKCk7CiAgICB9KTsgLy/mi5bliqjnm5HlkKzmlrnms5UKCiAgICB0aGlzLiRiYXMuJG9uKCJsZWZ0UGFuZWxEcmFnZUNoYW5nZSIsIGZ1bmN0aW9uIChjb3JkaW5hdGUsIHpvb20pIHsKICAgICAgaWYgKGNvcmRpbmF0ZSAmJiB6b29tKSB7CiAgICAgICAgX3RoaXMucmlnaHRDdXJyZW50Q29yZGluYXRlID0gY29yZGluYXRlOwogICAgICAgIF90aGlzLnJpZ3RodEN1cnJlbnRab29tID0gem9vbTsKICAgICAgICB2aWV3Mi5hbmltYXRlKHsKICAgICAgICAgIGNlbnRlcjogY29yZGluYXRlLAogICAgICAgICAgem9vbTogem9vbSwKICAgICAgICAgIC8vIOe8qeaUvue6p+WIqwogICAgICAgICAgcm90YXRpb246IHVuZGVmaW5lZCwKICAgICAgICAgIGR1cmF0aW9uOiAxMAogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsgLy/nvKnmlL7nm5HlkKwKCiAgICB0aGlzLiRiYXMuJG9uKCJsZWZ0TW92dmVuZENoYW5nZSIsIGZ1bmN0aW9uIChjb3JkaW5hdGUsIHpvb20pIHsKICAgICAgaWYgKGNvcmRpbmF0ZSAmJiB6b29tKSB7CiAgICAgICAgX3RoaXMucmlnaHRDdXJyZW50Q29yZGluYXRlID0gY29yZGluYXRlOwogICAgICAgIF90aGlzLnJpZ3RodEN1cnJlbnRab29tID0gem9vbTsKICAgICAgICB2aWV3Mi5hbmltYXRlKHsKICAgICAgICAgIGNlbnRlcjogY29yZGluYXRlLAogICAgICAgICAgem9vbTogem9vbSwKICAgICAgICAgIC8vIOe8qeaUvue6p+WIqwogICAgICAgICAgcm90YXRpb246IHVuZGVmaW5lZCwKICAgICAgICAgIGR1cmF0aW9uOiAxMAogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cDInKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyAvL+S6pOmAmuS/oeaBr+eCueWHu+aMiemSrgoKICAgIHdpbmRvdy5wcmV2aWV3MyA9IGZ1bmN0aW9uICgpIHsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm80Jykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbmZvMycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4zJykuc3R5bGUuYmFja2dyb3VuZCA9ICcjMDA0QUIzJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bjQnKS5zdHlsZS5iYWNrZ3JvdW5kID0gJyNEM0Q2REInOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5mbzInKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm8xJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bjEnKS5zdHlsZS5iYWNrZ3JvdW5kID0gJyMwMDRBQjMnOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuMicpLnN0eWxlLmJhY2tncm91bmQgPSAnI0QzRDZEQic7CiAgICB9OyAvL+WfuuacrOS/oeaBr+eCueWHu+aMiemSrgoKCiAgICB3aW5kb3cucHJldmlldzQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbmZvNCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbmZvMycpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuNCcpLnN0eWxlLmJhY2tncm91bmQgPSAnIzAwNEFCMyc7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4zJykuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyNEM0Q2REInOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5mbzInKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5mbzEnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bjInKS5zdHlsZS5iYWNrZ3JvdW5kID0gJyMwMDRBQjMnOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuMScpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcjRDNENkRCJzsKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBhZGRNYXJrVGV4dExheWVyOiBmdW5jdGlvbiBhZGRNYXJrVGV4dExheWVyKCkgewogICAgICB0aGlzLiRlbWl0KCdhcXVpcmVQb2ludE1hcmtEYXRhJywgdGhpcy5tYXBEYXRhKTsKICAgIH0sCiAgICBjaGFuZ2VDb21wYXJlSXRlbUJ5Qml6VHlwZTogZnVuY3Rpb24gY2hhbmdlQ29tcGFyZUl0ZW1CeUJpelR5cGUocGFyZW50VmFsLCB0aGlzXywgbGVmdFBhbmVsKSB7CiAgICAgIHBhcmVudFZhbCA9IHBhcmVudFZhbDsKICAgICAgdGhpc18ucmlnaHRQbGFuZUxpc3QgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG5ld0xpc3QpKTsKICAgICAgdGhpc18ucmlnaHRQbGFuZUxpc3QgPSB0aGlzXy5yaWdodFBsYW5lTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5iaXpWYWwgPT0gcGFyZW50VmFsICYmIGl0ZW0udmFsdWUgIT0gbGVmdFBhbmVsOwogICAgICB9KTsKICAgICAgdGhpc18ucmlnaHRQbGFuZSA9IHRoaXNfLnJpZ2h0UGxhbmVMaXN0WzBdLnZhbHVlOwogICAgICB0aGlzXy5pbml0VmVjdG9yTGF5ZXIoKTsKICAgIH0sCiAgICAvLyBnZXRQb2ludHNCeUxpbmUgKGNvb3JkcywgZGlyKSB7CiAgICAvLyAgIGxldCB0aGlzXyA9IHRoaXM7CiAgICAvLyAgIGxldCBzdHlsZXMgPSBbXTsKICAgIC8vICAgbGV0IGRpc3RhbmNlXyA9IHRoaXNfLnN0eWxlLmludGVydmFsIC8gMjsvL+mmluS4queCueaUvue9ruWcqOi3neemu+i1t+eCuTEvMumXtOmalOeahOS9jee9rgogICAgLy8gICBsZXQgcGl4X3N0YXJ0ID0gdGhpc18ubWFwRGF0YS5nZXRQaXhlbEZyb21Db29yZGluYXRlKGNvb3Jkc1swXSkKICAgIC8vICAgbGV0IHBpeF9lbmQKICAgIC8vICAgZm9yIChsZXQgaSA9IDE7IGkgPCBjb29yZHMubGVuZ3RoOyBpKyspIHsKICAgIC8vICAgICBsZXQgY29vcmRfLCBjb29yZF9waXg7CiAgICAvLyAgICAgbGV0IHN0eWxlXzsKICAgIC8vICAgICBwaXhfZW5kID0gdGhpc18ubWFwRGF0YS5nZXRQaXhlbEZyb21Db29yZGluYXRlKGNvb3Jkc1tpXSk7CiAgICAvLyAgICAgbGV0IGRpc19zdGFydDJlbmQgPSBNYXRoLnNxcnQoTWF0aC5wb3coKHBpeF9zdGFydFswXSAtIHBpeF9lbmRbMF0pLCAyKSArIE1hdGgucG93KChwaXhfc3RhcnRbMV0gLSBwaXhfZW5kWzFdKSwgMikpIC8vIOiuoeeul+aUtuWwvuWcqOWxj+W5leS4iueahOi3neemuwogICAgLy8gICAgIGlmIChkaXNfc3RhcnQyZW5kID4gZGlzdGFuY2VfKSB7IC8vIOi3neemu+Wkp+S6jumXtOmalAogICAgLy8gICAgICAgLy8g6K6h566X6Led56a75byA5aeL54K55L2N55qE5YOP57Sg5YC8CiAgICAvLyAgICAgICBjb29yZF9waXggPSBbCiAgICAvLyAgICAgICAgIChkaXN0YW5jZV8gKiAocGl4X2VuZFswXSAtIHBpeF9zdGFydFswXSkpIC8gZGlzX3N0YXJ0MmVuZCArIHBpeF9zdGFydFswXSwKICAgIC8vICAgICAgICAgKGRpc3RhbmNlXyAqIChwaXhfZW5kWzFdIC0gcGl4X3N0YXJ0WzFdKSkgLyBkaXNfc3RhcnQyZW5kICsgcGl4X3N0YXJ0WzFdCiAgICAvLyAgICAgICBdOwogICAgLy8gICAgICAgLy8g6K6h566X57uP57qs5bqmCiAgICAvLyAgICAgICBjb29yZF8gPSB0aGlzXy5tYXBEYXRhLmdldENvb3JkaW5hdGVGcm9tUGl4ZWwoY29vcmRfcGl4KTsKICAgIC8vICAgICAgIHZhciByb3RhdGlvbiA9IE1hdGguUEkgLyAyICsgTWF0aC5hdGFuMihwaXhfZW5kWzFdIC0gcGl4X3N0YXJ0WzFdLCBwaXhfZW5kWzBdIC0gcGl4X3N0YXJ0WzBdKTsKICAgIC8vICAgICAgIGlmIChkaXIgPT0gLTEpIHsKICAgIC8vICAgICAgICAgcm90YXRpb24gPSByb3RhdGlvbiArIE1hdGguUEkKICAgIC8vICAgICAgIH0KICAgIC8vICAgICAgIC8vIOeUn+aIkOagt+W8jwogICAgLy8gICAgICAgc3R5bGVfID0gbmV3IFN0eWxlKHsKICAgIC8vICAgICAgICAgLy8g566t5aS054K555qE5L2N572uCiAgICAvLyAgICAgICAgIGdlb21ldHJ5OiBuZXcgUG9pbnQoY29vcmRfKSwKICAgIC8vICAgICAgICAgLy8g566t5aS054K555qE5qC35byPCiAgICAvLyAgICAgICAgIGltYWdlOiBuZXcgSWNvbih7CiAgICAvLyAgICAgICAgICAgc3JjOiByZXF1aXJlKCdAL2Fzc2V0cy9pbWFnZXMvanVlY2UvdXAxMC0xMC5wbmcnKSwKICAgIC8vICAgICAgICAgICByb3RhdGVXaXRoVmlldzogdHJ1ZSwKICAgIC8vICAgICAgICAgICByb3RhdGlvbjogcm90YXRpb24sCiAgICAvLyAgICAgICAgICAgc2NhbGU6IHRoaXMuc3R5bGUubGluZV93aWR0aCAvIDUsCiAgICAvLyAgICAgICAgICAgaW1nU2l6ZTogWzEwLCAxMF0KICAgIC8vICAgICAgICAgfSkKICAgIC8vICAgICAgIH0pCiAgICAvLyAgICAgICAvL+S4i+asoeW+queOr+W8gOWni+eCueS4uuW9k+WJjeeCuQogICAgLy8gICAgICAgcGl4X3N0YXJ0ID0gY29vcmRfcGl4OwogICAgLy8gICAgICAgZGlzdGFuY2VfID0gdGhpc18uc3R5bGUuaW50ZXJ2YWw7CiAgICAvLyAgICAgICBpLS07CiAgICAvLyAgICAgfSBlbHNlIGlmIChkaXNfc3RhcnQyZW5kID09IGRpc3RhbmNlXykgey8vIOi3neemu+etieS6jumXtOmalAogICAgLy8gICAgICAgdmFyIHJvdGF0aW9uID0gTWF0aC5QSSAvIDIgKyBNYXRoLmF0YW4yKHBpeF9lbmRbMV0gLSBwaXhfc3RhcnRbMV0sIHBpeF9lbmRbMF0gLSBwaXhfc3RhcnRbMF0pCiAgICAvLyAgICAgICBpZiAoZGlyID09IC0xKSB7CiAgICAvLyAgICAgICAgIHJvdGF0aW9uID0gcm90YXRpb24gKyBNYXRoLlBJCiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgICAvLyDnlJ/miJDmoLflvI8KICAgIC8vICAgICAgIHN0eWxlXyA9IG5ldyBTdHlsZSh7CiAgICAvLyAgICAgICAgIC8vIOeureWktOeCueeahOS9jee9rgogICAgLy8gICAgICAgICBnZW9tZXRyeTogbmV3IFBvaW50KGNvb3Jkc1tpXSksCiAgICAvLyAgICAgICAgIC8vIOeureWktOeCueeahOagt+W8jwogICAgLy8gICAgICAgICBpbWFnZTogbmV3IEljb24oewogICAgLy8gICAgICAgICAgIHNyYzogcmVxdWlyZSgnQC9hc3NldHMvaW1hZ2VzL2p1ZWNlL3VwMTAtMTAucG5nJyksCiAgICAvLyAgICAgICAgICAgcm90YXRlV2l0aFZpZXc6IHRydWUsCiAgICAvLyAgICAgICAgICAgcm90YXRpb246IHJvdGF0aW9uLAogICAgLy8gICAgICAgICAgIHNjYWxlOiB0aGlzLnN0eWxlLmxpbmVfd2lkdGggLyA1LAogICAgLy8gICAgICAgICAgIGltZ1NpemU6IFsxMCwgMTBdCiAgICAvLyAgICAgICAgIH0pCiAgICAvLyAgICAgICB9KQogICAgLy8gICAgICAgcGl4X3N0YXJ0ID0gcGl4X2VuZDsKICAgIC8vICAgICAgIGRpc3RhbmNlXyA9IHRoaXNfLnN0eWxlLmludGVydmFsOwogICAgLy8gICAgIH0gZWxzZSB7Ly/ot53nprvlsI/kuo7pl7TpmpQKICAgIC8vICAgICAgIGRpc3RhbmNlXyA9IGRpc3RhbmNlXyAtIGRpc19zdGFydDJlbmQ7CiAgICAvLyAgICAgICBwaXhfc3RhcnQgPSBwaXhfZW5kOwogICAgLy8gICAgIH0KICAgIC8vICAgICBzdHlsZV8gJiYgc3R5bGVzLnB1c2goc3R5bGVfKQogICAgLy8gICB9CiAgICAvLyAgIHJldHVybiBzdHlsZXMKICAgIC8vIH0sCiAgICBnZXRQb2ludEV4dGVudDogZnVuY3Rpb24gZ2V0UG9pbnRFeHRlbnQobikgewogICAgICBuID0gbiA/IG4gOiAxLjI7CiAgICAgIHZhciB2aWV3ID0gdGhpcy5tYXBEYXRhLmdldFZpZXcoKTsKICAgICAgdmFyIG1hcHNpemUgPSB0aGlzLm1hcERhdGEuZ2V0U2l6ZSgpLm1hcChmdW5jdGlvbiAoaXRfKSB7CiAgICAgICAgcmV0dXJuIGl0XyAqIG47CiAgICAgIH0pOwogICAgICByZXR1cm4gdmlldy5jYWxjdWxhdGVFeHRlbnQobWFwc2l6ZSk7CiAgICB9LAogICAgZ2V0TWlkZGxlUG9pbnQ6IGZ1bmN0aW9uIGdldE1pZGRsZVBvaW50KGNvb3JkcywgZmVhdHVyZSkgewogICAgICB0cnkgewogICAgICAgIGlmIChjb29yZHMgPT0gbnVsbCB8fCBjb29yZHMubGVuZ3RoID09IDAgfHwgY29vcmRzID09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29vcmRzLmxlbmd0aCA8PSAzKSB7CiAgICAgICAgICB2YXIgcG9pbnRfZmVhdHVyZXMgPSB0dXJmLnBvaW50cyhmZWF0dXJlLmdldEdlb21ldHJ5KCkuZ2V0Q29vcmRpbmF0ZXMoKVswXSk7CiAgICAgICAgICByZXR1cm4gbmV3IF9Qb2ludC5kZWZhdWx0KHR1cmYuY2VudGVyKHBvaW50X2ZlYXR1cmVzKS5nZW9tZXRyeS5jb29yZGluYXRlcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29vcmRzLmxlbmd0aCAlIDIgPT0gMCkgewogICAgICAgICAgcmV0dXJuIG5ldyBfUG9pbnQuZGVmYXVsdChjb29yZHNbY29vcmRzLmxlbmd0aCAvIDJdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIG5ldyBfUG9pbnQuZGVmYXVsdChjb29yZHNbTWF0aC5jZWlsKGNvb3Jkcy5sZW5ndGggLyAyKV0pOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgfQogICAgfSwKICAgIGluaUZsb3dPclZvY1RleHQ6IGZ1bmN0aW9uIGluaUZsb3dPclZvY1RleHQoY29vcmRzLCBmZWF0dXJlLCB0aGlzXywgdGV4dCwgb2Zmc2V0WCwgb2Zmc2V0eSkgewogICAgICB2YXIgY2VudGVyUG9pbnQgPSB0aGlzLmdldE1pZGRsZVBvaW50KGNvb3JkcywgZmVhdHVyZSk7CgogICAgICBpZiAoIWNlbnRlclBvaW50KSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHZhciBwaXhfc3RhcnQgPSB0aGlzXy5tYXBEYXRhLmdldFBpeGVsRnJvbUNvb3JkaW5hdGUoY29vcmRzWzBdKTsKICAgICAgdmFyIHBpeF9lbmQgPSB0aGlzXy5tYXBEYXRhLmdldFBpeGVsRnJvbUNvb3JkaW5hdGUoY2VudGVyUG9pbnQuZmxhdENvb3JkaW5hdGVzKTsKICAgICAgdmFyIHJvdGF0aW9uID0gTWF0aC5QSSArIE1hdGguYXRhbjIocGl4X2VuZFsxXSAtIHBpeF9zdGFydFsxXSwgcGl4X2VuZFswXSAtIHBpeF9zdGFydFswXSk7CgogICAgICBpZiAocGl4X2VuZFswXSA+IHBpeF9zdGFydFswXSkgewogICAgICAgIHJvdGF0aW9uID0gcm90YXRpb24gKyBNYXRoLlBJOwogICAgICB9CgogICAgICB0ZXh0ID0gdGV4dCArICIiOwogICAgICB2YXIgY29sb3IgPSB0aGlzXy5nZXRDb2xvckJ5RmVhdHVyZShmZWF0dXJlKTsKICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlVGV4dFN0eWxlKGNlbnRlclBvaW50LCByb3RhdGlvbiwgdGV4dCwgb2Zmc2V0WCwgb2Zmc2V0eSwgY29sb3IpOwogICAgfSwKICAgIGluaXRGbG93T3JWb2NQb2ludDogZnVuY3Rpb24gaW5pdEZsb3dPclZvY1BvaW50KGZlYXR1cmUsIHRoaXNfLCBpc0Zsb3cpIHsKICAgICAgdmFyIGNvb3JkcyA9IGZlYXR1cmUuZ2V0R2VvbWV0cnkoKS5nZXRDb29yZGluYXRlcygpOwogICAgICB2YXIgc3R5bGVzID0gW107CiAgICAgIHZhciBleHRlbnRfID0gdGhpc18uZ2V0UG9pbnRFeHRlbnQoKTsKICAgICAgdmFyIGxpbmVfID0gdHVyZi5tdWx0aUxpbmVTdHJpbmcoY29vcmRzKTsKICAgICAgdmFyIGxpbmVfY2xpcF9hcnIgPSB0dXJmLmJib3hDbGlwKGxpbmVfLCBleHRlbnRfKTsKICAgICAgdmFyIGFiX3RleHQgPSBpc0Zsb3cgPyBmZWF0dXJlLmdldCgiYWJfZmxvdyIpIDogZmVhdHVyZS5nZXQoImFiX3ZvYyIpOwogICAgICB2YXIgYmFfdGV4dCA9IGlzRmxvdyA/IGZlYXR1cmUuZ2V0KCJiYV9mbG93IikgOiBmZWF0dXJlLmdldCgiYmFfdm9jIik7CgogICAgICBpZiAoYWJfdGV4dCAhPSBudWxsICYmIGFiX3RleHQgIT0gJycpIHsKICAgICAgICBhYl90ZXh0ID0gaXNGbG93ID8gTWF0aC5mbG9vcihhYl90ZXh0KSA6ICgwLCBfY29tbW9uLmZvcm1hdEZpeE51bSkoYWJfdGV4dCwgMik7CiAgICAgIH0KCiAgICAgIGlmIChiYV90ZXh0ICE9IG51bGwgJiYgYmFfdGV4dCAhPSAnJykgewogICAgICAgIGJhX3RleHQgPSBpc0Zsb3cgPyBNYXRoLmZsb29yKGJhX3RleHQpIDogKDAsIF9jb21tb24uZm9ybWF0Rml4TnVtKShiYV90ZXh0LCAyKTsKICAgICAgfQoKICAgICAgaWYgKGxpbmVfY2xpcF9hcnIuZ2VvbWV0cnkudHlwZSA9PSAiTGluZVN0cmluZyIpIHsKICAgICAgICBpZiAoYWJfdGV4dCAhPSBudWxsICYmIGFiX3RleHQgIT0gJycpIHsKICAgICAgICAgIHZhciBvZmZzZXRYID0gMTU7CiAgICAgICAgICB2YXIgb2Zmc2V0eSA9IDE1OwogICAgICAgICAgdmFyIHN0eWxlX2FiID0gdGhpc18uaW5pRmxvd09yVm9jVGV4dChsaW5lX2NsaXBfYXJyLmdlb21ldHJ5LmNvb3JkaW5hdGVzLCBmZWF0dXJlLCB0aGlzXywgYWJfdGV4dCwgb2Zmc2V0WCwgb2Zmc2V0eSk7CiAgICAgICAgICBzdHlsZXMgPSBzdHlsZXMuY29uY2F0KHN0eWxlX2FiKTsKICAgICAgICB9CgogICAgICAgIGlmIChiYV90ZXh0ICE9IG51bGwgJiYgYmFfdGV4dCAhPSAnJykgewogICAgICAgICAgdmFyIF9vZmZzZXRYID0gLTE1OwoKICAgICAgICAgIHZhciBfb2Zmc2V0eSA9IC0xNTsKCiAgICAgICAgICB2YXIgc3R5bGVfYmEgPSB0aGlzXy5pbmlGbG93T3JWb2NUZXh0KGxpbmVfY2xpcF9hcnIuZ2VvbWV0cnkuY29vcmRpbmF0ZXMsIGZlYXR1cmUsIHRoaXNfLCBiYV90ZXh0LCBfb2Zmc2V0WCwgX29mZnNldHkpOwogICAgICAgICAgc3R5bGVzID0gc3R5bGVzLmNvbmNhdChzdHlsZV9iYSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gc3R5bGVzOwogICAgfSwKICAgIGNyZWF0ZVRleHRTdHlsZTogZnVuY3Rpb24gY3JlYXRlVGV4dFN0eWxlKGNvb3JkaW5hdGUsIHJvYXRpb24sIHRleHQsIG9mZnNldHgsIG9mZnNldHksIGNvbG9yKSB7CiAgICAgIHZhciBfVGV4dDsKCiAgICAgIHZhciBzdHlsZXNfID0gW107CiAgICAgIHZhciB0ZXh0XyA9IG5ldyBfc3R5bGUuVGV4dCgoX1RleHQgPSB7CiAgICAgICAgdGV4dEFsaWduOiAnY2VudGVyJywKICAgICAgICB0ZXh0QmFzZWxpbmU6ICdtaWRkbGUnLAogICAgICAgIGZvbnQ6ICdub3JtYWwgMTVweCDlvq7ova/pm4Xpu5EnLAogICAgICAgIHRleHQ6IHRleHQKICAgICAgfSwgKDAsIF9kZWZpbmVQcm9wZXJ0eTIuZGVmYXVsdCkoX1RleHQsICJ0ZXh0QmFzZWxpbmUiLCAibWlkZGxlIiksICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKF9UZXh0LCAib2Zmc2V0WSIsIG9mZnNldHgpLCAoMCwgX2RlZmluZVByb3BlcnR5Mi5kZWZhdWx0KShfVGV4dCwgIm9mZnNldFgiLCBvZmZzZXR5KSwgKDAsIF9kZWZpbmVQcm9wZXJ0eTIuZGVmYXVsdCkoX1RleHQsICJmaWxsIiwgbmV3IF9zdHlsZS5GaWxsKHsKICAgICAgICBjb2xvcjogY29sb3IKICAgICAgfSkpLCAoMCwgX2RlZmluZVByb3BlcnR5Mi5kZWZhdWx0KShfVGV4dCwgInJvdGF0aW9uIiwgcm9hdGlvbiksIF9UZXh0KSk7CiAgICAgIHZhciBzdHlsZV8gPSBuZXcgX3N0eWxlLlN0eWxlKHsKICAgICAgICBnZW9tZXRyeTogY29vcmRpbmF0ZQogICAgICB9KTsKICAgICAgc3R5bGVfLnNldFRleHQodGV4dF8pOwogICAgICBzdHlsZXNfLnB1c2goc3R5bGVfKTsKICAgICAgcmV0dXJuIHN0eWxlc187CiAgICB9LAogICAgZ2V0Q29sb3JCeUZlYXR1cmU6IGZ1bmN0aW9uIGdldENvbG9yQnlGZWF0dXJlKGZlYXR1cmUpIHsKICAgICAgLy8g6aWx5ZKM5bqmCiAgICAgIHZhciBtYXhfdm9jID0gZmVhdHVyZS5nZXQoIm1heF92b2MiKTsKICAgICAgdmFyIGNvbG9yID0gdGhpcy5zdHlsZS5saW5lX3N0cm9rZTsKCiAgICAgIGlmIChtYXhfdm9jID4gMCAmJiBtYXhfdm9jIDw9IDAuMjUpIHsKICAgICAgICBjb2xvciA9ICcjMTg1ODE3JzsKICAgICAgfSBlbHNlIGlmIChtYXhfdm9jID4gMC4yNSAmJiBtYXhfdm9jIDw9IDAuNSkgewogICAgICAgIGNvbG9yID0gJyM2MWE0M2EnOwogICAgICB9IGVsc2UgaWYgKG1heF92b2MgPiAwLjUgJiYgbWF4X3ZvYyA8PSAwLjc1KSB7CiAgICAgICAgY29sb3IgPSAnI2NmZTA1ZCc7CiAgICAgIH0gZWxzZSBpZiAobWF4X3ZvYyA+IDAuNzUgJiYgbWF4X3ZvYyA8PSAxKSB7CiAgICAgICAgY29sb3IgPSAnI2Q4Yzk2NCc7CiAgICAgIH0gZWxzZSBpZiAobWF4X3ZvYyA+IDEgJiYgbWF4X3ZvYyA8PSAxLjI1KSB7CiAgICAgICAgY29sb3IgPSAnI2Q3OTU1MCc7CiAgICAgIH0gZWxzZSBpZiAobWF4X3ZvYyA+IDEuMjUgJiYgbWF4X3ZvYyA8PSAxLjUpIHsKICAgICAgICBjb2xvciA9ICcjYzc1YjQxJzsKICAgICAgfSBlbHNlIGlmIChtYXhfdm9jID4gMS41ICYmIG1heF92b2MgPD0gMS43NSkgewogICAgICAgIGNvbG9yID0gJyNjNzViNDEnOwogICAgICB9IGVsc2UgaWYgKG1heF92b2MgPiAxLjc1KSB7CiAgICAgICAgY29sb3IgPSAnIzAwMDAwMCc7CiAgICAgIH0KCiAgICAgIHJldHVybiBjb2xvcjsKICAgIH0sCiAgICBnZXRQb2ludHNTdHlsZTogZnVuY3Rpb24gZ2V0UG9pbnRzU3R5bGUoZmVhdHVyZSkgewogICAgICB2YXIgY29vcmRzID0gZmVhdHVyZS5nZXRHZW9tZXRyeSgpLmdldENvb3JkaW5hdGVzKCk7CiAgICAgIHZhciB0aGlzXyA9IHRoaXM7CiAgICAgIHZhciBzdHlsZXMgPSBbXTsgLy8g5pa55ZCR77yIMeWNleWQke+8jC0x5Y+N5ZCR5Y2V5ZCR77yMMOWPjOWQke+8iQoKICAgICAgdmFyIGRpciA9IGZlYXR1cmUuZ2V0KCJkaXIiKTsgLy8g6aWx5ZKM5bqmCgogICAgICB2YXIgbWF4X3ZvYyA9IGZlYXR1cmUuZ2V0KCJtYXhfdm9jIik7IC8vIOa1gemHjwoKICAgICAgdmFyIHRvdF9mbG93ID0gZmVhdHVyZS5nZXQoInRvdF9mbG93Iik7IC8vIOminOiJsum7mOiupOWAvAoKICAgICAgdmFyIGNvbG9yID0gdGhpcy5nZXRDb2xvckJ5RmVhdHVyZShmZWF0dXJlKTsgLy8g57KX57uG6buY6K6k5YC8CgogICAgICB2YXIgd2lkdGggPSB0aGlzXy5zdHlsZS5saW5lX3dpZHRoOwogICAgICB2YXIgcGVjID0gMjsKCiAgICAgIGlmICh0b3RfZmxvdyA+IDAgJiYgdG90X2Zsb3cgPD0gMTI1MCkgewogICAgICAgIHdpZHRoID0gMSAqIHBlYzsKICAgICAgfSBlbHNlIGlmICh0b3RfZmxvdyA+IDEyNTAgJiYgdG90X2Zsb3cgPD0gMjUwMCkgewogICAgICAgIHdpZHRoID0gMiAqIHBlYzsKICAgICAgfSBlbHNlIGlmICh0b3RfZmxvdyA+PSAyNTAwKSB7CiAgICAgICAgd2lkdGggPSA0ICogcGVjOwogICAgICB9CgogICAgICBzdHlsZXMucHVzaChuZXcgX3N0eWxlLlN0eWxlKHsKICAgICAgICBzdHJva2U6IG5ldyBfc3R5bGUuU3Ryb2tlKHsKICAgICAgICAgIGNvbG9yOiBjb2xvciwKICAgICAgICAgIHdpZHRoOiB3aWR0aAogICAgICAgIH0pCiAgICAgIH0pKTsgLy8gbGV0IGV4dGVudF8gPSB0aGlzLmdldFBvaW50RXh0ZW50KCk7CiAgICAgIC8vIGxldCBsaW5lXyA9IHR1cmYubXVsdGlMaW5lU3RyaW5nKGNvb3Jkcyk7CiAgICAgIC8vIGxldCBsaW5lX2NsaXBfYXJyID0gdHVyZi5iYm94Q2xpcChsaW5lXywgZXh0ZW50XykKICAgICAgLy8gaWYgKGxpbmVfY2xpcF9hcnIgJiYgbGluZV9jbGlwX2Fyci5nZW9tZXRyeSkgewogICAgICAvLyAgIGlmIChsaW5lX2NsaXBfYXJyLmdlb21ldHJ5LnR5cGUgPT0gIkxpbmVTdHJpbmciKSB7CiAgICAgIC8vICAgICBsZXQgc3R5bGVfID0gdGhpc18uZ2V0UG9pbnRzQnlMaW5lKGxpbmVfY2xpcF9hcnIuZ2VvbWV0cnkuY29vcmRpbmF0ZXMsIGRpcik7CiAgICAgIC8vICAgICBpZiAoc3R5bGVfIGluc3RhbmNlb2YgQXJyYXkpIHsKICAgICAgLy8gICAgICAgc3R5bGVzID0gc3R5bGVzLmNvbmNhdChzdHlsZV8pCiAgICAgIC8vICAgICB9IGVsc2UgewogICAgICAvLyAgICAgICBzdHlsZXMucHVzaChzdHlsZV8pCiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgfSBlbHNlIGlmIChsaW5lX2NsaXBfYXJyLmdlb21ldHJ5LnR5cGUgPT0gIk11bHRpTGluZVN0cmluZyIpIHsKICAgICAgLy8gICAgIGxpbmVfY2xpcF9hcnIuZ2VvbWV0cnkuY29vcmRpbmF0ZXMuZm9yRWFjaChjb29yZHMgPT4gewogICAgICAvLyAgICAgICBsZXQgc3R5bGVfID0gdGhpc18uZ2V0UG9pbnRzQnlMaW5lKGNvb3JkcywgZGlyKQogICAgICAvLyAgICAgICBpZiAoc3R5bGVfIGluc3RhbmNlb2YgQXJyYXkpIHsKICAgICAgLy8gICAgICAgICBzdHlsZXMgPSBzdHlsZXMuY29uY2F0KHN0eWxlXykKICAgICAgLy8gICAgICAgfSBlbHNlIHsKICAgICAgLy8gICAgICAgICBzdHlsZXMucHVzaChzdHlsZV8pCiAgICAgIC8vICAgICAgIH0KICAgICAgLy8gICAgIH0pCiAgICAgIC8vICAgfQogICAgICAvLyB9CgogICAgICByZXR1cm4gc3R5bGVzOwogICAgfSwKICAgIGluaXRWZWN0b3JMYXllcjogZnVuY3Rpb24gaW5pdFZlY3RvckxheWVyKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBwbGFuZUluZm8gPSB0aGlzLnJpZ2h0UGxhbmVMaXN0LmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS52YWx1ZSA9PSBfdGhpczIucmlnaHRQbGFuZTsKICAgICAgfSk7IC8vIOWIneWni+WMluaLv+WIsOWFrOWFseaVsOaNrgoKICAgICAgdmFyICRtYXAgPSB0aGlzLm1hcERhdGE7CiAgICAgICRtYXAucmVtb3ZlTGF5ZXIodGhpcy52ZWN0b3JMYXllcik7CiAgICAgIHZhciAkdGhpcyA9IHRoaXM7IC8vIOivt+axguaVsOaNrgoKICAgICAgdmFyIHVybCA9IHByb2Nlc3MuZW52LlZVRV9BUFBfR0lTX0JBU0VfVVJMICsgJy9UZXN0L293cz9zZXJ2aWNlPVdGUyZ2ZXJzaW9uPTEuMC4wJnJlcXVlc3Q9R2V0RmVhdHVyZSZ0eXBlTmFtZT0nICsgZW5jb2RlVVJJKHBsYW5lSW5mby5sYXllck5hbWUpICsgJyZtYXhGZWF0dXJlcz01MDAwMDAwMDAmb3V0cHV0Rm9ybWF0PWFwcGxpY2F0aW9uJTJGanNvbic7CgogICAgICBfYXhpb3MuZGVmYXVsdC5nZXQodXJsLCBudWxsKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICB2YXIgZmVhdHVyZXNEYXRhID0gcmVzLmRhdGE7CiAgICAgICAgdmFyIHZlY3RvclNvdXJjZSA9IG5ldyBfVmVjdG9yLmRlZmF1bHQoewogICAgICAgICAgZmVhdHVyZXM6IG5ldyBfR2VvSlNPTi5kZWZhdWx0KHsKICAgICAgICAgICAgZmVhdHVyZVByb2plY3Rpb246ICdFUFNHOjM4NTcnLAogICAgICAgICAgICBkYXRhUHJvamVjdGlvbjogJ0VQU0c6NDU0OCcKICAgICAgICAgIH0pLnJlYWRGZWF0dXJlcyhmZWF0dXJlc0RhdGEpCiAgICAgICAgfSk7CiAgICAgICAgJHRoaXMudmVjdG9yTGF5ZXIgPSBuZXcgX1ZlY3RvcjIuZGVmYXVsdCh7CiAgICAgICAgICBzb3VyY2U6IHZlY3RvclNvdXJjZSwKICAgICAgICAgIG5hbWU6IHBsYW5lSW5mby5sYXllck5hbWUsCiAgICAgICAgICBzdHlsZTogZnVuY3Rpb24gc3R5bGUoZmVhdHVyZSwgc29sdXRpb24pIHsKICAgICAgICAgICAgdmFyIHN0eWxlcyA9ICR0aGlzLmdldFBvaW50c1N0eWxlKGZlYXR1cmUpOyAvL+agueaNruaWh+Wtl+aOp+WItuaMiemSruaWsOWinuaWh+Wtl+agt+W8jwoKICAgICAgICAgICAgdmFyIGFjdGl2ZUJ0biA9ICR0aGlzLiRwYXJlbnQuJHBhcmVudC4kcGFyZW50LmFjdGl2ZUJ0bjsKCiAgICAgICAgICAgIGlmIChhY3RpdmVCdG4gIT0gJycgJiYgYWN0aXZlQnRuICE9IDMpIHsKICAgICAgICAgICAgICB2YXIgaXNGbG93ID0gYWN0aXZlQnRuID09IDM7CiAgICAgICAgICAgICAgdmFyIGZsb3dTdHlsZSA9ICR0aGlzLmluaXRGbG93T3JWb2NQb2ludChmZWF0dXJlLCAkdGhpcywgaXNGbG93KTsKCiAgICAgICAgICAgICAgaWYgKGZsb3dTdHlsZSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBzdHlsZXMgPSBzdHlsZXMuY29uY2F0KGZsb3dTdHlsZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gc3R5bGVzOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgICR0aGlzLm1hcERhdGEuYWRkTGF5ZXIoJHRoaXMudmVjdG9yTGF5ZXIpOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDliJ3lp4vljJblnLDlm74KICAgIGluaXRNYXA6IGZ1bmN0aW9uIGluaXRNYXAoKSB7CiAgICAgIHZhciBtYXBDb250YWluZXIgPSB0aGlzLiRyZWZzLm1hcDI7IC8v5bCG5Zu+5bGC5Yqg5YWlTWFwCgogICAgICB2YXIgbWFwID0gbmV3IF9NYXAuZGVmYXVsdCh7CiAgICAgICAgbGF5ZXJzOiBbZ2FvZGVNYXBMYXllcl0sCiAgICAgICAgdGFyZ2V0OiBtYXBDb250YWluZXIsCiAgICAgICAgdmlldzogdmlldzIKICAgICAgfSk7IC8vIOa3u+WKoOm8oOagh+eCueWHu+S6i+S7tgoKICAgICAgbWFwLm9uKCdjbGljaycsIHRoaXMubWFwQ2xpY2spOyAvLyDmi5bliqjnm5HlkKwKCiAgICAgIG1hcC5vbigncG9pbnRlcmRyYWcnLCB0aGlzLnJpZ2h0UG9pbnRlcmRyYWcpOyAvLyDnvKnmlL7nm5HlkKwKCiAgICAgIG1hcC5vbignbW92ZWVuZCcsIHRoaXMucmlnaHRNb3Z2ZW5kKTsgLy8g5L+d5a2Y5Zyw5Zu+CgogICAgICB0aGlzLm1hcERhdGEgPSBtYXA7IC8v5re75Yqg5paH5a2X5qCH5rOoCgogICAgICB0aGlzLmFkZE1hcmtUZXh0TGF5ZXIoKTsKICAgIH0sCiAgICBnZXRSaWdodFBsYW5lOiBmdW5jdGlvbiBnZXRSaWdodFBsYW5lKCkgewogICAgICByZXR1cm4gdGhpcy5yaWdodFBsYW5lOwogICAgfSwKICAgIGxlZnRQbGFuZUNoYW5nZTogZnVuY3Rpb24gbGVmdFBsYW5lQ2hhbmdlKCkgewogICAgICB0aGlzLm1hcERhdGEucmVtb3ZlTGF5ZXIodGhpcy52ZWN0b3JMYXllcik7CiAgICAgIHRoaXMuaW5pdFZlY3RvckxheWVyKCk7CiAgICAgIHRoaXMubWFwRGF0YS5hZGRMYXllcih0aGlzLnZlY3RvckxheWVyKTsKICAgIH0sCiAgICBjaGFuZ2VSaWd0aFBsYW5lOiBmdW5jdGlvbiBjaGFuZ2VSaWd0aFBsYW5lKCkgewogICAgICB0aGlzLnJlbW92ZVBvcHVwKCk7CiAgICAgIHRoaXMubWFwRGF0YS5yZW1vdmVMYXllcih0aGlzLnZlY3RvckxheWVyKTsKICAgICAgdGhpcy5pbml0VmVjdG9yTGF5ZXIoKTsKICAgICAgdGhpcy5tYXBEYXRhLmFkZExheWVyKHRoaXMudmVjdG9yTGF5ZXIpOwogICAgICB0aGlzLiRiYXMuJGVtaXQoInJpZ2h0UGxhbmVDaGFuZ2UiLCB0aGlzLnJpZ2h0UGxhbmUpOwogICAgfSwKICAgIHJpZ2h0UG9pbnRlcmRyYWc6IGZ1bmN0aW9uIHJpZ2h0UG9pbnRlcmRyYWcoKSB7CiAgICAgIHRoaXMucmlnaHRDdXJyZW50Q29yZGluYXRlID0gdmlldzIuZ2V0Q2VudGVyKCk7CiAgICAgIHRoaXMucmlndGh0Q3VycmVudFpvb20gPSB2aWV3Mi5nZXRab29tKCk7CiAgICAgIHRoaXMuJGJhcy4kZW1pdCgicmlnaHRQYW5lbERyYWdlQ2hhbmdlIiwgdGhpcy5yaWdodEN1cnJlbnRDb3JkaW5hdGUsIHRoaXMucmlndGh0Q3VycmVudFpvb20pOwogICAgfSwKICAgIHJpZ2h0TW92dmVuZDogZnVuY3Rpb24gcmlnaHRNb3Z2ZW5kKCkgewogICAgICB0aGlzLnJpZ2h0Q3VycmVudENvcmRpbmF0ZSA9IHZpZXcyLmdldENlbnRlcigpOwogICAgICB0aGlzLnJpZ3RodEN1cnJlbnRab29tID0gdmlldzIuZ2V0Wm9vbSgpOwogICAgICB0aGlzLiRiYXMuJGVtaXQoInJpZ2h0TW92dmVuZENoYW5nZSIsIHRoaXMucmlnaHRDdXJyZW50Q29yZGluYXRlLCB0aGlzLnJpZ3RodEN1cnJlbnRab29tKTsKICAgIH0sCiAgICBzaG93Rmxvd1RleHQ6IGZ1bmN0aW9uIHNob3dGbG93VGV4dCh0aGlzXywgaXNGbG93KSB7CiAgICAgIHRoaXNfLnZlY3RvckxheWVyLnNldFN0eWxlKGZ1bmN0aW9uIChmZWF0dXJlLCBzb2x1dGlvbikgewogICAgICAgIHZhciBzdHlsZXMgPSBbXTsKICAgICAgICB2YXIgcG9pbnRBcnJvd1N0eWxlID0gdGhpc18uZ2V0UG9pbnRzU3R5bGUoZmVhdHVyZSk7CiAgICAgICAgdmFyIGZsb3dTdHlsZSA9IHRoaXNfLmluaXRGbG93T3JWb2NQb2ludChmZWF0dXJlLCB0aGlzXywgaXNGbG93KTsKCiAgICAgICAgaWYgKHBvaW50QXJyb3dTdHlsZSAhPSBudWxsICYmIHBvaW50QXJyb3dTdHlsZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICBzdHlsZXMgPSBzdHlsZXMuY29uY2F0KHBvaW50QXJyb3dTdHlsZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoZmxvd1N0eWxlICE9IG51bGwgJiYgZmxvd1N0eWxlLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHN0eWxlcyA9IHN0eWxlcy5jb25jYXQoZmxvd1N0eWxlKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBzdHlsZXM7CiAgICAgIH0pOwogICAgfSwKICAgIGhpZGVGbG93VGV4dDogZnVuY3Rpb24gaGlkZUZsb3dUZXh0KHRoaXNfKSB7CiAgICAgIGlmICh0aGlzXy52ZWN0b3JMYXllcikgewogICAgICAgIHRoaXNfLnZlY3RvckxheWVyLnNldFN0eWxlKG51bGwpOwogICAgICAgIHRoaXNfLnZlY3RvckxheWVyLnNldFN0eWxlKGZ1bmN0aW9uIChmZWF0dXJlLCBzb2x1dGlvbikgewogICAgICAgICAgdmFyIHN0eWxlcyA9IFtdOwogICAgICAgICAgdmFyIHBvaW50QXJyb3dTdHlsZSA9IHRoaXNfLmdldFBvaW50c1N0eWxlKGZlYXR1cmUpOwoKICAgICAgICAgIGlmIChwb2ludEFycm93U3R5bGUgIT0gbnVsbCAmJiBwb2ludEFycm93U3R5bGUubGVuZ3RoID4gMCkgewogICAgICAgICAgICBzdHlsZXMgPSBzdHlsZXMuY29uY2F0KHBvaW50QXJyb3dTdHlsZSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHN0eWxlczsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGFzc2VibGVSaWdodFRyYW5zUG9wQ29udGVudDogZnVuY3Rpb24gYXNzZWJsZVJpZ2h0VHJhbnNQb3BDb250ZW50KGZlYXR1cmUsIGNvbXBhaXJlRmVhdHVyZSwgbGF5ZXIpIHsKICAgICAgdmFyIGNvbXBhaXJlUmVzdWx0ID0ge307CgogICAgICBpZiAoY29tcGFpcmVGZWF0dXJlICE9IG51bGwgJiYgY29tcGFpcmVGZWF0dXJlICE9IHVuZGVmaW5lZCkgewogICAgICAgIGNvbXBhaXJlUmVzdWx0ID0gKDAsIF9wbGFuZS5mZWF0dXJlQ29tcGFpcmUpKGZlYXR1cmUucHJvcGVydGllcywgY29tcGFpcmVGZWF0dXJlLnByb3BlcnRpZXMpOwogICAgICB9CgogICAgICB2YXIgZG93blVybCA9IHJlcXVpcmUoJ0AvYXNzZXRzL2ltYWdlcy9uYXYvZG93bi5wbmcnKTsKCiAgICAgIHZhciB1cFVybCA9IHJlcXVpcmUoJ0AvYXNzZXRzL2ltYWdlcy9uYXYvdXAucG5nJyk7CgogICAgICB2YXIgY29udGVudCA9ICI8ZGl2IHN0eWxlPSdjb2xvcjojMTIxOTI0O2ZvbnQtd2VpZ2h0OiBib2xkO3dpZHRoOjEwMCU7ei1pbmRleDo0O2hlaWdodDo5NXB4O3BhZGRpbmc6NnB4O2ZvbnQtc2l6ZTogMTVweCc+IiArIGxheWVyICsgIlxuICAgICAgICA8ZGl2IHN0eWxlID0gJ21hcmdpbi10b3A6MTBweCcgPjxidXR0b24gaWQ9J2J0bjMnIHN0eWxlPSdtYXJnaW4tcmlnaHQ6MTBweDtib3JkZXI6IG5vbmU7aGVpZ2h0OiAyOHB4O2xpbmUtaGVpZ2h0OiAyOHB4O2JvcmRlci1yYWRpdXM6IDRweDt3aWR0aDogODBweDtiYWNrZ3JvdW5kOiAjMDA0QUIzO2NvbG9yOiAjZmZmZmZmOycgb25jbGljaz1cInByZXZpZXczKClcIj5cdTU3RkFcdTY3MkNcdTRGRTFcdTYwNkY8L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gaWQ9J2J0bjQnIHN0eWxlPVwiYm9yZGVyOiBub25lO2hlaWdodDogMjhweDtsaW5lLWhlaWdodDogMjhweDtib3JkZXItcmFkaXVzOiA0cHg7d2lkdGg6IDgwcHg7YmFja2dyb3VuZDogI0QzRDZEQjtjb2xvcjogI2ZmZmZmZjtcIiBvbmNsaWNrPVwicHJldmlldzQoKVwiPlx1NEVBNFx1OTAxQVx1NEZFMVx1NjA2RjwvYnV0dG9uPjwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgc3R5bGU9J2ZvbnQtc2l6ZTogMTBweDt3aWR0aDoxMDAlJyBpZD0naW5mbzMnPiI7CiAgICAgIHRoaXMucG9wVHJhbnNMaXN0LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICB2YXIgcHJvcFZhbCA9IGZlYXR1cmUucHJvcGVydGllc1tlbGVtZW50LnByb3BlcnRpZV07CgogICAgICAgIGlmIChwcm9wVmFsICE9IG51bGwpIHsKICAgICAgICAgIHZhciBtYXhMZW4gPSBlbGVtZW50Lm1heGxlbmd0aDsKICAgICAgICAgIHZhciB0eXBlID0gZWxlbWVudC50eXBlOyAvL+agvOW8j+WMlgoKICAgICAgICAgIGlmIChtYXhMZW4gIT0gbnVsbCAmJiB0eXBlID09ICdmbG9hdCcpIHsKICAgICAgICAgICAgcHJvcFZhbCA9ICgwLCBfY29tbW9uLmZvcm1hdEZpeE51bSkocHJvcFZhbCwgbWF4TGVuKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodHlwZSA9PSAnaW50JykgewogICAgICAgICAgICBwcm9wVmFsID0gTWF0aC5mbG9vcihwcm9wVmFsKTsKICAgICAgICAgIH0gLy/mi7zmjqXljZXkvY0KCgogICAgICAgICAgdmFyIHVuaXQgPSBlbGVtZW50LnVuaXQ7CgogICAgICAgICAgaWYgKHVuaXQgIT0gbnVsbCAmJiBwcm9wVmFsICE9IG51bGwpIHsKICAgICAgICAgICAgcHJvcFZhbCA9IHByb3BWYWwgKyAiJm5ic3AiICsgdW5pdDsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgcHJvcFZhbCA9ICcnOwogICAgICAgIH0KCiAgICAgICAgY29udGVudCA9IGNvbnRlbnQgKyAiPGRpdiBzdHlsZT1cImhlaWdodDogMjZweDt3aWR0aDoxMDAlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxhIHN0eWxlPVwiY29sb3I6IzY0NjU2Njt3aWR0aDo0MCU7ZGlzcGxheTogaW5saW5lLWJsb2NrO1wiPiIgKyBlbGVtZW50LmxhYmVsICsgIjo8L2E+XG4gICAgICAgICAgICAgICAgICAgIDxhIHN0eWxlPVwidGV4dC1hbGlnbjogcmlnaHQ7Zm9udC1zaXplOjE0cHg7d2lkdGg6NTAlO2Rpc3BsYXk6IGlubGluZS1ibG9jaztcIj4iICsgcHJvcFZhbCArICI8L2E+IjsKCiAgICAgICAgaWYgKGNvbXBhaXJlUmVzdWx0W2VsZW1lbnQucHJvcGVydGllXSA9PSAnPicpIHsKICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50ICsgIjxpbWcgc3JjID0gIiArIHVwVXJsICsgIiBzdHlsZSA9ICd3aWR0aDoyMHB4O2hlaWdodDoxOHB4JyAvPiI7CiAgICAgICAgfSBlbHNlIGlmIChjb21wYWlyZVJlc3VsdFtlbGVtZW50LnByb3BlcnRpZV0gPT0gJzwnKSB7CiAgICAgICAgICBjb250ZW50ID0gY29udGVudCArICI8aW1nIHNyYyA9ICIgKyBkb3duVXJsICsgIiBzdHlsZSA9ICd3aWR0aDoyMHB4O2hlaWdodDoxOHB4JyAvPiI7CiAgICAgICAgfQoKICAgICAgICBjb250ZW50ID0gY29udGVudCArICI8L2Rpdj4iOwogICAgICB9KTsKICAgICAgY29udGVudCA9IGNvbnRlbnQgKyAnPC9kaXY+JzsKICAgICAgcmV0dXJuIGNvbnRlbnQ7CiAgICB9LAogICAgLy8g5by55Ye65qGGCiAgICBhZGRSaWdodFBvcHVwOiBmdW5jdGlvbiBhZGRSaWdodFBvcHVwKGNvb3JkaW5hdGUsIGZlYXR1cmUsIGNvbXBhaXJlRmVhdHVyZSkgewogICAgICB2YXIgdGhpc09iaiA9IHRoaXM7CiAgICAgIHRoaXNPYmoucmVtb3ZlUG9wdXAoKTsgLy8g6I635Y+W5by55Ye65bGCRE9NCgogICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwMicpOwogICAgICB2YXIgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cC1jb250ZW50MicpOwoKICAgICAgaWYgKHRoaXNPYmoub3ZlcmxheSkge30gZWxzZSB7CiAgICAgICAgLy8g5Yib5bu6T3ZlcmxheeW8ueWHuuWxgue7keWumkRPTQogICAgICAgIHRoaXNPYmoub3ZlcmxheSA9IG5ldyBfT3ZlcmxheS5kZWZhdWx0KHsKICAgICAgICAgIGVsZW1lbnQ6IGNvbnRhaW5lcgogICAgICAgIH0pOyAvLyDmt7vliqDliLBtYXAKCiAgICAgICAgdGhpc09iai5tYXBEYXRhLmFkZE92ZXJsYXkodGhpcy5vdmVybGF5KTsKICAgICAgfSAvLyDpgZPot6/kv6Hmga8KCgogICAgICB2YXIgbGF5ZXIgPSBmZWF0dXJlLnByb3BlcnRpZXMubGF5ZXIgPT0gbnVsbCA/ICIiIDogZmVhdHVyZS5wcm9wZXJ0aWVzLmxheWVyOwogICAgICB2YXIgaGFuZGxlID0gZmVhdHVyZS5wcm9wZXJ0aWVzLmhhbmRsZSA9PSBudWxsID8gIiIgOiBmZWF0dXJlLnByb3BlcnRpZXMuaGFuZGxlOwogICAgICB2YXIgbGVuZ3RoID0gZmVhdHVyZS5wcm9wZXJ0aWVzLmxlbmd0aCA9PSBudWxsID8gIiIgOiBNYXRoLmZsb29yKGZlYXR1cmUucHJvcGVydGllcy5sZW5ndGgpICsgIiBtIjsKICAgICAgdmFyIGNhcGFjaXR5ID0gZmVhdHVyZS5wcm9wZXJ0aWVzLmNhcGFjaXR5ID09IG51bGwgPyAiIiA6IGZlYXR1cmUucHJvcGVydGllcy5jYXBhY2l0eSArICcgcGN1L2gnOyAvLyDmlrnlkJHvvIgx5Y2V5ZCR77yMLTHlj43lkJHljZXlkJHvvIww5Y+M5ZCR77yJCgogICAgICB2YXIgZGlyID0gZmVhdHVyZS5wcm9wZXJ0aWVzLmRpciA9PSAxID8gIuWNleWQkSIgOiBmZWF0dXJlLnByb3BlcnRpZXMuZGlyID09IC0xID8gIuWPjeWQkeWNleWQkSIgOiBmZWF0dXJlLnByb3BlcnRpZXMuZGlyID09IDAgPyAi5Y+M5ZCRIiA6ICcnOyAvL+S6pOmAmua1gemHjwoKICAgICAgdmFyIHRyYW5zUG9wQ29udGVudCA9IHRoaXNPYmouYXNzZWJsZVJpZ2h0VHJhbnNQb3BDb250ZW50KGZlYXR1cmUsIGNvbXBhaXJlRmVhdHVyZSwgbGF5ZXIpOwogICAgICB0cmFuc1BvcENvbnRlbnQgPSB0cmFuc1BvcENvbnRlbnQgKyAiPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBzdHlsZT0nZm9udC1zaXplOiAxMHB4O3dpZHRoOjEwMCUnIGlkPSdpbmZvNCc+XG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiaGVpZ2h0OiAyNnB4O3dpZHRoOjEwMCVcIj5cbiAgICAgICAgICAgICAgPGEgc3R5bGU9XCJjb2xvcjojNjQ2NTY2O3dpZHRoOjQ1JTtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XCI+XHU5MDUzXHU4REVGSUQ6PC9hPlxuICAgICAgICAgICAgICA8YSBzdHlsZT1cInRleHQtYWxpZ246IHJpZ2h0O2ZvbnQtc2l6ZToxNHB4O3dpZHRoOjUwJTtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XCI+IiArIGhhbmRsZSArICI8L2E+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJoZWlnaHQ6IDI2cHg7d2lkdGg6MTAwJVwiPlxuICAgICAgICAgICAgICA8YSBzdHlsZT1cImNvbG9yOiM2NDY1NjY7d2lkdGg6NDUlO2Rpc3BsYXk6IGlubGluZS1ibG9jaztcIj5cdTdCNDlcdTdFQTc6PC9hPlxuICAgICAgICAgICAgICA8YSBzdHlsZT1cInRleHQtYWxpZ246IHJpZ2h0O2ZvbnQtc2l6ZToxNHB4O3dpZHRoOjUwJTtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XCI+IiArIGxheWVyICsgIjwvYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBzdHlsZT1cImhlaWdodDogMjZweDt3aWR0aDoxMDAlXCI+XG4gICAgICAgICAgICAgIDxhIHN0eWxlPVwiY29sb3I6IzY0NjU2Njt3aWR0aDo0NSU7ZGlzcGxheTogaW5saW5lLWJsb2NrO1wiPlx1OTU3Rlx1NUVBNjo8L2E+XG4gICAgICAgICAgICAgIDxhIHN0eWxlPVwidGV4dC1hbGlnbjogcmlnaHQ7Zm9udC1zaXplOjE0cHg7d2lkdGg6NTAlO2Rpc3BsYXk6IGlubGluZS1ibG9jaztcIj4iICsgbGVuZ3RoICsgIjwvYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBzdHlsZT1cImhlaWdodDogMjZweDt3aWR0aDoxMDAlXCI+XG4gICAgICAgICAgICAgIDxhIHN0eWxlPVwiY29sb3I6IzY0NjU2Njt3aWR0aDo0NSU7ZGlzcGxheTogaW5saW5lLWJsb2NrO1wiPlx1OTAxQVx1ODg0Q1x1ODBGRFx1NTI5Qjo8L2E+XG4gICAgICAgICAgICAgIDxhIHN0eWxlPVwidGV4dC1hbGlnbjogcmlnaHQ7Zm9udC1zaXplOjE0cHg7d2lkdGg6NTAlO2Rpc3BsYXk6IGlubGluZS1ibG9jaztcIj4iICsgY2FwYWNpdHkgKyAiPC9hPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgPGRpdiBzdHlsZT1cImhlaWdodDogMjZweDt3aWR0aDoxMDAlXCI+XG4gICAgICAgICAgICAgIDxhIHN0eWxlPVwiY29sb3I6IzY0NjU2Njt3aWR0aDo0NSU7ZGlzcGxheTogaW5saW5lLWJsb2NrO1wiPlx1NjVCOVx1NTQxMTo8L2E+XG4gICAgICAgICAgICAgIDxhIHN0eWxlPVwidGV4dC1hbGlnbjogcmlnaHQ7Zm9udC1zaXplOjE0cHg7d2lkdGg6NTAlO2Rpc3BsYXk6IGlubGluZS1ibG9jaztcIj4iICsgZGlyICsgIjwvYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PiI7CiAgICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gdHJhbnNQb3BDb250ZW50OyAvLyDorr7nva7lvLnlh7rlsYLkvY3nva7ljbPlj6/lh7rnjrAKCiAgICAgIHRoaXNPYmoub3ZlcmxheS5zZXRQb3NpdGlvbihjb29yZGluYXRlKTsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luZm8zJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwMicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgfSwKICAgIC8vIOa4hemZpOW8ueWHuuahhgogICAgcmVtb3ZlUG9wdXA6IGZ1bmN0aW9uIHJlbW92ZVBvcHVwKCkgewogICAgICBpZiAodGhpcy5vdmVybGF5KSB7CiAgICAgICAgLy8g6K6+572u5L2N572udW5kZWZpbmVk5Y+v6L6+5Yiw6ZqQ6JeP5riF6Zmk5by55Ye65qGGCiAgICAgICAgdGhpcy5vdmVybGF5LnNldFBvc2l0aW9uKHVuZGVmaW5lZCk7CiAgICAgIH0KICAgIH0sCiAgICByZW1vdmVCdG46IGZ1bmN0aW9uIHJlbW92ZUJ0bigpIHsKICAgICAgaWYgKHRoaXMub3ZlcmxheSkgewogICAgICAgIC8vIOiuvue9ruS9jee9rnVuZGVmaW5lZOWPr+i+vuWIsOmakOiXj+a4hemZpOW8ueWHuuahhgogICAgICAgIHRoaXMub3ZlcmxheS5zZXRQb3NpdGlvbih1bmRlZmluZWQpOwoKICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwJykuc3R5bGUuZGlzcGxheSA9PSAnYmxvY2snKSB7CiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXAnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jbGVhckhpZ2hsaWdodCgpOyAvL+a4hemZpOWvuemdoumrmOS6rgoKICAgICAgICB0aGlzLiRiYXMuJGVtaXQoJ2NsZWFySGlnaGxpZ2h0X1knLCAnMScpOwogICAgICB9CiAgICB9LAogICAgcGFyc2VGZWF0dXJlRGV0YWlsOiBmdW5jdGlvbiBwYXJzZUZlYXR1cmVEZXRhaWwoZmVhdHVyZVJlc3AsIGZlYXR1cmUpIHsKICAgICAgaWYgKCFmZWF0dXJlUmVzcCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB2YXIganNvbk9iaiA9IEpTT04ucGFyc2UoZmVhdHVyZVJlc3ApOwogICAgICB2YXIgZmVhdHVyZXMgPSBqc29uT2JqLmZlYXR1cmVzOwoKICAgICAgaWYgKGZlYXR1cmVzID09IG51bGwgfHwgZmVhdHVyZXMubGVuZ3RoID09IDApIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgdmFyIGNvbXBhaXJlRmVhdHVyZTsKCiAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZmVhdHVyZXMubGVuZ3RoOyBrKyspIHsKICAgICAgICB2YXIgcHJvcGVydGllcyA9IGZlYXR1cmVzW2tdLnByb3BlcnRpZXM7CgogICAgICAgIGlmIChwcm9wZXJ0aWVzLmxheWVyID09IGZlYXR1cmUucHJvcGVydGllcy5sYXllciAmJiBmZWF0dXJlLnByb3BlcnRpZXMuaGFuZGxlID09IHByb3BlcnRpZXMuaGFuZGxlKSB7CiAgICAgICAgICBjb21wYWlyZUZlYXR1cmUgPSBmZWF0dXJlc1trXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGNvbXBhaXJlRmVhdHVyZTsKICAgIH0sCiAgICAvL+agueaNrumBk+i3r0lE5p+l6K+i5a+55q+U5pa55qGI6K+m5oOFCiAgICBhc3NlbWJsZVJpZ2h0Q29tcGFpcmVQb3A6IGZ1bmN0aW9uIGFzc2VtYmxlUmlnaHRDb21wYWlyZVBvcChmZWF0dXJlLCB0aGlzT2JqLCBldnQpIHsKICAgICAgdmFyIHNlbGVjdGVkUGxhbmVWYWwgPSB0aGlzT2JqLmxlZnRTZWxlY3RlZFBsYW5lOwoKICAgICAgaWYgKHNlbGVjdGVkUGxhbmVWYWwgPT0gbnVsbCB8fCBzZWxlY3RlZFBsYW5lVmFsID09IHVuZGVmaW5lZCkgewogICAgICAgIHNlbGVjdGVkUGxhbmVWYWwgPSAxOwogICAgICB9CgogICAgICB2YXIgaGFuZGxlID0gZmVhdHVyZS5wcm9wZXJ0aWVzLmhhbmRsZTsKCiAgICAgIGlmIChoYW5kbGUgPT0gbnVsbCkgewogICAgICAgIHRoaXNPYmouYWRkUmlnaHRQb3B1cChldnQuY29vcmRpbmF0ZSwgZmVhdHVyZSwgbnVsbCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgbGVmdExheWVyTmFtZTsKICAgICAgbmV3TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0udmFsdWUgPT0gc2VsZWN0ZWRQbGFuZVZhbCkgewogICAgICAgICAgbGVmdExheWVyTmFtZSA9IGl0ZW0ubGF5ZXJOYW1lOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICBpZiAoIWxlZnRMYXllck5hbWUpIHsKICAgICAgICB0aGlzT2JqLmFkZFJpZ2h0UG9wdXAoZXZ0LmNvb3JkaW5hdGUsIGZlYXR1cmUsIG51bGwpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHByb3BlcnR5TmFtZSA9ICdUZXN0OmhhbmRsZSc7CiAgICAgIHZhciByZXNwUHJvcGVydGllcyA9ICdsYXllcixoYW5kbGUsbGVuZ3RoLGNhcGFjaXR5LGFiX2Zsb3csYmFfZmxvdyx0b3RfZmxvdyxhYl92b2MsYmFfdm9jLG1heF92b2MsZ2VvbSc7CiAgICAgIHZhciB1cmwgPSBwcm9jZXNzLmVudi5WVUVfQVBQX0dJU19CQVNFX1VSTCArICcvd2ZzP3JlcXVlc3Q9R2V0RmVhdHVyZSZ2ZXJzaW9uPTEuMS4wJnR5cGVOYW1lPScgKyBsZWZ0TGF5ZXJOYW1lICsgJyZwcm9wZXJ0eU5hbWU9JyArIHJlc3BQcm9wZXJ0aWVzICsgJyZvdXRwdXRGb3JtYXQ9SlNPTiZGSUxURVI9PEZpbHRlciB4bWxucz0iaHR0cDovL3d3dy5vcGVuZ2lzLm5ldC9vZ2MiPjxQcm9wZXJ0eUlzRXF1YWxUbz48UHJvcGVydHlOYW1lPicgKyBwcm9wZXJ0eU5hbWUgKyAnPC9Qcm9wZXJ0eU5hbWU+PExpdGVyYWw+JyArIGhhbmRsZSArICc8L0xpdGVyYWw+PC9Qcm9wZXJ0eUlzRXF1YWxUbz48L0ZpbHRlcj4nOyAvL+ivt+axgnVybOWvueavlOaWueahiOmBk+i3r+ivpuaDhQoKICAgICAgZmV0Y2godXJsKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCk7CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGluZm8pIHsKICAgICAgICBpZiAoaW5mbyAhPSBudWxsKSB7CiAgICAgICAgICB2YXIgY29tcGFpcmVGZWF0dXJlID0gdGhpc09iai5wYXJzZUZlYXR1cmVEZXRhaWwoaW5mbywgZmVhdHVyZSk7CiAgICAgICAgICB0aGlzT2JqLmFkZFJpZ2h0UG9wdXAoZXZ0LmNvb3JkaW5hdGUsIGZlYXR1cmUsIGNvbXBhaXJlRmVhdHVyZSk7IC8v5by55Ye65bem6L655by55Ye65qGGCgogICAgICAgICAgdGhpc09iai4kZW1pdCgnYWRkTGVmdFBvcHVwQnlQYXJlbnQnLCBldnQuY29vcmRpbmF0ZSwgY29tcGFpcmVGZWF0dXJlLCBmZWF0dXJlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpc09iai5hZGRSaWdodFBvcHVwKGV2dC5jb29yZGluYXRlLCBmZWF0dXJlLCBudWxsKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOm8oOagh+eCueWHu+WcsOWbvuS6i+S7tgogICAgbWFwQ2xpY2s6IGZ1bmN0aW9uIG1hcENsaWNrKGV2dCkgewogICAgICB2YXIgcGl4ZWwgPSB0aGlzLm1hcERhdGEuZ2V0RXZlbnRQaXhlbChldnQub3JpZ2luYWxFdmVudCk7CiAgICAgIHZhciBmZWF0dXJlID0gdGhpcy5tYXBEYXRhLmZvckVhY2hGZWF0dXJlQXRQaXhlbChwaXhlbCwgZnVuY3Rpb24gKGZlYXR1cmUsIGxheWVyKSB7CiAgICAgICAgcmV0dXJuIGZlYXR1cmU7CiAgICAgIH0pOwoKICAgICAgaWYgKGZlYXR1cmUpIHsKICAgICAgICAvL+aNleaNieWIsOimgee0oOWQju+8jOW8ueahhgogICAgICAgIHZhciBmZWF0dXJlQ29udmVydCA9ICgwLCBfY29tbW9uLmNvbnZlcnRGZWF0dXJlKShmZWF0dXJlKTsKICAgICAgICB0aGlzLmFkZEhpZ2hMaWdodFN0eWxlKGZlYXR1cmUsIHRoaXMsICcnKTsKICAgICAgICB0aGlzLmFzc2VtYmxlUmlnaHRDb21wYWlyZVBvcChmZWF0dXJlQ29udmVydCwgdGhpcywgZXZ0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnJlbW92ZUJ0bigpOwogICAgICB9CiAgICB9LAogICAgYWRkSGlnaExpZ2h0U3R5bGU6IGZ1bmN0aW9uIGFkZEhpZ2hMaWdodFN0eWxlKGNsaWNrRmVhdHVyZSwgdGhpc09iaiwgbnVtKSB7CiAgICAgIHZhciBmZWF0dXJlT2JqID0gW107CiAgICAgIGZlYXR1cmVPYmoucHVzaChjbGlja0ZlYXR1cmUpOwogICAgICB0aGlzLmNsZWFySGlnaGxpZ2h0KCk7CiAgICAgIHZhciBoaWdoTGlnaHRTdHlsZSA9IG5ldyBfc3R5bGUuU3R5bGUoewogICAgICAgIGZpbGw6IG5ldyBfc3R5bGUuRmlsbCh7CiAgICAgICAgICBjb2xvcjogIiNmZmZmMDAiCiAgICAgICAgfSksCiAgICAgICAgc3Ryb2tlOiBuZXcgX3N0eWxlLlN0cm9rZSh7CiAgICAgICAgICBjb2xvcjogIiNmZmZmMDAiLAogICAgICAgICAgd2lkdGg6IDgKICAgICAgICB9KQogICAgICB9KTsKICAgICAgdGhpc09iai5oaWdoTGlnaHRMYXllciA9IG5ldyBfVmVjdG9yMi5kZWZhdWx0KHsKICAgICAgICBuYW1lOiAiZGsiLAogICAgICAgIHNvdXJjZTogbmV3IF9WZWN0b3IuZGVmYXVsdCh7CiAgICAgICAgICBmZWF0dXJlczogZmVhdHVyZU9iagogICAgICAgIH0pLAogICAgICAgIHN0eWxlOiBmdW5jdGlvbiBzdHlsZShmZWF0dXJlLCBzb2x1dGlvbikgewogICAgICAgICAgcmV0dXJuIGhpZ2hMaWdodFN0eWxlOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHRoaXNPYmouaGlnaExpZ2h0TGF5ZXIuc2V0KCJpZCIsICJoaWdobGlnaHRMYXllciIpOwogICAgICB0aGlzLm1hcERhdGEuYWRkTGF5ZXIodGhpc09iai5oaWdoTGlnaHRMYXllcik7CgogICAgICBpZiAobnVtID09PSAnJykgewogICAgICAgIC8v5Y+z6L656auY5LquCiAgICAgICAgdGhpcy4kYmFzLiRlbWl0KCJhZGRMZWZ0SGlnaExpZ2h0U3R5bGUiLCBjbGlja0ZlYXR1cmUsIHRoaXNPYmosICcxJyk7CiAgICAgIH0KICAgIH0sCiAgICAvL+WIoOmZpOmrmOS6ruWbvuWxggogICAgY2xlYXJIaWdobGlnaHQ6IGZ1bmN0aW9uIGNsZWFySGlnaGxpZ2h0KCkgewogICAgICB2YXIgYXJyID0gdGhpcy5tYXBEYXRhLmdldExheWVycygpLmFycmF5XzsKICAgICAgdmFyIGhpZ2hsaWdodExheWVyID0ge307CiAgICAgIGFyci5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0uZ2V0KCJpZCIpID09ICJoaWdobGlnaHRMYXllciIpIHsKICAgICAgICAgIGhpZ2hsaWdodExheWVyID0gaXRlbTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgaWYgKGhpZ2hsaWdodExheWVyICYmIGhpZ2hsaWdodExheWVyLmNsYXNzTmFtZV8pIHsKICAgICAgICB0aGlzLm1hcERhdGEucmVtb3ZlTGF5ZXIoaGlnaGxpZ2h0TGF5ZXIpOwogICAgICB9CiAgICB9LAogICAgaW5pdENvbXBvbmVudEluZm86IGZ1bmN0aW9uIGluaXRDb21wb25lbnRJbmZvKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBwYXJhbSA9IHt9OwogICAgICB0aGlzLm9wdGlvbnMgPSBbXTsKICAgICAgcGFyYW0uYml6S2V5ID0gJ3BsYW5lX2NvbXBhcmUnOwogICAgICAoMCwgX2RlY2lzaW9uLmluaXRUcmVlTGlzdCkocGFyYW0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHZhciByZXNwb25zZURhdGEgPSByZXMuZGF0YVswXS5jaGlsZHJlbjsgLy/liJ3lp4vljJbpobXpnaLpgInmi6npu5jorqTnrKzkuIDkuKoKCiAgICAgICAgcmVzcG9uc2VEYXRhWzFdLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKHMpIHsKICAgICAgICAgIF90aGlzMy5yaWdodFBsYW5lTGlzdC5wdXNoKHsKICAgICAgICAgICAgbGF5ZXJOYW1lOiBzLmxheWVyTmFtZSwKICAgICAgICAgICAgbmFtZTogcy5uYW1lLAogICAgICAgICAgICB2YWx1ZTogcy5pZCwKICAgICAgICAgICAgYml6VmFsOiBzLnBhcmVudElkCiAgICAgICAgICB9KTsKICAgICAgICB9KTsgLy9uZXdsaXN0IOiOt+WPluWFqOmDqOeahOaVsOaNriDnrZvpgInnlKgKCiAgICAgICAgcmVzcG9uc2VEYXRhLmZvckVhY2goZnVuY3Rpb24gKHNzKSB7CiAgICAgICAgICBzcy5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICAgIG5ld0xpc3QucHVzaCh7CiAgICAgICAgICAgICAgbGF5ZXJOYW1lOiByLmxheWVyTmFtZSwKICAgICAgICAgICAgICBuYW1lOiByLm5hbWUsCiAgICAgICAgICAgICAgdmFsdWU6IHIuaWQsCiAgICAgICAgICAgICAgYml6VmFsOiByLnBhcmVudElkCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgcGFyZW50VmFsID0gcmVzcG9uc2VEYXRhWzBdLmlkOwogICAgICAgIF90aGlzMy5sZWZ0U2VsZWN0ZWRQbGFuZSA9IF90aGlzMy5yaWdodFBsYW5lTGlzdFswXS52YWx1ZTsKICAgICAgICBfdGhpczMucmlnaHRQbGFuZSA9IF90aGlzMy5yaWdodFBsYW5lTGlzdFsxXS52YWx1ZTsgLy8g5Yid5aeL5YyW5Zu+5bGCCgogICAgICAgIF90aGlzMy5pbml0VmVjdG9yTGF5ZXIoKTsKICAgICAgfSk7CiAgICB9CiAgfQp9OwpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AACA,oD,CACA;;AACAA;;AACA;AACA;AACA,mB,CACA;;AACA;EACAC,wEADA;EAEAC,WAFA;EAGAC,WAHA;EAIAC,UAJA,CAIA;;AAJA,G,CAQA;;AACA;EACAC;IACAC;EADA;AADA;eAQA;EACAC,IADA,kBACA;IACA;MACAC,kBADA;MAEAC,eACA;QAAAC;QAAAC;QAAAC;QAAAC;MAAA,CADA,EAEA;QAAAH;QAAAC;QAAAC;QAAAC;MAAA,CAFA,EAGA;QAAAH;QAAAC;QAAAC;QAAAC;MAAA,CAHA,EAIA;QAAAH;QAAAC;QAAAG;QAAAD;MAAA,CAJA,EAKA;QAAAH;QAAAC;QAAAG;QAAAD;MAAA,CALA,EAMA;QAAAH;QAAAC;QAAAG;QAAAD;MAAA,CANA,CAFA;MAUAE,cAVA;MAWAC,uBAXA;MAYAC,iBAZA;MAaAC;QACAC,aADA;QAEAC,sBAFA;QAGAC;MAHA,CAbA;MAkBAC;IAlBA;EAoBA,CAtBA;EAuBAC,OAvBA,qBAuBA;IAAA;;IACA;IACA,eAFA,CAGA;;IACA;MACA;IACA,CAFA,EAJA,CAOA;;IACA;MACA;IACA,CAFA;IAGA;MACA;IACA,CAFA;IAIA;MACA;MACAC;MACA;QACA;MACA,CAFA;MAGA;MACA;;MACA;IACA,CATA,EAfA,CA0BA;;IACA;MACA;QACA;QACA;QACAC;UACAxB,iBADA;UAEAG,UAFA;UAEA;UACAsB,mBAHA;UAIAC;QAJA;MAMA;IACA,CAXA,EA3BA,CAwCA;;IACA;MACA;QACA;QACA;QACAF;UACAxB,iBADA;UAEAG,UAFA;UAEA;UACAsB,mBAHA;UAIAC;QAJA;MAMA;IACA,CAXA;IAYAC,yDArDA,CAsDA;;IACAC;MACAD;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;IACA,CATA,CAvDA,CAiEA;;;IACAC;MACAD;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;IACA,CATA;EAUA,CAnGA;EAoGAE;IAEAC,gBAFA,8BAEA;MACA;IACA,CAJA;IAMAC,0BANA,sCAMAC,SANA,EAMAC,KANA,EAMAC,SANA,EAMA;MACAF;MACAC;MACAA;QACA;MACA,CAFA;MAGAA;MACAA;IAEA,CAfA;IAiBA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEAE,cAtFA,0BAsFAC,CAtFA,EAsFA;MACAA;MACA;MACA;QACA;MACA,CAFA;MAGA;IACA,CA7FA;IAgGAC,cAhGA,0BAgGAC,MAhGA,EAgGAC,OAhGA,EAgGA;MACA;QACA;UACA;QACA;;QACA;UACA;UACA;QACA;;QACA;UACA;QACA,CAFA,MAEA;UACA;QACA;MACA,CAbA,CAaA;QACAhB;MACA;IAEA,CAlHA;IAqHAiB,gBArHA,4BAqHAF,MArHA,EAqHAC,OArHA,EAqHAN,KArHA,EAqHAQ,IArHA,EAqHAC,OArHA,EAqHAC,OArHA,EAqHA;MACA;;MACA;QACA;MACA;;MACA;MACA;MACA;;MACA;QACAlB;MACA;;MACAgB;MACA;MACA;IACA,CAnIA;IAuIAG,kBAvIA,8BAuIAL,OAvIA,EAuIAN,KAvIA,EAuIAY,MAvIA,EAuIA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MACA;QACAC;MACA;;MACA;QACAC;MACA;;MAEA;QACA;UACA;UACA;UACA;UACAC;QACA;;QACA;UACA;;UACA;;UACA;UACAA;QACA;MAEA;;MACA;IACA,CAtKA;IAyKAC,eAzKA,2BAyKAC,UAzKA,EAyKAC,OAzKA,EAyKAV,IAzKA,EAyKAW,OAzKA,EAyKAT,OAzKA,EAyKAU,KAzKA,EAyKA;MAAA;;MACA;MACA;QACAC,mBADA;QAEAC,sBAFA;QAGAC,wBAHA;QAIAf;MAJA,wDAKA,QALA,mDAMAW,OANA,mDAOAT,OAPA,gDAQA;QACAU;MADA,EARA,oDAWAF,OAXA;MAaA;QACAM;MADA;MAGAC;MACAC;MACA;IACA,CA9LA;IAgMAC,iBAhMA,6BAgMArB,OAhMA,EAgMA;MACA;MACA;MACA;;MACA;QACAc;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA;;MACA;IACA,CAtNA;IAyNAQ,cAzNA,0BAyNAtB,OAzNA,EAyNA;MACA;MACA;MACA,gBAHA,CAIA;;MACA,6BALA,CAMA;;MACA,qCAPA,CAQA;;MACA,uCATA,CAUA;;MACA,4CAXA,CAYA;;MACA;MAEA;;MACA;QACAuB;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA;;MACAd,YACA;QACAe;UACAV,YADA;UAEAS;QAFA;MADA,EADA,EAvBA,CA+BA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MACA;IACA,CA/QA;IAiRAE,eAjRA,6BAiRA;MAAA;;MACA;QAAA;MAAA,GADA,CAEA;;MACA;MACAC;MACA,iBALA,CAMA;;MACA;;MACAC;QACA;QACA;UACAC;YAAAC;YAAAC;UAAA;QADA;QAIAC;UACAlE,oBADA;UAEAmE,yBAFA;UAGAtD;YACA,2CADA,CAEA;;YACA;;YACA;cACA;cACA;;cACA;gBACA+B;cACA;YACA;;YACA;UACA;QAfA;QAiBAsB;MAEA,CAzBA;IA0BA,CAnTA;IAoTA;IACAE,OArTA,qBAqTA;MACA,mCADA,CAEA;;MACA;QACAC,uBADA;QAEAC,oBAFA;QAGAC;MAHA,GAHA,CAQA;;MACAtD,+BATA,CAUA;;MACAA,6CAXA,CAYA;;MACAA,qCAbA,CAcA;;MACA,mBAfA,CAgBA;;MACA;IACA,CAvUA;IAyUAuD,aAzUA,2BAyUA;MACA;IACA,CA3UA;IA6UAC,eA7UA,6BA6UA;MACA;MACA;MACA;IACA,CAjVA;IAmVAC,gBAnVA,8BAmVA;MACA;MACA;MACA;MACA;MACA;IACA,CAzVA;IA2VAC,gBA3VA,8BA2VA;MACA;MACA;MACA;IACA,CA/VA;IAkWAC,YAlWA,0BAkWA;MACA;MACA;MACA;IACA,CAtWA;IAwWAC,YAxWA,wBAwWAhD,KAxWA,EAwWAY,MAxWA,EAwWA;MACAZ;QACA;QACA;QACA;;QACA;UACAe;QACA;;QACA;UACAA;QACA;;QACA;MACA,CAXA;IAaA,CAtXA;IAwXAkC,YAxXA,wBAwXAjD,KAxXA,EAwXA;MACA;QACAA;QACAA;UACA;UACA;;UACA;YACAe;UACA;;UACA;QACA,CAPA;MAQA;IAEA,CArYA;IAyYAmC,2BAzYA,uCAyYA5C,OAzYA,EAyYA6C,eAzYA,EAyYAC,KAzYA,EAyYA;MACA;;MACA;QACAC;MACA;;MACA;;MACA;;MACA;MAKA;QACA;;QACA;UACA;UACA,wBAFA,CAGA;;UACA;YACAC;UACA;;UACA;YACAA;UACA,CATA,CAUA;;;UACA;;UACA;YACAA;UACA;QACA,CAfA,MAeA;UACAA;QACA;;QACAC,kJACAC,aADA,kHAEAF,OAFA;;QAGA;UACAC;QACA,CAFA,MAEA;UACAA;QACA;;QACAA;MACA,CA7BA;MA8BAA;MACA;IACA,CArbA;IA4bA;IACAE,aA7bA,yBA6bAxC,UA7bA,EA6bAX,OA7bA,EA6bA6C,eA7bA,EA6bA;MACA;MACAO,sBAFA,CAGA;;MACA;MACA;;MACA,sBACA,CADA,MACA;QACA;QACAA;UACAF;QADA,GAFA,CAKA;;QACAE;MAEA,CAfA,CAgBA;;;MACA;MACA;MACA;MACA,iGApBA,CAqBA;;MACA,+HAtBA,CAuBA;;MACA;MACAC,mXAKAC,MALA,iRASAR,KATA,iRAaAS,MAbA,6RAiBAC,QAjBA,kRAqBAC,GArBA;MAwBAR,oCAjDA,CAkDA;;MACAG;MACAhE;MACAA;IACA,CAnfA;IAqfA;IACAsE,WAtfA,yBAsfA;MACA;QACA;QACA;MACA;IACA,CA3fA;IA4fAC,SA5fA,uBA4fA;MACA;QACA;QACA;;QACA;UACAvE;QACA;;QACA,sBANA,CAOA;;QACA;MACA;IACA,CAvgBA;IAygBAwE,kBAzgBA,8BAygBAC,WAzgBA,EAygBA7D,OAzgBA,EAygBA;MACA;QACA;MACA;;MACA;MACA;;MACA;QACA;MACA;;MACA;;MACA;QACA;;QACA,oDACAA,8CADA,EACA;UACA6C;UACA;QACA;MACA;;MACA;IAEA,CA7hBA;IAgiBA;IACAiB,wBAjiBA,oCAiiBA9D,OAjiBA,EAiiBAoD,OAjiBA,EAiiBAW,GAjiBA,EAiiBA;MACA;;MACA;QACAC;MACA;;MACA;;MACA;QACAZ;QACA;MACA;;MACA;MACAa;QACA;UACAC;QACA;MACA,CAJA;;MAKA;QACAd;QACA;MACA;;MACA;MACA;MACA,iGACAc,aADA,GACA,gBADA,GACAC,cADA,GACA,wGADA,GAEAC,YAFA,GAEA,0BAFA,GAEAd,MAFA,GAEA,yCAFA,CAtBA,CAyBA;;MACAe,WACAC,IADA,CACA;QACA;MACA,CAHA,EAIAA,IAJA,CAIA;QACA;UACA;UACAlB,gEAFA,CAGA;;UACAA;QAEA,CANA,MAMA;UACAA;QACA;MACA,CAdA;IAiBA,CA5kBA;IAglBA;IACAmB,QAjlBA,oBAilBAR,GAjlBA,EAilBA;MACA;MACA,wDACA;QACA;MACA,CAHA;;MAIA;QACA;QACA;QACA;QACA;MACA,CALA,MAKA;QACA;MACA;IAEA,CAhmBA;IAimBAS,iBAjmBA,6BAimBAC,YAjmBA,EAimBArB,OAjmBA,EAimBAsB,GAjmBA,EAimBA;MACA;MACAC;MACA;MACA;QACAC;UACA9D;QADA,EADA;QAIAU;UACAV,gBADA;UAEAS;QAFA;MAJA;MASA6B;QACApB,UADA;QAEAnE;UACA+D;QADA,EAFA;QAKAlD;UACA;QACA;MAPA;MASA0E;MACA;;MACA;QACA;QACA;MACA;IACA,CA7nBA;IA8nBA;IACAyB,cA/nBA,4BA+nBA;MACA;MACA;MACAC;QACA;UACAC;QACA;MACA,CAJA;;MAKA;QACA;MACA;IACA,CA1oBA;IA2oBAC,iBA3oBA,+BA2oBA;MAAA;;MACA;MACA;MACAC;MACA;QACA,wCADA,CAEA;;QACAC;UACA;YACAC,sBADA;YAEAnD,YAFA;YAGAoD,WAHA;YAIAC;UAJA;QAMA,CAPA,EAHA,CAWA;;QACAH;UACAI;YACArB;cACAkB,sBADA;cAEAnD,YAFA;cAGAoD,WAHA;cAIAC;YAJA;UAMA,CAPA;QAQA,CATA;QAUA5F;QACA;QACA,mDAxBA,CAyBA;;QACA;MACA,CA3BA;IA4BA;EA3qBA;AApGA,C","names":["proj4","center","minZoom","maxZoom","zoom","source","url","data","rightPlaneList","popTransList","label","propertie","unit","type","maxlength","rightPlane","leftSelectedPlane","vectorLayer","style","line_width","line_stroke","interval","map","mounted","console","view2","rotation","duration","document","window","methods","addMarkTextLayer","changeCompareItemByBizType","parentVal","this_","leftPanel","getPointExtent","n","getMiddlePoint","coords","feature","iniFlowOrVocText","text","offsetX","offsety","initFlowOrVocPoint","isFlow","ab_text","ba_text","styles","createTextStyle","coordinate","roation","offsetx","color","textAlign","textBaseline","font","geometry","style_","styles_","getColorByFeature","getPointsStyle","width","stroke","initVectorLayer","$map","axios","features","featureProjection","dataProjection","$this","name","initMap","layers","target","view","getRightPlane","leftPlaneChange","changeRigthPlane","rightPointerdrag","rightMovvend","showFlowText","hideFlowText","assebleRightTransPopContent","compaireFeature","layer","compaireResult","propVal","content","element","addRightPopup","thisObj","transPopContent","handle","length","capacity","dir","removePopup","removeBtn","parseFeatureDetail","featureResp","assembleRightCompairePop","evt","selectedPlaneVal","newList","leftLayerName","respProperties","propertyName","fetch","then","mapClick","addHighLightStyle","clickFeature","num","featureObj","fill","clearHighlight","arr","highlightLayer","initComponentInfo","param","responseData","layerName","value","bizVal","ss"],"sourceRoot":"src/views/traffic-decision/components","sources":["tab2-right.vue"],"sourcesContent":["<template>\r\n  <div class=\"content\">\r\n    <!--  -->\r\n    <div class=\"select-div\">\r\n      <div class=\"select-title\">右侧方案</div>\r\n      <div>\r\n        <el-select\r\n          v-model=\"rightPlane\"\r\n          placeholder=\"请选择\"\r\n          @change=\"changeRigthPlane\"\r\n        >\r\n          <el-option\r\n            v-for=\"item in rightPlaneList\"\r\n            :key=\"item.key\"\r\n            :label=\"item.name\"\r\n            :value=\"item.value\"\r\n          >\r\n          </el-option>\r\n        </el-select>\r\n      </div>\r\n    </div>\r\n    <div id=\"map2\" ref=\"map2\" style=\"width: 100%; height: 890px\">\r\n      <!--点击查看详情弹框-->\r\n      <div id=\"popup2\" class=\"ol-popup2\">\r\n        <a\r\n          href=\"#\"\r\n          id=\"popup-closer2\"\r\n          class=\"ol-popup-closer2\"\r\n          @click=\"removeBtn\"\r\n        />\r\n        <div id=\"popup-content2\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport 'ol/ol.css'\r\nimport Map from 'ol/Map'\r\nimport * as olControl from 'ol/control'\r\nimport View from 'ol/View'\r\nimport { getWidth, getCenter } from 'ol/extent'\r\nimport TileLayer from 'ol/layer/Tile'\r\nimport WMTS from 'ol/source/WMTS'\r\nimport XYZ from 'ol/source/XYZ'\r\nimport WMTSTileGrid from 'ol/tilegrid/WMTS'\r\nimport Projection from 'ol/proj/Projection'\r\nimport proj4 from 'proj4'\r\nimport { register } from 'ol/proj/proj4';\r\nimport VectorSource from 'ol/source/Vector'\r\nimport { TileWMS } from 'ol/source'\r\nimport VectorLayer from 'ol/layer/Vector'\r\nimport Feature from 'ol/Feature'\r\nimport { Draw } from 'ol/interaction'\r\nimport { Style, Circle, Stroke, Fill, Icon, IconImage, Image, Text } from 'ol/src/style'\r\nimport WKT from 'ol/format/WKT'\r\nimport GeoJSON from 'ol/format/GeoJSON'\r\nimport Overlay from 'ol/Overlay'\r\nimport * as echarts from \"echarts\";\r\nimport axios from 'axios'\r\nimport request from '@/utils/request'\r\nimport tab2LeftVue from './tab2-left.vue'\r\nimport { formatFixNum, convertFeature } from \"@/api/common/common\";\r\nimport { featureCompaire } from \"@/api/decision/plane\";\r\nimport * as turf from '@turf/turf';\r\nimport Point from 'ol/geom/Point';\r\nimport { fromLonLat, toLonLat, transformExtent, transform } from 'ol/proj'\r\nimport LineString from 'ol/geom/LineString';\r\nimport MultiLineString from 'ol/geom/MultiLineString';\r\nimport { initTreeList } from \"@/api/decision-manage/decision\";\r\n//中心坐标\r\nconst centerCordinate = [656813.44256, 3560432.98245]\r\n//坐标定义\r\nproj4.defs(\"EPSG:4548\", \"+proj=tmerc +lat_0=0 +lon_0=117 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs\");\r\nregister(proj4);\r\nlet newList = []\r\nlet parentVal=''\r\n//地图初始化\r\nconst view2 = new View({\r\n  center: transform(centerCordinate, 'EPSG:4548', 'EPSG:3857'),\r\n  minZoom: 10,\r\n  maxZoom: 18,\r\n  zoom: 13.5// 地图初始化的缩放级别\r\n})\r\n\r\n\r\n//高德地图图层\r\nconst gaodeMapLayer = new TileLayer({\r\n  source: new XYZ({\r\n    url: 'http://webst0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scl=2&style=7&x={x}&y={y}&z={z}'\r\n  })\r\n});\r\n\r\n\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      rightPlaneList: [],\r\n      popTransList: [\r\n        { label: 'AB交通量', propertie: 'ab_flow', unit: 'pcu/h', type: 'int' },\r\n        { label: 'BA交通量', propertie: 'ba_flow', unit: 'pcu/h', type: 'int' },\r\n        { label: '总交通量', propertie: 'tot_flow', unit: 'pcu/h', type: 'int' },\r\n        { label: 'AB饱和度', propertie: 'ab_voc', maxlength: 2, type: 'float' },\r\n        { label: 'BA饱和度', propertie: 'ba_voc', maxlength: 2, type: 'float' },\r\n        { label: '最大饱和度', propertie: 'max_voc', maxlength: 2, type: 'float' },\r\n      ],\r\n      rightPlane: '',\r\n      leftSelectedPlane: null,\r\n      vectorLayer: null,\r\n      style: {\r\n        line_width: 3,\r\n        line_stroke: '#459c50',\r\n        interval: 40\r\n      },\r\n      map: null\r\n    }\r\n  },\r\n  mounted () {\r\n    this.initComponentInfo()\r\n    this.initMap();\r\n    // 高亮\r\n    this.$bas.$on(\"addRightHighLightStyle\", (i, j, num) => {\r\n      this.addHighLightStyle(i, j, num)\r\n    })\r\n    //清除高亮\r\n    this.$bas.$on(\"clearHighlight_L\", (i) => {\r\n      this.clearHighlight()\r\n    })\r\n    this.rightPlaneList = this.rightPlaneList.filter((item) => {\r\n      return item.bizVal == parentVal\r\n    })\r\n\r\n    this.$bas.$on(\"leftPlaneChange\", (i) => {\r\n      this.rightPlaneList = JSON.parse(JSON.stringify(newList));\r\n      console.log(this.rightPlaneList);\r\n      this.rightPlaneList = this.rightPlaneList.filter((item) => {\r\n        return item.value != i && item.bizVal == parentVal\r\n      })\r\n      this.rightPlane = this.rightPlaneList[0].value\r\n      this.leftSelectedPlane=i\r\n      this.initVectorLayer()\r\n    })\r\n\r\n    //拖动监听方法\r\n    this.$bas.$on(\"leftPanelDrageChange\", (cordinate, zoom) => {\r\n      if (cordinate && zoom) {\r\n        this.rightCurrentCordinate = cordinate;\r\n        this.rigthtCurrentZoom = zoom;\r\n        view2.animate({\r\n          center: cordinate,\r\n          zoom: zoom, // 缩放级别\r\n          rotation: undefined,\r\n          duration: 10\r\n        })\r\n      }\r\n    })\r\n\r\n    //缩放监听\r\n    this.$bas.$on(\"leftMovvendChange\", (cordinate, zoom) => {\r\n      if (cordinate && zoom) {\r\n        this.rightCurrentCordinate = cordinate;\r\n        this.rigthtCurrentZoom = zoom;\r\n        view2.animate({\r\n          center: cordinate,\r\n          zoom: zoom, // 缩放级别\r\n          rotation: undefined,\r\n          duration: 10\r\n        })\r\n      }\r\n    })\r\n    document.getElementById('popup2').style.display = 'none';\r\n    //交通信息点击按钮\r\n    window.preview3 = function () {\r\n      document.getElementById('info4').style.display = 'block';\r\n      document.getElementById('info3').style.display = 'none';\r\n      document.getElementById('btn3').style.background = '#004AB3';\r\n      document.getElementById('btn4').style.background = '#D3D6DB';\r\n      document.getElementById('info2').style.display = 'block';\r\n      document.getElementById('info1').style.display = 'none';\r\n      document.getElementById('btn1').style.background = '#004AB3';\r\n      document.getElementById('btn2').style.background = '#D3D6DB';\r\n    }\r\n    //基本信息点击按钮\r\n    window.preview4 = function () {\r\n      document.getElementById('info4').style.display = 'none';\r\n      document.getElementById('info3').style.display = 'block';\r\n      document.getElementById('btn4').style.background = '#004AB3';\r\n      document.getElementById('btn3').style.backgroundColor = '#D3D6DB';\r\n      document.getElementById('info2').style.display = 'none';\r\n      document.getElementById('info1').style.display = 'block';\r\n      document.getElementById('btn2').style.background = '#004AB3';\r\n      document.getElementById('btn1').style.backgroundColor = '#D3D6DB';\r\n    }\r\n  },\r\n  methods: {\r\n\r\n    addMarkTextLayer () {\r\n      this.$emit('aquirePointMarkData', this.mapData);\r\n    },\r\n\r\n    changeCompareItemByBizType (parentVal, this_, leftPanel) {\r\n      parentVal=parentVal\r\n      this_.rightPlaneList = JSON.parse(JSON.stringify(newList));\r\n      this_.rightPlaneList = this_.rightPlaneList.filter((item) => {\r\n        return item.bizVal == parentVal && item.value != leftPanel\r\n      })\r\n      this_.rightPlane = this_.rightPlaneList[0].value\r\n      this_.initVectorLayer()\r\n\r\n    },\r\n\r\n    // getPointsByLine (coords, dir) {\r\n    //   let this_ = this;\r\n    //   let styles = [];\r\n    //   let distance_ = this_.style.interval / 2;//首个点放置在距离起点1/2间隔的位置\r\n    //   let pix_start = this_.mapData.getPixelFromCoordinate(coords[0])\r\n    //   let pix_end\r\n    //   for (let i = 1; i < coords.length; i++) {\r\n    //     let coord_, coord_pix;\r\n    //     let style_;\r\n    //     pix_end = this_.mapData.getPixelFromCoordinate(coords[i]);\r\n    //     let dis_start2end = Math.sqrt(Math.pow((pix_start[0] - pix_end[0]), 2) + Math.pow((pix_start[1] - pix_end[1]), 2)) // 计算收尾在屏幕上的距离\r\n    //     if (dis_start2end > distance_) { // 距离大于间隔\r\n    //       // 计算距离开始点位的像素值\r\n    //       coord_pix = [\r\n    //         (distance_ * (pix_end[0] - pix_start[0])) / dis_start2end + pix_start[0],\r\n    //         (distance_ * (pix_end[1] - pix_start[1])) / dis_start2end + pix_start[1]\r\n    //       ];\r\n    //       // 计算经纬度\r\n    //       coord_ = this_.mapData.getCoordinateFromPixel(coord_pix);\r\n    //       var rotation = Math.PI / 2 + Math.atan2(pix_end[1] - pix_start[1], pix_end[0] - pix_start[0]);\r\n    //       if (dir == -1) {\r\n    //         rotation = rotation + Math.PI\r\n    //       }\r\n    //       // 生成样式\r\n    //       style_ = new Style({\r\n    //         // 箭头点的位置\r\n    //         geometry: new Point(coord_),\r\n    //         // 箭头点的样式\r\n    //         image: new Icon({\r\n    //           src: require('@/assets/images/juece/up10-10.png'),\r\n    //           rotateWithView: true,\r\n    //           rotation: rotation,\r\n    //           scale: this.style.line_width / 5,\r\n    //           imgSize: [10, 10]\r\n    //         })\r\n    //       })\r\n    //       //下次循环开始点为当前点\r\n    //       pix_start = coord_pix;\r\n    //       distance_ = this_.style.interval;\r\n    //       i--;\r\n    //     } else if (dis_start2end == distance_) {// 距离等于间隔\r\n    //       var rotation = Math.PI / 2 + Math.atan2(pix_end[1] - pix_start[1], pix_end[0] - pix_start[0])\r\n    //       if (dir == -1) {\r\n    //         rotation = rotation + Math.PI\r\n    //       }\r\n    //       // 生成样式\r\n    //       style_ = new Style({\r\n    //         // 箭头点的位置\r\n    //         geometry: new Point(coords[i]),\r\n    //         // 箭头点的样式\r\n    //         image: new Icon({\r\n    //           src: require('@/assets/images/juece/up10-10.png'),\r\n    //           rotateWithView: true,\r\n    //           rotation: rotation,\r\n    //           scale: this.style.line_width / 5,\r\n    //           imgSize: [10, 10]\r\n    //         })\r\n    //       })\r\n    //       pix_start = pix_end;\r\n    //       distance_ = this_.style.interval;\r\n    //     } else {//距离小于间隔\r\n    //       distance_ = distance_ - dis_start2end;\r\n    //       pix_start = pix_end;\r\n    //     }\r\n    //     style_ && styles.push(style_)\r\n    //   }\r\n    //   return styles\r\n    // },\r\n\r\n    getPointExtent (n) {\r\n      n = n ? n : 1.2;\r\n      let view = this.mapData.getView();\r\n      let mapsize = this.mapData.getSize().map(it_ => {\r\n        return it_ * n\r\n      });\r\n      return view.calculateExtent(mapsize);\r\n    },\r\n\r\n\r\n    getMiddlePoint (coords, feature) {\r\n      try {\r\n        if (coords == null || coords.length == 0 || coords == undefined) {\r\n          return null;\r\n        }\r\n        if (coords.length <= 3) {\r\n          var point_features = turf.points(feature.getGeometry().getCoordinates()[0]);\r\n          return new Point(turf.center(point_features).geometry.coordinates);\r\n        }\r\n        if (coords.length % 2 == 0) {\r\n          return new Point(coords[coords.length / 2])\r\n        } else {\r\n          return new Point(coords[Math.ceil(coords.length / 2)])\r\n        }\r\n      } catch (err) {\r\n        console.log(err)\r\n      }\r\n\r\n    },\r\n\r\n\r\n    iniFlowOrVocText (coords, feature, this_, text, offsetX, offsety) {\r\n      let centerPoint = this.getMiddlePoint(coords, feature);\r\n      if (!centerPoint) {\r\n        return null;\r\n      }\r\n      let pix_start = this_.mapData.getPixelFromCoordinate(coords[0])\r\n      let pix_end = this_.mapData.getPixelFromCoordinate(centerPoint.flatCoordinates);\r\n      var rotation = Math.PI + Math.atan2(pix_end[1] - pix_start[1], pix_end[0] - pix_start[0]);\r\n      if (pix_end[0] > pix_start[0]) {\r\n        rotation = rotation + Math.PI\r\n      }\r\n      text = text + \"\";\r\n      let color = this_.getColorByFeature(feature);\r\n      return this.createTextStyle(centerPoint, rotation, text, offsetX, offsety, color);\r\n    },\r\n\r\n\r\n\r\n    initFlowOrVocPoint (feature, this_, isFlow) {\r\n      let coords = feature.getGeometry().getCoordinates();\r\n      let styles = [];\r\n      let extent_ = this_.getPointExtent();\r\n      let line_ = turf.multiLineString(coords);\r\n      let line_clip_arr = turf.bboxClip(line_, extent_)\r\n      let ab_text = isFlow ? feature.get(\"ab_flow\") : feature.get(\"ab_voc\");\r\n      let ba_text = isFlow ? feature.get(\"ba_flow\") : feature.get(\"ba_voc\");\r\n      if (ab_text != null && ab_text != '') {\r\n        ab_text = isFlow ? Math.floor(ab_text) : formatFixNum(ab_text, 2);\r\n      }\r\n      if (ba_text != null && ba_text != '') {\r\n        ba_text = isFlow ? Math.floor(ba_text) : formatFixNum(ba_text, 2);\r\n      }\r\n\r\n      if (line_clip_arr.geometry.type == \"LineString\") {\r\n        if (ab_text != null && ab_text != '') {\r\n          let offsetX = 15;\r\n          let offsety = 15;\r\n          let style_ab = this_.iniFlowOrVocText(line_clip_arr.geometry.coordinates, feature, this_, ab_text, offsetX, offsety);\r\n          styles = styles.concat(style_ab)\r\n        }\r\n        if (ba_text != null && ba_text != '') {\r\n          let offsetX = -15;\r\n          let offsety = -15;\r\n          let style_ba = this_.iniFlowOrVocText(line_clip_arr.geometry.coordinates, feature, this_, ba_text, offsetX, offsety);\r\n          styles = styles.concat(style_ba)\r\n        }\r\n\r\n      }\r\n      return styles;\r\n    },\r\n\r\n\r\n    createTextStyle (coordinate, roation, text, offsetx, offsety, color) {\r\n      let styles_ = [];\r\n      let text_ = new Text({\r\n        textAlign: 'center',\r\n        textBaseline: 'middle',\r\n        font: 'normal 15px 微软雅黑',\r\n        text: text,\r\n        textBaseline: \"middle\", //文本基线\r\n        offsetY: offsetx,\r\n        offsetX: offsety,\r\n        fill: new Fill({\r\n          color: color\r\n        }),\r\n        rotation: roation,\r\n      })\r\n      let style_ = new Style({\r\n        geometry: coordinate,\r\n      })\r\n      style_.setText(text_)\r\n      styles_.push(style_)\r\n      return styles_;\r\n    },\r\n\r\n    getColorByFeature (feature) {\r\n      // 饱和度\r\n      var max_voc = feature.get(\"max_voc\");\r\n      var color = this.style.line_stroke;\r\n      if (max_voc > 0 && max_voc <= 0.25) {\r\n        color = '#185817';\r\n      } else if (max_voc > 0.25 && max_voc <= 0.5) {\r\n        color = '#61a43a';\r\n      } else if (max_voc > 0.5 && max_voc <= 0.75) {\r\n        color = '#cfe05d';\r\n      } else if (max_voc > 0.75 && max_voc <= 1) {\r\n        color = '#d8c964';\r\n      } else if (max_voc > 1 && max_voc <= 1.25) {\r\n        color = '#d79550';\r\n      } else if (max_voc > 1.25 && max_voc <= 1.5) {\r\n        color = '#c75b41';\r\n      } else if (max_voc > 1.5 && max_voc <= 1.75) {\r\n        color = '#c75b41';\r\n      } else if (max_voc > 1.75) {\r\n        color = '#000000';\r\n      }\r\n      return color;\r\n    },\r\n\r\n\r\n    getPointsStyle (feature) {\r\n      let coords = feature.getGeometry().getCoordinates();\r\n      let this_ = this;\r\n      let styles = [];\r\n      // 方向（1单向，-1反向单向，0双向）\r\n      var dir = feature.get(\"dir\");\r\n      // 饱和度\r\n      var max_voc = feature.get(\"max_voc\");\r\n      // 流量\r\n      var tot_flow = feature.get(\"tot_flow\");\r\n      // 颜色默认值\r\n      var color = this.getColorByFeature(feature);\r\n      // 粗细默认值\r\n      var width = this_.style.line_width;\r\n\r\n      var pec = 2;\r\n      if (tot_flow > 0 && tot_flow <= 1250) {\r\n        width = 1 * pec;\r\n      } else if (tot_flow > 1250 && tot_flow <= 2500) {\r\n        width = 2 * pec;\r\n      } else if (tot_flow >= 2500) {\r\n        width = 4 * pec;\r\n      }\r\n      styles.push(\r\n        new Style({\r\n          stroke: new Stroke({\r\n            color: color,\r\n            width: width,\r\n          }),\r\n        })\r\n      )\r\n      // let extent_ = this.getPointExtent();\r\n      // let line_ = turf.multiLineString(coords);\r\n      // let line_clip_arr = turf.bboxClip(line_, extent_)\r\n      // if (line_clip_arr && line_clip_arr.geometry) {\r\n      //   if (line_clip_arr.geometry.type == \"LineString\") {\r\n      //     let style_ = this_.getPointsByLine(line_clip_arr.geometry.coordinates, dir);\r\n      //     if (style_ instanceof Array) {\r\n      //       styles = styles.concat(style_)\r\n      //     } else {\r\n      //       styles.push(style_)\r\n      //     }\r\n      //   } else if (line_clip_arr.geometry.type == \"MultiLineString\") {\r\n      //     line_clip_arr.geometry.coordinates.forEach(coords => {\r\n      //       let style_ = this_.getPointsByLine(coords, dir)\r\n      //       if (style_ instanceof Array) {\r\n      //         styles = styles.concat(style_)\r\n      //       } else {\r\n      //         styles.push(style_)\r\n      //       }\r\n      //     })\r\n      //   }\r\n      // }\r\n      return styles\r\n    },\r\n\r\n    initVectorLayer () {\r\n      let planeInfo = this.rightPlaneList.find(item => item.value == this.rightPlane)\r\n      // 初始化拿到公共数据\r\n      var $map = this.mapData;\r\n      $map.removeLayer(this.vectorLayer);\r\n      var $this = this;\r\n      // 请求数据\r\n      var url = process.env.VUE_APP_GIS_BASE_URL + '/Test/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=' + encodeURI(planeInfo.layerName) + '&maxFeatures=500000000&outputFormat=application%2Fjson';\r\n      axios.get(url, null).then(function (res) {\r\n        var featuresData = res.data;\r\n        var vectorSource = new VectorSource({\r\n          features: (new GeoJSON({ featureProjection: 'EPSG:3857', dataProjection: 'EPSG:4548' })).readFeatures(featuresData)\r\n        });\r\n\r\n        $this.vectorLayer = new VectorLayer({\r\n          source: vectorSource,\r\n          name: planeInfo.layerName,\r\n          style: (feature, solution) => {\r\n            let styles = $this.getPointsStyle(feature);\r\n            //根据文字控制按钮新增文字样式\r\n            let activeBtn = $this.$parent.$parent.$parent.activeBtn;\r\n            if (activeBtn != '' && activeBtn != 3) {\r\n              let isFlow = activeBtn == 3;\r\n              let flowStyle = $this.initFlowOrVocPoint(feature, $this, isFlow)\r\n              if (flowStyle != null) {\r\n                styles = styles.concat(flowStyle);\r\n              }\r\n            }\r\n            return styles;\r\n          }\r\n        })\r\n        $this.mapData.addLayer($this.vectorLayer);\r\n\r\n      });\r\n    },\r\n    // 初始化地图\r\n    initMap () {\r\n      const mapContainer = this.$refs.map2\r\n      //将图层加入Map\r\n      let map = new Map({\r\n        layers: [gaodeMapLayer],\r\n        target: mapContainer,\r\n        view: view2\r\n      });\r\n      // 添加鼠标点击事件\r\n      map.on('click', this.mapClick);\r\n      // 拖动监听\r\n      map.on('pointerdrag', this.rightPointerdrag);\r\n      // 缩放监听\r\n      map.on('moveend', this.rightMovvend);\r\n      // 保存地图\r\n      this.mapData = map\r\n      //添加文字标注\r\n      this.addMarkTextLayer();\r\n    },\r\n\r\n    getRightPlane () {\r\n      return this.rightPlane;\r\n    },\r\n\r\n    leftPlaneChange () {\r\n      this.mapData.removeLayer(this.vectorLayer);\r\n      this.initVectorLayer();\r\n      this.mapData.addLayer(this.vectorLayer);\r\n    },\r\n\r\n    changeRigthPlane () {\r\n      this.removePopup();\r\n      this.mapData.removeLayer(this.vectorLayer);\r\n      this.initVectorLayer();\r\n      this.mapData.addLayer(this.vectorLayer);\r\n      this.$bas.$emit(\"rightPlaneChange\", this.rightPlane)\r\n    },\r\n\r\n    rightPointerdrag () {\r\n      this.rightCurrentCordinate = view2.getCenter();\r\n      this.rigthtCurrentZoom = view2.getZoom()\r\n      this.$bas.$emit(\"rightPanelDrageChange\", this.rightCurrentCordinate, this.rigthtCurrentZoom)\r\n    },\r\n\r\n\r\n    rightMovvend () {\r\n      this.rightCurrentCordinate = view2.getCenter();\r\n      this.rigthtCurrentZoom = view2.getZoom()\r\n      this.$bas.$emit(\"rightMovvendChange\", this.rightCurrentCordinate, this.rigthtCurrentZoom)\r\n    },\r\n\r\n    showFlowText (this_, isFlow) {\r\n      this_.vectorLayer.setStyle((feature, solution) => {\r\n        let styles = [];\r\n        let pointArrowStyle = this_.getPointsStyle(feature);\r\n        let flowStyle = this_.initFlowOrVocPoint(feature, this_, isFlow)\r\n        if (pointArrowStyle != null && pointArrowStyle.length > 0) {\r\n          styles = styles.concat(pointArrowStyle)\r\n        }\r\n        if (flowStyle != null && flowStyle.length > 0) {\r\n          styles = styles.concat(flowStyle)\r\n        }\r\n        return styles;\r\n      })\r\n\r\n    },\r\n\r\n    hideFlowText (this_) {\r\n      if (this_.vectorLayer) {\r\n        this_.vectorLayer.setStyle(null);\r\n        this_.vectorLayer.setStyle((feature, solution) => {\r\n          let styles = [];\r\n          let pointArrowStyle = this_.getPointsStyle(feature);\r\n          if (pointArrowStyle != null && pointArrowStyle.length > 0) {\r\n            styles = styles.concat(pointArrowStyle)\r\n          }\r\n          return styles;\r\n        })\r\n      }\r\n\r\n    },\r\n\r\n\r\n\r\n    assebleRightTransPopContent (feature, compaireFeature, layer) {\r\n      let compaireResult = {}\r\n      if (compaireFeature != null && compaireFeature != undefined) {\r\n        compaireResult = featureCompaire(feature.properties, compaireFeature.properties);\r\n      }\r\n      let downUrl = require('@/assets/images/nav/down.png');\r\n      let upUrl = require('@/assets/images/nav/up.png');\r\n      let content = `<div style='color:#121924;font-weight: bold;width:100%;z-index:4;height:95px;padding:6px;font-size: 15px'>` + layer + `\r\n        <div style = 'margin-top:10px' ><button id='btn3' style='margin-right:10px;border: none;height: 28px;line-height: 28px;border-radius: 4px;width: 80px;background: #004AB3;color: #ffffff;' onclick=\"preview3()\">基本信息</button>\r\n            <button id='btn4' style=\"border: none;height: 28px;line-height: 28px;border-radius: 4px;width: 80px;background: #D3D6DB;color: #ffffff;\" onclick=\"preview4()\">交通信息</button></div>\r\n            </div>\r\n        <div style='font-size: 10px;width:100%' id='info3'>`\r\n      this.popTransList.forEach(element => {\r\n        let propVal = feature.properties[element.propertie];\r\n        if (propVal != null) {\r\n          let maxLen = element.maxlength;\r\n          let type = element.type;\r\n          //格式化\r\n          if (maxLen != null && type == 'float') {\r\n            propVal = formatFixNum(propVal, maxLen)\r\n          }\r\n          if (type == 'int') {\r\n            propVal = Math.floor(propVal)\r\n          }\r\n          //拼接单位\r\n          let unit = element.unit;\r\n          if (unit != null && propVal != null) {\r\n            propVal = propVal + \"&nbsp\" + unit;\r\n          }\r\n        } else {\r\n          propVal = '';\r\n        }\r\n        content = content + `<div style=\"height: 26px;width:100%\">\r\n                    <a style=\"color:#646566;width:40%;display: inline-block;\">`+ element.label + `:</a>\r\n                    <a style=\"text-align: right;font-size:14px;width:50%;display: inline-block;\">`+ propVal + `</a>`\r\n        if (compaireResult[element.propertie] == '>') {\r\n          content = content + `<img src = ` + upUrl + ` style = 'width:20px;height:18px' />`\r\n        } else if (compaireResult[element.propertie] == '<') {\r\n          content = content + `<img src = ` + downUrl + ` style = 'width:20px;height:18px' />`\r\n        }\r\n        content = content + `</div>`\r\n      });\r\n      content = content + '</div>';\r\n      return content;\r\n    },\r\n\r\n\r\n\r\n\r\n\r\n\r\n    // 弹出框\r\n    addRightPopup (coordinate, feature, compaireFeature) {\r\n      let thisObj = this;\r\n      thisObj.removePopup()\r\n      // 获取弹出层DOM\r\n      let container = document.getElementById('popup2')\r\n      let content = document.getElementById('popup-content2')\r\n      if (thisObj.overlay) {\r\n      } else {\r\n        // 创建Overlay弹出层绑定DOM\r\n        thisObj.overlay = new Overlay({\r\n          element: container\r\n        })\r\n        // 添加到map\r\n        thisObj.mapData.addOverlay(this.overlay)\r\n\r\n      }\r\n      // 道路信息\r\n      let layer = feature.properties.layer == null ? \"\" : feature.properties.layer;\r\n      let handle = feature.properties.handle == null ? \"\" : feature.properties.handle;\r\n      let length = feature.properties.length == null ? \"\" : Math.floor(feature.properties.length) + \" m\";\r\n      let capacity = feature.properties.capacity == null ? \"\" : feature.properties.capacity + ' pcu/h';\r\n      // 方向（1单向，-1反向单向，0双向）\r\n      let dir = feature.properties.dir == 1 ? \"单向\" : feature.properties.dir == -1 ? \"反向单向\" : feature.properties.dir == 0 ? \"双向\" : '';\r\n      //交通流量\r\n      let transPopContent = thisObj.assebleRightTransPopContent(feature, compaireFeature, layer);\r\n      transPopContent = transPopContent + `</div>\r\n          </div>\r\n          <div style='font-size: 10px;width:100%' id='info4'>\r\n            <div style=\"height: 26px;width:100%\">\r\n              <a style=\"color:#646566;width:45%;display: inline-block;\">道路ID:</a>\r\n              <a style=\"text-align: right;font-size:14px;width:50%;display: inline-block;\">`+ handle + `</a>\r\n            </div>\r\n            <div style=\"height: 26px;width:100%\">\r\n              <a style=\"color:#646566;width:45%;display: inline-block;\">等级:</a>\r\n              <a style=\"text-align: right;font-size:14px;width:50%;display: inline-block;\">`+ layer + `</a>\r\n            </div>\r\n            <div style=\"height: 26px;width:100%\">\r\n              <a style=\"color:#646566;width:45%;display: inline-block;\">长度:</a>\r\n              <a style=\"text-align: right;font-size:14px;width:50%;display: inline-block;\">`+ length + `</a>\r\n            </div>\r\n            <div style=\"height: 26px;width:100%\">\r\n              <a style=\"color:#646566;width:45%;display: inline-block;\">通行能力:</a>\r\n              <a style=\"text-align: right;font-size:14px;width:50%;display: inline-block;\">`+ capacity + `</a>\r\n            </div>\r\n             <div style=\"height: 26px;width:100%\">\r\n              <a style=\"color:#646566;width:45%;display: inline-block;\">方向:</a>\r\n              <a style=\"text-align: right;font-size:14px;width:50%;display: inline-block;\">`+ dir + `</a>\r\n            </div>\r\n          </div>`;\r\n      content.innerHTML = transPopContent;\r\n      // 设置弹出层位置即可出现\r\n      thisObj.overlay.setPosition(coordinate)\r\n      document.getElementById('info3').style.display = 'none';\r\n      document.getElementById('popup2').style.display = 'block';\r\n    },\r\n\r\n    // 清除弹出框\r\n    removePopup () {\r\n      if (this.overlay) {\r\n        // 设置位置undefined可达到隐藏清除弹出框\r\n        this.overlay.setPosition(undefined)\r\n      }\r\n    },\r\n    removeBtn () {\r\n      if (this.overlay) {\r\n        // 设置位置undefined可达到隐藏清除弹出框\r\n        this.overlay.setPosition(undefined)\r\n        if (document.getElementById('popup').style.display == 'block') {\r\n          document.getElementById('popup').style.display = 'none'\r\n        }\r\n        this.clearHighlight()\r\n        //清除对面高亮\r\n        this.$bas.$emit('clearHighlight_Y', '1')\r\n      }\r\n    },\r\n\r\n    parseFeatureDetail (featureResp, feature) {\r\n      if (!featureResp) {\r\n        return null;\r\n      }\r\n      var jsonObj = JSON.parse(featureResp);\r\n      var features = jsonObj.features;\r\n      if (features == null || features.length == 0) {\r\n        return null;\r\n      }\r\n      let compaireFeature;\r\n      for (let k = 0; k < features.length; k++) {\r\n        let properties = features[k].properties;\r\n        if (properties.layer == feature.properties.layer\r\n          && feature.properties.handle == properties.handle) {\r\n          compaireFeature = features[k];\r\n          break;\r\n        }\r\n      }\r\n      return compaireFeature;\r\n\r\n    },\r\n\r\n\r\n    //根据道路ID查询对比方案详情\r\n    assembleRightCompairePop (feature, thisObj, evt) {\r\n      let selectedPlaneVal = thisObj.leftSelectedPlane;\r\n      if (selectedPlaneVal == null || selectedPlaneVal == undefined) {\r\n        selectedPlaneVal = 1;\r\n      }\r\n      let handle = feature.properties.handle\r\n      if (handle == null) {\r\n        thisObj.addRightPopup(evt.coordinate, feature, null);\r\n        return;\r\n      }\r\n      let leftLayerName;\r\n      newList.forEach(item => {\r\n        if (item.value == selectedPlaneVal) {\r\n          leftLayerName = item.layerName\r\n        }\r\n      })\r\n      if (!leftLayerName) {\r\n        thisObj.addRightPopup(evt.coordinate, feature, null);\r\n        return;\r\n      }\r\n      let propertyName = 'Test:handle';\r\n      let respProperties = 'layer,handle,length,capacity,ab_flow,ba_flow,tot_flow,ab_voc,ba_voc,max_voc,geom';\r\n      let url = process.env.VUE_APP_GIS_BASE_URL + '/wfs?request=GetFeature&version=1.1.0&typeName='\r\n        + leftLayerName + '&propertyName=' + respProperties + '&outputFormat=JSON&FILTER=<Filter xmlns=\"http://www.opengis.net/ogc\"><PropertyIsEqualTo><PropertyName>'\r\n        + propertyName + '</PropertyName><Literal>' + handle + '</Literal></PropertyIsEqualTo></Filter>'\r\n      //请求url对比方案道路详情\r\n      fetch(url)\r\n        .then(function (response) {\r\n          return response.text();\r\n        })\r\n        .then(function (info) {\r\n          if (info != null) {\r\n            let compaireFeature = thisObj.parseFeatureDetail(info, feature);\r\n            thisObj.addRightPopup(evt.coordinate, feature, compaireFeature);\r\n            //弹出左边弹出框\r\n            thisObj.$emit('addLeftPopupByParent', evt.coordinate, compaireFeature, feature);\r\n\r\n          } else {\r\n            thisObj.addRightPopup(evt.coordinate, feature, null);\r\n          }\r\n        })\r\n\r\n\r\n    },\r\n\r\n\r\n\r\n    // 鼠标点击地图事件\r\n    mapClick (evt) {\r\n      let pixel = this.mapData.getEventPixel(evt.originalEvent);\r\n      let feature = this.mapData.forEachFeatureAtPixel(pixel,\r\n        function (feature, layer) {\r\n          return feature;\r\n        });\r\n      if (feature) {\r\n        //捕捉到要素后，弹框\r\n        let featureConvert = convertFeature(feature);\r\n        this.addHighLightStyle(feature, this, '')\r\n        this.assembleRightCompairePop(featureConvert, this, evt);\r\n      } else {\r\n        this.removeBtn();\r\n      }\r\n\r\n    },\r\n    addHighLightStyle (clickFeature, thisObj, num) {\r\n      let featureObj = [];\r\n      featureObj.push(clickFeature);\r\n      this.clearHighlight();\r\n      let highLightStyle = new Style({\r\n        fill: new Fill({\r\n          color: \"#ffff00\",\r\n        }),\r\n        stroke: new Stroke({\r\n          color: \"#ffff00\",\r\n          width: 8\r\n        }),\r\n      })\r\n      thisObj.highLightLayer = new VectorLayer({\r\n        name: \"dk\",\r\n        source: new VectorSource({\r\n          features: featureObj,\r\n        }),\r\n        style: (feature, solution) => {\r\n          return highLightStyle;\r\n        }\r\n      })\r\n      thisObj.highLightLayer.set(\"id\", \"highlightLayer\")\r\n      this.mapData.addLayer(thisObj.highLightLayer)\r\n      if (num === '') {\r\n        //右边高亮\r\n        this.$bas.$emit(\"addLeftHighLightStyle\", clickFeature, thisObj, '1')\r\n      }\r\n    },\r\n    //删除高亮图层\r\n    clearHighlight () {\r\n      let arr = this.mapData.getLayers().array_\r\n      let highlightLayer = {}\r\n      arr.forEach(item => {\r\n        if (item.get(\"id\") == \"highlightLayer\") {\r\n          highlightLayer = item\r\n        }\r\n      })\r\n      if (highlightLayer && highlightLayer.className_) {\r\n        this.mapData.removeLayer(highlightLayer)\r\n      }\r\n    },\r\n    initComponentInfo () {\r\n      let param = {};\r\n      this.options=[]\r\n      param.bizKey = 'plane_compare'\r\n      initTreeList(param).then(res=> {\r\n        let responseData = res.data[0].children;\r\n        //初始化页面选择默认第一个\r\n        responseData[1].children.forEach(s=>{\r\n          this.rightPlaneList.push({\r\n            layerName: s.layerName,\r\n            name:s.name, \r\n            value: s.id,\r\n            bizVal: s.parentId\r\n          })\r\n        })\r\n        //newlist 获取全部的数据 筛选用\r\n        responseData.forEach(ss=>{\r\n          ss.children.forEach(r=>{\r\n            newList.push({\r\n            layerName: r.layerName,\r\n            name:r.name, \r\n            value: r.id,\r\n            bizVal: r.parentId,\r\n          })\r\n        })\r\n        })\r\n      parentVal=responseData[0].id\r\n      this.leftSelectedPlane=this.rightPlaneList[0].value\r\n      this.rightPlane=this.rightPlaneList[1].value\r\n      // 初始化图层\r\n      this.initVectorLayer();\r\n      });\r\n    },\r\n\r\n  }\r\n\r\n\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '~@/assets/styles/popup.scss';\r\n@import '~@/assets/styles/traffic.scss';\r\n.content {\r\n  position: relative;\r\n}\r\n.select-div {\r\n  left: 28px;\r\n  top: 70px;\r\n  padding: 10px 16px 0 16px;\r\n}\r\n</style>\r\n"]}]}