{"remainingRequest":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\proj\\project_manage\\project-ui\\src\\views\\config\\fileDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\proj\\project_manage\\project-ui\\src\\views\\config\\fileDetail.vue","mtime":1663479653276},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663230084016},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1663230086097},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1663230084016},{"path":"D:\\work\\proj\\project_manage\\project-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1663230087832}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBsaXN0SW5mbywgZ2V0SW5mbywgZGVsSW5mbywgYWRkSW5mbywgdXBkYXRlSW5mbywgdXBsb2FkIH0gZnJvbSAiQC9hcGkvY29uZmlnL2ZpbGUiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJJbmZvIiwNCiAgZGljdHM6IFsnc3lzX2ZpbGVfdHlwZScsICdzeXNfbGF5ZXJfZmlsZV90eXBlJ10sDQogIGRhdGEgKCkgew0KICAgIHJldHVybiB7DQogICAgICAvLyDpga7nvanlsYINCiAgICAgIGxvYWRpbmc6IHRydWUsDQogICAgICAvLyDpgInkuK3mlbDnu4QNCiAgICAgIGlkczogW10sDQogICAgICAvLyDpnZ7ljZXkuKrnpoHnlKgNCiAgICAgIHNpbmdsZTogdHJ1ZSwNCiAgICAgIC8vIOmdnuWkmuS4quemgeeUqA0KICAgICAgbXVsdGlwbGU6IHRydWUsDQogICAgICBvcGVyYXRpb246IG51bGwsDQogICAgICAvLyDmlK/mjIHmlofku7blpJrkuKrkuIrkvKANCiAgICAgIGZpbGVNdWx0aXBsZTogZmFsc2UsDQogICAgICAvLyDmmL7npLrmkJzntKLmnaHku7YNCiAgICAgIHNob3dTZWFyY2g6IHRydWUsDQogICAgICAvLyDmgLvmnaHmlbANCiAgICAgIHRvdGFsOiAwLA0KICAgICAgLy8g5paH5Lu25L+h5oGv6KGo5qC85pWw5o2uDQogICAgICBpbmZvTGlzdDogW10sDQogICAgICBmaWxlczogW10sDQogICAgICAvLyDlvLnlh7rlsYLmoIfpopgNCiAgICAgIHRpdGxlOiAiIiwNCiAgICAgIC8vIOaYr+WQpuaYvuekuuW8ueWHuuWxgg0KICAgICAgb3BlbjogZmFsc2UsDQogICAgICAvLyDmn6Xor6Llj4LmlbANCiAgICAgIHF1ZXJ5UGFyYW1zOiB7DQogICAgICAgIHBhZ2VOdW06IDEsDQogICAgICAgIHBhZ2VTaXplOiAxMCwNCiAgICAgICAgZmlsZVBhdGg6IG51bGwsDQogICAgICAgIGxheWVyTmFtZTogbnVsbCwNCiAgICAgICAgbGF5ZXJUeXBlOiBudWxsLA0KICAgICAgICBmaWxlVHlwZTogbnVsbCwNCiAgICAgIH0sDQogICAgICAvLyDooajljZXlj4LmlbANCiAgICAgIGZvcm06IHt9LA0KICAgICAgLy8g6KGo5Y2V5qCh6aqMDQogICAgICBydWxlczogew0KICAgICAgICBjb21wb25lbnRJZDogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLnu4Tku7ZJROS4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJibHVyIiB9DQogICAgICAgIF0sDQogICAgICAgIGZpbGVUeXBlOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuaWh+S7tuexu+Wei+S4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJibHVyIiB9DQogICAgICAgIF0sDQogICAgICB9DQogICAgfTsNCiAgfSwNCiAgY3JlYXRlZCAoKSB7DQogICAgdGhpcy5nZXRMaXN0KCk7DQogIH0sDQoNCiAgbWV0aG9kczogew0KDQoNCg0KICAgIGh0dHBSZXF1ZXN0IChvcHRpb24pIHsNCg0KICAgICAgaWYgKHRoaXMub3BlcmF0aW9uID09ICd1cGRhdGUnKSB7DQogICAgICAgIHRoaXMuZmlsZXMgPSBbXTsNCiAgICAgIH0NCiAgICAgIHRoaXMuZmlsZXMucHVzaCh7DQogICAgICAgIG5hbWU6IG9wdGlvbi5maWxlLm5hbWUsDQogICAgICAgIHVybDogb3B0aW9uLmZpbGUubmFtZSwNCiAgICAgICAgZmlsZTogb3B0aW9uLmZpbGUNCiAgICAgIH0pDQoNCiAgICB9LA0KDQogICAgLy8g5LiK5Lyg6aKE5aSE55CGDQogICAgYmVmb3JlVXBsb2FkIChmaWxlKSB7DQoNCiAgICB9LA0KDQoNCiAgICAvKiog5p+l6K+i5paH5Lu25L+h5oGv5YiX6KGoICovDQogICAgZ2V0TGlzdCAoKSB7DQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgbGlzdEluZm8odGhpcy5xdWVyeVBhcmFtcykudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgIHRoaXMuaW5mb0xpc3QgPSByZXNwb25zZS5yb3dzOw0KICAgICAgICB0aGlzLnRvdGFsID0gcmVzcG9uc2UudG90YWw7DQogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgICAgfSk7DQogICAgfSwNCiAgICAvLyDlj5bmtojmjInpkq4NCiAgICBjYW5jZWwgKCkgew0KICAgICAgdGhpcy5vcGVuID0gZmFsc2U7DQogICAgICB0aGlzLnJlc2V0KCk7DQogICAgfSwNCiAgICAvLyDooajljZXph43nva4NCiAgICByZXNldCAoKSB7DQogICAgICB0aGlzLmZpbGVzID0gW107DQogICAgICAvL+a4heepuuS4iuS8oOaOp+S7tuaWh+S7tuS/oeaBrw0KICAgICAgbGV0IHVwbG9hZEZpbGUgPSB0aGlzLiRyZWZzLnVwbG9hZEZpbGU7DQogICAgICBpZiAodXBsb2FkRmlsZSkgew0KICAgICAgICB0aGlzLiRyZWZzLnVwbG9hZEZpbGUuY2xlYXJGaWxlcygpOw0KICAgICAgfQ0KICAgICAgdGhpcy5mb3JtID0gew0KICAgICAgICBpZDogbnVsbCwNCiAgICAgICAgZmlsZVBhdGg6IG51bGwsDQogICAgICAgIGxheWVyTmFtZTogbnVsbCwNCiAgICAgICAgbGF5ZXJUeXBlOiBudWxsLA0KICAgICAgICBmaWxlVHlwZTogbnVsbCwNCiAgICAgICAgY3JlYXRlQnk6IG51bGwsDQogICAgICAgIGNyZWF0ZVRpbWU6IG51bGwsDQogICAgICAgIHVwZGF0ZUJ5OiBudWxsLA0KICAgICAgICB1cGRhdGVUaW1lOiBudWxsDQogICAgICB9Ow0KICAgICAgdGhpcy5yZXNldEZvcm0oImZvcm0iKTsNCiAgICB9LA0KICAgIC8qKiDmkJzntKLmjInpkq7mk43kvZwgKi8NCiAgICBoYW5kbGVRdWVyeSAoKSB7DQogICAgICB0aGlzLnF1ZXJ5UGFyYW1zLnBhZ2VOdW0gPSAxOw0KICAgICAgdGhpcy5nZXRMaXN0KCk7DQogICAgfSwNCiAgICAvKiog6YeN572u5oyJ6ZKu5pON5L2cICovDQogICAgcmVzZXRRdWVyeSAoKSB7DQogICAgICB0aGlzLnJlc2V0Rm9ybSgicXVlcnlGb3JtIik7DQogICAgICB0aGlzLmhhbmRsZVF1ZXJ5KCk7DQogICAgfSwNCiAgICAvLyDlpJrpgInmoYbpgInkuK3mlbDmja4NCiAgICBoYW5kbGVTZWxlY3Rpb25DaGFuZ2UgKHNlbGVjdGlvbikgew0KICAgICAgdGhpcy5pZHMgPSBzZWxlY3Rpb24ubWFwKGl0ZW0gPT4gaXRlbS5pZCkNCiAgICAgIHRoaXMuc2luZ2xlID0gc2VsZWN0aW9uLmxlbmd0aCAhPT0gMQ0KICAgICAgdGhpcy5tdWx0aXBsZSA9ICFzZWxlY3Rpb24ubGVuZ3RoDQogICAgfSwNCiAgICAvKiog5paw5aKe5oyJ6ZKu5pON5L2cICovDQogICAgaGFuZGxlQWRkICgpIHsNCiAgICAgIHRoaXMucmVzZXQoKTsNCiAgICAgIHRoaXMub3BlbiA9IHRydWU7DQogICAgICB0aGlzLnRpdGxlID0gIua3u+WKoOaWh+S7tuS/oeaBryI7DQogICAgfSwNCiAgICAvKiog5L+u5pS55oyJ6ZKu5pON5L2cICovDQogICAgaGFuZGxlVXBkYXRlIChyb3cpIHsNCiAgICAgIHRoaXMucmVzZXQoKTsNCiAgICAgIGNvbnN0IGlkID0gcm93LmlkIHx8IHRoaXMuaWRzDQogICAgICBnZXRJbmZvKGlkKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgdGhpcy5mb3JtID0gcmVzcG9uc2UuZGF0YTsNCiAgICAgICAgdGhpcy5vcGVuID0gdHJ1ZTsNCiAgICAgICAgdGhpcy50aXRsZSA9ICLkv67mlLnmlofku7bkv6Hmga8iOw0KICAgICAgfSk7DQogICAgfSwNCiAgICAvKiog5o+Q5Lqk5oyJ6ZKuICovDQogICAgc3VibWl0Rm9ybSAoKSB7DQogICAgICB0aGlzLiRyZWZzWyJmb3JtIl0udmFsaWRhdGUodmFsaWQgPT4gew0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICBpZiAodGhpcy5maWxlcy5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgdGhpcy4kbW9kYWwubXNnRXJyb3IoIuivt+S4iuS8oOaWh+S7tiIpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOw0KICAgICAgICAgIC8vIGZvcm1EYXRhLmFwcGVuZCgiZmlsZXMiLCB0aGlzLmZpbGVzKTsNCiAgICAgICAgICAvLyDlsIbkuIrkvKDmlofku7bmlbDnu4Tkvp3mrKHmt7vliqDliLDlj4LmlbBwYXJhbXNEYXRh5LitDQogICAgICAgICAgbGV0IGZvcm1hdEVycm9yID0gdHJ1ZTsNCiAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmZpbGVzKTsNCiAgICAgICAgICB0aGlzLmZpbGVzLmZvckVhY2goKHgpID0+IHsNCiAgICAgICAgICAgIGlmICh0aGlzLmZvcm0uZmlsZVR5cGUgPT0gJ1NIUCcpIHsNCiAgICAgICAgICAgICAgaWYgKHguZmlsZS5uYW1lLmluZGV4T2YoInNocCIpICE9IC0xKSB7DQogICAgICAgICAgICAgICAgZm9ybWF0RXJyb3IgPSBmYWxzZTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgeC5maWxlKQ0KICAgICAgICAgIH0pOw0KICAgICAgICAgIGlmIChmb3JtYXRFcnJvcikgew0KICAgICAgICAgICAgdGhpcy4kbW9kYWwubXNnRXJyb3IoIuaWh+S7tuagvOW8j+mUmeivr++8jOivt+S4iuS8oHNocOaWh+S7tuexu+WeiyIpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgIH0NCiAgICAgICAgICBpZiAodGhpcy5mb3JtLmlkICE9IG51bGwpIHsNCiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgiaWQiLCB0aGlzLmZvcm0uaWQpOw0KICAgICAgICAgIH0NCiAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoImZpbGVUeXBlIiwgdGhpcy5mb3JtLmZpbGVUeXBlKTsNCiAgICAgICAgICBpZiAodGhpcy5mb3JtLmxheWVyVHlwZSAhPSBudWxsKSB7DQogICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoImxheWVyVHlwZSIsIHRoaXMuZm9ybS5sYXllclR5cGUpOw0KICAgICAgICAgIH0NCiAgICAgICAgICBpZiAodGhpcy5mb3JtLmxheWVyTmFtZSAhPSBudWxsKSB7DQogICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoImxheWVyTmFtZSIsIHRoaXMuZm9ybS5sYXllck5hbWUpOw0KICAgICAgICAgIH0NCiAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoImNvbXBvbmVudElkIiwgdGhpcy5mb3JtLmNvbXBvbmVudElkKQ0KICAgICAgICAgIHVwbG9hZChmb3JtRGF0YSkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UuZGF0YSkgew0KICAgICAgICAgICAgICB0aGlzLiRtb2RhbC5tc2dTdWNjZXNzKCLmk43kvZzmiJDlip8iKTsNCiAgICAgICAgICAgICAgdGhpcy5vcGVuID0gZmFsc2U7DQogICAgICAgICAgICAgIHRoaXMuJHBhcmVudC5nZXRMaXN0KCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICAvKiog5Yig6Zmk5oyJ6ZKu5pON5L2cICovDQogICAgaGFuZGxlRGVsZXRlIChyb3cpIHsNCiAgICAgIGNvbnN0IGlkcyA9IHJvdy5pZCB8fCB0aGlzLmlkczsNCiAgICAgIHRoaXMuJG1vZGFsLmNvbmZpcm0oJ+aYr+WQpuehruiupOWIoOmZpOaWh+S7tuS/oeaBr++8nycpLnRoZW4oZnVuY3Rpb24gKCkgew0KICAgICAgICByZXR1cm4gZGVsSW5mbyhpZHMpOw0KICAgICAgfSkudGhlbigoKSA9PiB7DQogICAgICAgIHRoaXMuZ2V0TGlzdCgpOw0KICAgICAgICB0aGlzLiRtb2RhbC5tc2dTdWNjZXNzKCLliKDpmaTmiJDlip8iKTsNCiAgICAgIH0pLmNhdGNoKCgpID0+IHsgfSk7DQogICAgfSwNCiAgICAvKiog5a+85Ye65oyJ6ZKu5pON5L2cICovDQogICAgaGFuZGxlRXhwb3J0ICgpIHsNCiAgICAgIHRoaXMuZG93bmxvYWQoJ3N5c3RlbS9pbmZvL2V4cG9ydCcsIHsNCiAgICAgICAgLi4udGhpcy5xdWVyeVBhcmFtcw0KICAgICAgfSwgYGluZm9fJHtuZXcgRGF0ZSgpLmdldFRpbWUoKX0ueGxzeGApDQogICAgfQ0KICB9DQp9Ow0K"},{"version":3,"sources":["fileDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;AAIA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"fileDetail.vue","sourceRoot":"src/views/config","sourcesContent":["<template>\r\n  <!-- 添加或修改文件信息对话框 -->\r\n  <el-dialog :title=\"title\" :visible.sync=\"open\" width=\"700px\" append-to-body>\r\n    <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"120px\">\r\n      <el-row>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"文件类型\" prop=\"fileType\">\r\n            <el-select\r\n              v-model=\"form.fileType\"\r\n              placeholder=\"请选择文件类型\"\r\n              clearable\r\n            >\r\n              <el-option\r\n                v-for=\"dict in dict.type.sys_file_type\"\r\n                :key=\"dict.value\"\r\n                :label=\"dict.label\"\r\n                :value=\"dict.value\"\r\n              />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"图层类型\" prop=\"layerType\">\r\n            <el-select\r\n              v-model=\"form.layerType\"\r\n              placeholder=\"请选择图层类型\"\r\n              clearable\r\n            >\r\n              <el-option\r\n                v-for=\"dict in dict.type.sys_layer_file_type\"\r\n                :key=\"dict.value\"\r\n                :label=\"dict.label\"\r\n                :value=\"dict.value\"\r\n              />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row>\r\n        <el-col :span=\"24\">\r\n          <el-form-item label=\"图层名称\" prop=\"layerName\">\r\n            <el-input v-model=\"form.layerName\" placeholder=\"请输入图层名称\" />\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row>\r\n        <el-col :span=\"24\">\r\n          <el-upload\r\n            ref=\"uploadFile\"\r\n            style=\"margin-left: 50px\"\r\n            class=\"upload-demo\"\r\n            :http-request=\"httpRequest\"\r\n            :file-list=\"files\"\r\n            :multiple=\"fileMultiple\"\r\n            :limit=\"8\"\r\n            action=\"#\"\r\n            :show-file-list=\"true\"\r\n            :before-upload=\"beforeUpload\"\r\n            :data=\"form\"\r\n          >\r\n            <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n          </el-upload>\r\n        </el-col>\r\n      </el-row>\r\n    </el-form>\r\n    <div slot=\"footer\" class=\"dialog-footer\">\r\n      <el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\r\n      <el-button @click=\"cancel\">取 消</el-button>\r\n    </div>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { listInfo, getInfo, delInfo, addInfo, updateInfo, upload } from \"@/api/config/file\";\r\n\r\nexport default {\r\n  name: \"Info\",\r\n  dicts: ['sys_file_type', 'sys_layer_file_type'],\r\n  data () {\r\n    return {\r\n      // 遮罩层\r\n      loading: true,\r\n      // 选中数组\r\n      ids: [],\r\n      // 非单个禁用\r\n      single: true,\r\n      // 非多个禁用\r\n      multiple: true,\r\n      operation: null,\r\n      // 支持文件多个上传\r\n      fileMultiple: false,\r\n      // 显示搜索条件\r\n      showSearch: true,\r\n      // 总条数\r\n      total: 0,\r\n      // 文件信息表格数据\r\n      infoList: [],\r\n      files: [],\r\n      // 弹出层标题\r\n      title: \"\",\r\n      // 是否显示弹出层\r\n      open: false,\r\n      // 查询参数\r\n      queryParams: {\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        filePath: null,\r\n        layerName: null,\r\n        layerType: null,\r\n        fileType: null,\r\n      },\r\n      // 表单参数\r\n      form: {},\r\n      // 表单校验\r\n      rules: {\r\n        componentId: [\r\n          { required: true, message: \"组件ID不能为空\", trigger: \"blur\" }\r\n        ],\r\n        fileType: [\r\n          { required: true, message: \"文件类型不能为空\", trigger: \"blur\" }\r\n        ],\r\n      }\r\n    };\r\n  },\r\n  created () {\r\n    this.getList();\r\n  },\r\n\r\n  methods: {\r\n\r\n\r\n\r\n    httpRequest (option) {\r\n\r\n      if (this.operation == 'update') {\r\n        this.files = [];\r\n      }\r\n      this.files.push({\r\n        name: option.file.name,\r\n        url: option.file.name,\r\n        file: option.file\r\n      })\r\n\r\n    },\r\n\r\n    // 上传预处理\r\n    beforeUpload (file) {\r\n\r\n    },\r\n\r\n\r\n    /** 查询文件信息列表 */\r\n    getList () {\r\n      this.loading = true;\r\n      listInfo(this.queryParams).then(response => {\r\n        this.infoList = response.rows;\r\n        this.total = response.total;\r\n        this.loading = false;\r\n      });\r\n    },\r\n    // 取消按钮\r\n    cancel () {\r\n      this.open = false;\r\n      this.reset();\r\n    },\r\n    // 表单重置\r\n    reset () {\r\n      this.files = [];\r\n      //清空上传控件文件信息\r\n      let uploadFile = this.$refs.uploadFile;\r\n      if (uploadFile) {\r\n        this.$refs.uploadFile.clearFiles();\r\n      }\r\n      this.form = {\r\n        id: null,\r\n        filePath: null,\r\n        layerName: null,\r\n        layerType: null,\r\n        fileType: null,\r\n        createBy: null,\r\n        createTime: null,\r\n        updateBy: null,\r\n        updateTime: null\r\n      };\r\n      this.resetForm(\"form\");\r\n    },\r\n    /** 搜索按钮操作 */\r\n    handleQuery () {\r\n      this.queryParams.pageNum = 1;\r\n      this.getList();\r\n    },\r\n    /** 重置按钮操作 */\r\n    resetQuery () {\r\n      this.resetForm(\"queryForm\");\r\n      this.handleQuery();\r\n    },\r\n    // 多选框选中数据\r\n    handleSelectionChange (selection) {\r\n      this.ids = selection.map(item => item.id)\r\n      this.single = selection.length !== 1\r\n      this.multiple = !selection.length\r\n    },\r\n    /** 新增按钮操作 */\r\n    handleAdd () {\r\n      this.reset();\r\n      this.open = true;\r\n      this.title = \"添加文件信息\";\r\n    },\r\n    /** 修改按钮操作 */\r\n    handleUpdate (row) {\r\n      this.reset();\r\n      const id = row.id || this.ids\r\n      getInfo(id).then(response => {\r\n        this.form = response.data;\r\n        this.open = true;\r\n        this.title = \"修改文件信息\";\r\n      });\r\n    },\r\n    /** 提交按钮 */\r\n    submitForm () {\r\n      this.$refs[\"form\"].validate(valid => {\r\n        if (valid) {\r\n          if (this.files.length == 0) {\r\n            this.$modal.msgError(\"请上传文件\");\r\n            return;\r\n          }\r\n\r\n          let formData = new FormData();\r\n          // formData.append(\"files\", this.files);\r\n          // 将上传文件数组依次添加到参数paramsData中\r\n          let formatError = true;\r\n          console.log(this.files);\r\n          this.files.forEach((x) => {\r\n            if (this.form.fileType == 'SHP') {\r\n              if (x.file.name.indexOf(\"shp\") != -1) {\r\n                formatError = false;\r\n              }\r\n            }\r\n            formData.append('file', x.file)\r\n          });\r\n          if (formatError) {\r\n            this.$modal.msgError(\"文件格式错误，请上传shp文件类型\");\r\n            return;\r\n          }\r\n          if (this.form.id != null) {\r\n            formData.append(\"id\", this.form.id);\r\n          }\r\n          formData.append(\"fileType\", this.form.fileType);\r\n          if (this.form.layerType != null) {\r\n            formData.append(\"layerType\", this.form.layerType);\r\n          }\r\n          if (this.form.layerName != null) {\r\n            formData.append(\"layerName\", this.form.layerName);\r\n          }\r\n          formData.append(\"componentId\", this.form.componentId)\r\n          upload(formData).then(response => {\r\n            if (response && response.data) {\r\n              this.$modal.msgSuccess(\"操作成功\");\r\n              this.open = false;\r\n              this.$parent.getList();\r\n            }\r\n\r\n          });\r\n        }\r\n      });\r\n    },\r\n    /** 删除按钮操作 */\r\n    handleDelete (row) {\r\n      const ids = row.id || this.ids;\r\n      this.$modal.confirm('是否确认删除文件信息？').then(function () {\r\n        return delInfo(ids);\r\n      }).then(() => {\r\n        this.getList();\r\n        this.$modal.msgSuccess(\"删除成功\");\r\n      }).catch(() => { });\r\n    },\r\n    /** 导出按钮操作 */\r\n    handleExport () {\r\n      this.download('system/info/export', {\r\n        ...this.queryParams\r\n      }, `info_${new Date().getTime()}.xlsx`)\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n"]}]}